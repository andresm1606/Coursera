(window.webpackJsonp_spotim_580132258=window.webpackJsonp_spotim_580132258||[]).push([[57],{1040:function(e,t,n){"use strict";var a=n(0),r=n(34);Object.defineProperty(t,"__esModule",{value:!0}),t.render=function(e,t,n){var a=document.createElement("div");!(e.getRootNode()instanceof ShadowRoot)&&c.isUseShadowDomOnMain&&a.attachShadow&&window.__SPOTIM__.stylesheetElementAdded&&(a.attachShadow({mode:"open"}),(0,d.exposeAnimationEvents)(a,{defensiveMode:p}));a.setAttribute("data-spot-im-shadow-host",v),e.appendChild(a),(0,f.initUserClickTracker)((0,g.getElementId)(e)),o.default.render(i.default.createElement(i.Suspense,{fallback:null},i.default.createElement(s.Provider,{store:t.store},i.default.createElement(m,{element:e}))),a.shadowRoot||a,n)};var i=r(n(6)),o=a(n(4)),s=n(45);n(424);var c=r(n(79)),d=n(11),l=a(n(1)),u=n(10),f=n(1041),g=n(222),p=l.default.get("tenant_config.shared.defensiveJsMode",!1),v=l.default.get("tenant_config.conversation.cssModulesForShadowDOM","conversation conversation-survey @spotim/ui-components @spotim/ads @spotim/user-image feed @spotim/content-entities @spotim/user-info"),m=function(e){var t=(0,s.useSelector)((function(e){return e.appState})),n=t.isUserInitialized,a=t.isTranslationInitialize,r=t.isTokenInitialized;return(0,i.useEffect)((function(){n&&a&&r&&(0,u.detachLoader)(e.element)}),[n,a,r]),n&&a&&r?i.default.createElement(i.Suspense,{fallback:null},i.default.createElement(c.default,{container:e.element})):null}},1041:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.initUserClickTracker=void 0;var r=a(n(37)),i=a(n(38)),o=n(247),s=n(59);t.initUserClickTracker=function(e){(0,o.getDocumentOrShadowRoot)(e).addEventListener("click",function(){var e=(0,i.default)(r.default.mark((function e(t){var n,a,i,o,c,d,l;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=null===(n=(a=null==t?void 0:t.target).getAttribute)||void 0===n?void 0:n.call(a,"data-spot-im-class"))&&(d=null===(o=(c=null==t?void 0:t.target).getBoundingClientRect)||void 0===o?void 0:o.call(c),l=new CustomEvent(s.USER_CLICK,{detail:{spotImClass:i,elementTop:d.top}}),document.dispatchEvent(l));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),!1)}},1043:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.sendConvAsyncData=function(e,t,n){var a=t.href,i=t.ignoreHostUrl,o=t.canonicalHref,s=t.highlight,c=t.disqusIdentifier,d=t.disqusUrl,l=t.gigyaStreamId,u=t.gigyaCategoryId,f=t.wpImportEndpoint,g=t.facebookUrl,p=t.livefyreUrl,v=t.iosUrl,m=t.androidUrl,h=t.isRecommendedPost,y=t.conversationAuthorId,_=t.conversationArticleTags,b=t.isConversationLiveBlog,O={platform:n?"mobile":"desktop"};if(y||_){var I={};y&&Object.assign(I,{author_id:y}),_&&Object.assign(I,{article_tags:_.trim()}),Object.assign(O,{metadata:I})}v&&Object.assign(O,{ios_url:v});m&&Object.assign(O,{android_url:m});h||Object.assign(O,{recommended_post:h});a&&Object.assign(O,{host_url:a});o&&Object.assign(O,{canonical_url:o});s&&Object.assign(O,{highlight:s});i&&Object.assign(O,{ignore_host_url:i});b&&Object.assign(O,{is_conversation_live_blog:b});var j={};c&&Object.assign(j,{disqus_identifier:c});d&&Object.assign(j,{disqus_url:d});l&&Object.assign(j,{gigya_streamid:l});u&&Object.assign(j,{gigya_categoryid:u});g&&Object.assign(j,{facebook_url:g});p&&Object.assign(j,{livefyre_url:p});f&&Object.assign(j,{wp_import_endpoint:f});Object.keys(j).length>0&&Object.assign(O,{import_hints:j});return(0,r.default)("v1.0.0/conversation/async",{postId:e,method:"POST",data:O})};var r=a(n(58))},1044:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.parseSections=s,t.extractSection=function(e,t){var n=s(e);return n["*"]+(n[t]||"")};var r=a(n(87)),i=n(197),o=["spsl","sections"];function s(e){var t,n={startTag:{startIndex:0,endIndex:0},endTag:{startIndex:e.length,endIndex:e.length},children:[],sections:[],parent:null,tagName:"root"},a=n,s=new i.Parser({onopentag:function(e,n){if(o.indexOf(e)>-1){var i=[];"sections"===e&&n.names&&i.push.apply(i,(0,r.default)(n.names.split(","))),(t={children:[],sections:i,parent:a,tagName:e}).startTag={startIndex:s.startIndex,endIndex:s.endIndex+1},a.children.push(t),a=t}},onclosetag:function(e){o.indexOf(e)>-1&&a.tagName===e&&(a.endTag={startIndex:s.startIndex,endIndex:s.endIndex+1},a=a.parent)}},{recognizeSelfClosing:!1,xmlMode:!1});return s.write(e),s.end(),function e(t,n,a){var i=n.startTag,o=n.endTag,s=n.children,c=n.sections,d=i.endIndex,l=[],u={"*":""},f=[].concat((0,r.default)(a),(0,r.default)(c)).filter((function(e,t,n){return n.indexOf(e)===t}));if(s.forEach((function(n){var a=t.substring(d,n.startTag.startIndex);l.push(a.trim());var r=e(t,n,f);d=n.endTag.endIndex,Object.keys(r).forEach((function(e){u[e]=u[e]||"",u[e]+=r[e]}))})),d<o.startIndex){var g=t.substring(d,o.startIndex);l.push(g.trim())}return(l=l.join("").trim()).length>0&&(f.length>0?f.forEach((function(e){u[e]=u[e]||"",u[e]=l+u[e]})):u["*"]=l+u["*"]),u}(e,n,[])}},1045:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.injectStyleTag=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.id;if(n&&document.getElementById(n))return;var a=document.createElement("style");a.type="text/css",n&&(a.id=n);a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e));var r=document.head||document.getElementsByTagName("head")[0];r.appendChild(a)}},1046:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=r.default.stringify(),t=document.querySelector("div[data-svg-sprite]");t||(t=document.createElement("div")).setAttribute("data-svg-sprite","true"),t.innerHTML=e,document.body.appendChild(t)};var r=a(n(1047))},30:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.preRender=function(e,t){return _.apply(this,arguments)};var r=a(n(37)),i=a(n(38)),o=n(3),s=n(1040);n(1042);var c=n(1043),d=a(n(361)),l=n(248),u=n(50),f=n(222),g=n(350),p=n(1044),v=n(1045),m=a(n(410)),h=a(n(1046)),y=n(64);function _(){return(_=(0,i.default)(r.default.mark((function e(t,n){var a,i,_,b,O,I,j,x,S,w,T;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=(0,f.getElementId)(t),i=n.store.getState(),_=n.postId,b=n.isConversationPage,O=n.isLiveBlog,I=n.contentType,j=(0,g.getModuleOptions)(i,a),x=j.styleBlock,S=j.scriptBlock,w=j.isMobile;try{b||(T=l.enableCommunityView&&!O&&(0,u.getCommunityView)(i),(0,d.default)(_).startObservingOn(t,T||"conversation"))}catch(e){o.metrics.error("preRender","time-spent not properly initialized")}if(S)try{S=(0,p.extractSection)(S,"conversation-frame"),(0,m.default)(t,void 0,{content:S})}catch(e){o.metrics.error("preRender",e)}if(x)try{x=(0,p.extractSection)(x,"conversation-frame"),(0,v.injectStyleTag)(x)}catch(e){o.metrics.error("preRender",e)}(0,s.render)(t,n,(function(){S&&(S=(0,p.extractSection)(S,"conversation-frame"),(0,m.default)(t,void 0,{content:S})),x&&(x=(0,p.extractSection)(x,"conversation-frame"),(0,v.injectStyleTag)(x));var e=(0,g.getModuleOptions)(n.store.getState(),a);I&&I!==y.ContentType.Post&&(0,c.sendConvAsyncData)(_,e,w)})),(0,h.default)();case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=preRender-bundle.js.map