(window.webpackJsonp_spotim_580132258=window.webpackJsonp_spotim_580132258||[]).push([[50],{1e3:function(e,t,n){"use strict";(function(e){var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=o(n(53)),f=a(n(6)),p=n(45),m=o(n(18)),g=o(n(48)),v=o(n(1)),h=n(43),y=o(n(1001)),E=n(47),M=n(44),b=n(55),S=n(59),R=o(n(52)),C=o(n(1004));function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var w=function(t){(0,l.default)(a,t);var n=T(a);function a(){var e;(0,s.default)(this,a);for(var t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return(e=n.call.apply(n,[this].concat(o))).state={showMenu:!1},e.handleTooltipClick=function(t){13===t.keyCode&&e.onTooltipToggle()},e.onTooltipToggle=function(){var t=e.props,n=t.tracking,a=t.currentUser,o=t.postId;(0,b.dispatchSpotimEvent)(S.PROFILE_DROP_DOWN,a);var r={type:"profile-main-clicked",post_id:o};!e.state.showMenu&&n.trackEvent(r),e.setState({showMenu:!e.state.showMenu})},e.hide=function(){e.setState({showMenu:!1})},e.handleCloseTooltip=function(){e.setState({showMenu:!1})},e}return(0,i.default)(a,[{key:"render",value:function(){var t,n,a=this.props,o=a.onLogout,s=a.onOpenPrivacyModal,i=a.onOpenUserProfileModal,l=a.showHideConversation,u=a.enableCommunityQuestion,d=a.onSetCommunityQuestion,c=a.onOpenUserSettingsModal,p=a.isLoggedIn,g=a.userId,b=a.isAdmin,S=a.isSuperAdmin,T=a.isModerator,w=a.isJournalist,I=a.toggleHideConversation,O=a.conversationAuthorId,k=a.showLogout,_=a.size,N=a.className,x=a.token,D=a.showPrivacy,P=a.onCommunityQuestionModalStateChange;this.state.showMenu;N=(0,m.default)(C.default.currentUserMenu,C.default.textTrigger,N,(t={},(0,r.default)(t,C.default.conversation,"community"!==e.env.MODULE),(0,r.default)(t,C.default.small,"small"===_),(0,r.default)(t,C.default.medium,"medium"===_),(0,r.default)(t,C.default.regular,"regular"===_),t));var U=v.default.get("init_data.config.ltr")?"bottom-end":"bottom-start";return p&&(n=f.default.createElement(y.default,{token:x,userId:g,isAdmin:b,isSuperAdmin:S,isModerator:T,isJournalist:w,onClose:this.hide,onLogout:o,onOpenPrivacyModal:s,showLogout:k,onOpenUserProfileModal:i,onOpenUserSettingsModal:c,showHideConversation:l,enableCommunityQuestion:u,toggleHideConversation:I,onSetCommunityQuestion:d,conversationAuthorId:O,showPrivacy:D,onCommunityQuestionModalStateChange:P})),f.default.createElement(h.Menu,{isMobile:R.default,isLtr:M.isLtr,placement:U,onShowChange:this.onTooltipToggle,mobileCancelButtonContent:f.default.createElement(E.TranslationWrapper,{i18nKey:"menu.closeButton"},"Done"),menuButton:f.default.createElement("span",{className:C.default.currentUserMenuWrapper,"data-spot-im-class":"handler"},this.props.children)},n)}}]),a}(f.Component);w.displayName="CurrentUserMenu",w.defaultProps={className:"",showPrivacy:!0,onOpenPrivacyModal:function(){},onCommunityQuestionModalStateChange:function(){}};var I=(0,c.default)((0,p.connect)((function(e){var t=e.moduleOptions,n=t.spotId,a=t.postId;return{currentUser:e.currentUser,spotId:n,postId:a}})),(0,g.default)({}))(w);t.default=I}).call(this,n(130))},1001:function(e,t,n){"use strict";(function(e){var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RegisteredUserDropdown=void 0;var r=o(n(87)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=o(n(53)),f=a(n(6)),p=n(45),m=o(n(48)),g=o(n(1)),v=n(43),h=n(71),y=n(47),E=n(1002),M=n(1003),b=n(55),S=n(59),R=n(44);function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var T=g.default.get("tenant_config.conversation.disable_conversation_user_settings"),w=function(t){(0,l.default)(a,t);var n=C(a);function a(){var e;(0,s.default)(this,a);for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return(e=n.call.apply(n,[this].concat(o))).onProfileClick=function(){var t=e.props,n=t.tracking,a=t.currentUser,o=t.onOpenUserProfileModal,r=t.postId,s=t.userId;o(a);var i={type:"my-profile-clicked",post_id:r},l={type:"user-profile-clicked",target_type:"my-profile-dropdown",item_type:"user_profile",target_id:s,post_id:r};n.trackEvent(i),n.trackEvent(l),e.props.onClose()},e.onSettingsClick=function(){var t=e.props,n=t.tracking,a=t.onOpenUserSettingsModal,o=t.currentUser,r=t.postId;a(o);var s={type:"edit-settings-clicked",post_id:r};n.trackEvent(s),(0,b.dispatchSpotimEvent)(S.CLICKED_SETTINGS,o),e.props.onClose()},e.onLogoutClick=function(){e.props.onLogout(),e.props.onClose()},e.onPrivacyClick=function(){var t=e.props.currentUser;e.props.onOpenPrivacyModal(t),(0,b.dispatchSpotimEvent)(S.CLICKED_PRIVACY,t)},e.setModerationToDefault=function(){e.props.setModerationDefaultPolicy("spot_policy"),e.props.onClose()},e.setModerationToStrict=function(){e.props.setModerationDefaultPolicy("require_approval"),e.props.onClose()},e.onCommunityQuestionClick=function(){var t=e.props,n=t.onCommunityQuestionModalStateChange,a=t.onClose;n(),a()},e.onHideConversationClick=function(){e.props.toggleHideConversation(),e.props.onClose()},e.getDropListItems=function(e){var t=e.profileItem,n=e.conversationHostOptions,a=e.settingsItem,o=e.showPrivacy,s=e.onPrivacyClick,i=e.disableUserProfileModal,l=[t].concat((0,r.default)(n),[a]);return i&&(l=(0,r.default)(n)),o&&!T&&l.push(f.default.createElement(v.MenuItem,{key:"privacy","data-spot-im-class":"privacy-item",onClick:s},f.default.createElement(h.TranslatedText,{textKey:"general.privacy.short"},"Privacy"))),l},e}return(0,i.default)(a,[{key:"componentDidMount",value:function(){var t=this.props,n=t.isModerator,a=t.isAdmin,o=t.isSuperAdmin,r=t.isJournalist;"community"!==e.env.MODULE&&(n||a||o||r)&&this.props.getModerationDefaultPolicy()}},{key:"conversationHostOptions",value:function(){var e=this.props,t=e.isModerator,n=e.showHideConversation,a=[];if(t&&n){var o=f.default.createElement(v.MenuItem,{key:"hide","data-spot-im-class":"hide-conversation-item",onClick:this.onHideConversationClick},f.default.createElement(h.TranslatedText,{textKey:"userProfile.contextMenu.hide"}));a.push(o)}return a}},{key:"render",value:function(){var t=this.props,n=t.showLogout,a=t.conversationAuthorId,o=t.userId,r=t.isModerator,s=t.isAdmin,i=t.isSuperAdmin,l=t.isJournalist,u=t.enableCommunityQuestion,d=t.defaultPolicy,c=t.showPrivacy,p=t.isReadOnly,m=t.setIsReadOnly,g=t.disableUserProfileModal,E=f.default.createElement(h.TranslatedText,{textKey:"userProfile.contextMenu.profile"}),M=!R.disableUserProfile&&f.default.createElement(v.MenuItem,{key:"profile","data-spot-im-class":"profile-item",onClick:this.onProfileClick},E),b=!T&&f.default.createElement(v.MenuItem,{key:"settings","data-spot-im-class":"settings-item",onClick:this.onSettingsClick},f.default.createElement(h.TranslatedText,{textKey:"userProfile.contextMenu.settings"})),S=this.conversationHostOptions(),C=this.getDropListItems({profileItem:M,conversationHostOptions:S,settingsItem:b,showPrivacy:c,onPrivacyClick:this.onPrivacyClick,disableUserProfileModal:g});return u&&(a===o||s||i||l)&&C.unshift(f.default.createElement(v.MenuItem,{key:"communityQuestion","data-spot-im-class":"community-question-item",onClick:this.onCommunityQuestionClick},f.default.createElement(h.TranslatedText,{textKey:"user.setCommunityQuestion"}))),n&&C.push(f.default.createElement(v.MenuItem,{key:"logout","data-spot-im-class":"logout-item",onClick:this.onLogoutClick},f.default.createElement(h.TranslatedText,{textKey:"user.logout"}))),"community"!==e.env.MODULE&&(r||s||i||l)&&(d?C.push(f.default.createElement(v.MenuItem,{key:"setModerationTo","data-spot-im-class":"set-moderation-item",onClick:"spot_policy"==d?this.setModerationToStrict:this.setModerationToDefault},f.default.createElement(h.TranslatedText,{textKey:"spot_policy"==d?"user.setModerationStrict":"user.setModerationDefault"}))):C.push(f.default.createElement(v.MenuItem,{key:"setModerationLoading","data-spot-im-class":"set-moderation-item",disabled:!0},f.default.createElement(y.TranslationWrapper,{i18nKey:"message.contextMenu.whiteList.item.loading"},"Fetching Info...")))),R.enableReadOnlyContextMenu&&(r||s||i)&&C.push(f.default.createElement(v.MenuItem,{key:"setReadOnly",onClick:function(){return m(!p)}},f.default.createElement(h.TranslatedText,{textKey:p?"readOnly.turnOnCommenting":"readOnly.turnOffCommenting"}))),C}}]),a}(f.Component);t.RegisteredUserDropdown=w,w.displayName="RegisteredUserDropdown",w.defaultProps={onClose:function(){},showPrivacy:!0,onCommunityQuestionModalStateChange:function(){}};var I=(0,c.default)((0,p.connect)((function(e){return{isReadOnly:e.isReadOnly,token:(e.authentication||{}).token,currentUser:e.currentUser,unseenNotificationsCount:e.currentUser.unseenNotificationsCount,defaultPolicy:(e.conversation||{}).defaultPolicy,spotId:e.moduleOptions.spotId,disableUserProfileModal:e.moduleOptions.disableUserProfileModal,postId:e.moduleOptions.postId}}),(function(e){return{getModerationDefaultPolicy:function(){e((0,E.getModerationDefaultPolicy)())},setModerationDefaultPolicy:function(t){e((0,E.setModerationDefaultPolicy)(t))},setIsReadOnly:function(t){e((0,M.setIsReadOnly)({isReadOnly:t}))}}})),(0,m.default)({}))(w);t.default=I}).call(this,n(130))},1002:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.setModerationDefaultPolicy=t.getModerationDefaultPolicy=void 0;var o=a(n(37)),r=a(n(38)),s=n(81),i=n(3);t.getModerationDefaultPolicy=function(){return function(){var e=(0,r.default)(o.default.mark((function e(t,n){var a,r,l,u,d;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=n(),r=a.moduleOptions.spotId,l=a.conversation.id,t({type:"GET_MODERATION_DEFAULT_POLICY",payload:{defaultPolicy:""}}),e.next=5,(0,s.getConversationDefaultPolicy)({spotId:r,conversationId:l});case 5:u=e.sent,d=u.defaultPolicy,t({type:"GET_MODERATION_DEFAULT_POLICY",payload:{defaultPolicy:d}}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),i.metrics.error("getModerationDefaultPolicy",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}()};t.setModerationDefaultPolicy=function(e){return function(){var t=(0,r.default)(o.default.mark((function t(n,a){var r,l,u;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=a(),l=r.moduleOptions.spotId,u=r.conversation.id,t.next=4,(0,s.setConversationDefaultPolicy)({spotId:l,conversationId:u,newPolicy:e});case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),i.metrics.error("setConversationDefaultPolicy",t.t0);case 9:n({type:"SET_MODERATION_DEFAULT_POLICY",payload:{}});case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,n){return t.apply(this,arguments)}}()}},1003:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.setIsReadOnly=void 0;var o=a(n(37)),r=a(n(38)),s=n(171),i=a(n(58));t.setIsReadOnly=function(e){var t=e.isReadOnly;return function(){var e=(0,r.default)(o.default.mark((function e(n,a){var r,l,u,d;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a(),l=r.moduleOptions,u=l.conversationId,d=l.postId,e.prev=1,e.next=4,(0,i.default)("v1.0.0/conversation/metadata/read_only",{method:"POST",postId:d,data:{read_only:t,conversation_id:u}});case 4:n((0,s.setReadOnly)({isReadOnly:t})),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}()}},1005:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=a(n(6)),c=o(n(18)),f=n(71),p=o(n(1006)),m=o(n(48)),g=n(59),v=n(55),h=n(43);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var E=function(e){(0,i.default)(n,e);var t=y(n);function n(){var e;(0,r.default)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).handleLoginButtonKeyUp=function(t){13===t.keyCode&&e.handleClick(t)},e}return(0,s.default)(n,[{key:"handleClick",value:function(e){var t=this.props,n=t.tracking,a=t.onClick,o=t.postId;a(e);var r={item_type:"login",target_type:"main-login",type:"login-clicked",post_id:o};n.trackEvent(r),(0,v.dispatchSpotimEvent)(g.CLICKED_LOGIN)}},{key:"render",value:function(){var e=this.props.className;return e=(0,c.default)(p.default.loginButton,e),d.default.createElement(h.Typography,{type:"action",className:e,onClick:this.handleClick.bind(this),onKeyUp:this.handleLoginButtonKeyUp},d.default.createElement(f.TranslatedText,{textKey:"general.login"}))}}]),n}(d.Component);E.displayName="LoginButton",E.defaultProps={tracking:function(){throw new Error("Tracking is not defined")}};var M=(0,m.default)({})(E);t.default=M},1008:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(37)),s=o(n(38)),i=o(n(49)),l=a(n(6)),u=n(45),d=o(n(146)),c=n(43),f=n(1009),p=o(n(1010)),m=o(n(425)),g=n(79),v=n(44);var h=(0,u.connect)((function(e){return{communityQuestion:e.moduleOptions.communityQuestion,isSettingCommunityQuestion:e.conversation.isSettingCommunityQuestion}}),(function(e){return{setCommunityQuestion:function(t){return e((0,f.setCommunityQuestion)(t))}}}))((function(e){var t=(0,l.useState)(""),n=(0,i.default)(t,2),a=n[0],o=n[1],u=(0,l.useState)(!0),f=(0,i.default)(u,2),h=f[0],y=f[1],E=(0,l.useState)(!1),M=(0,i.default)(E,2),b=M[0],S=M[1];(0,l.useEffect)((function(){a!==e.communityQuestion&&o(e.communityQuestion)}),[]);var R=(0,l.useMemo)((function(){var t=e.communityQuestion;return"string"==typeof t&&t.length>0}),[e.communityQuestion]);function C(){return(C=(0,s.default)(r.default.mark((function t(){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return S(!1),t.prev=1,t.next=4,e.setCommunityQuestion(a.trim());case 4:return t.prev=4,e.onClose(),t.finish(4);case 7:case"end":return t.stop()}}),t,null,[[1,,4,7]])})))).apply(this,arguments)}function T(){return(T=(0,s.default)(r.default.mark((function t(){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return S(!0),t.prev=1,t.next=4,e.setCommunityQuestion("");case 4:return t.prev=4,e.onClose(),t.finish(4);case 7:case"end":return t.stop()}}),t,null,[[1,,4,7]])})))).apply(this,arguments)}return l.default.createElement(c.Modal,{disableCustomBodyScroll:v.disableModalDefaultScroll,shadowRootCssModules:g.isUseShadowDomOnOverlays?["conversation"]:void 0,isLtr:v.isLtr,className:p.default.communityQuestionModal,closeButton:!0,showModal:e.showModal,onClose:function(){return e.onClose()},size:"md",modalTitle:d.default.t("communityQuestion.title"),bottomActions:l.default.createElement(c.Gutter,null,l.default.createElement(c.Button,{mode:"secondary",onClick:function(){return T.apply(this,arguments)},disabled:!R},l.default.createElement(m.default,{label:d.default.t("delete","Delete"),showSpinner:b&&e.isSettingCommunityQuestion})),l.default.createElement(c.Button,{mode:"primary",onClick:function(){return C.apply(this,arguments)},disabled:h||e.isSettingCommunityQuestion},l.default.createElement(m.default,{label:d.default.t("Post"),showSpinner:!b&&e.isSettingCommunityQuestion})))},l.default.createElement("div",{className:p.default.description},d.default.t("communityQuestion.description")),l.default.createElement("textarea",{className:p.default.textarea,placeholder:d.default.t("communityQuestion.ask"),value:a,onChange:function(e){o(e.currentTarget.value),y(!e.currentTarget.value)}}))}));t.default=h},1009:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.setCommunityQuestion=void 0;var o=a(n(37)),r=a(n(38)),s=n(39),i=n(81);t.setCommunityQuestion=function(e){return function(){var t=(0,r.default)(o.default.mark((function t(n,a){var r,l,u,d;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a(),l=r.moduleOptions.spotId,u=r.conversation,n({type:s.SET_IS_SETTING_COMMUNITY_QUESTION,payload:{isSettingCommunityQuestion:!0}}),t.next=4,(0,i.updateCommunityQuestion)({spotId:l,conversationId:u.id,communityQuestion:e});case 4:d=t.sent,d.isSuccess&&n({type:s.SET_COMMUNITY_QUESTION,payload:{moduleOptions:{communityQuestion:e}}}),n({type:s.SET_IS_SETTING_COMMUNITY_QUESTION,payload:{isSettingCommunityQuestion:!1}});case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}},1011:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.loadMore=function(){return function(){var e=(0,s.default)(r.default.mark((function e(t,n){var a,o,s,i,c,p,m,g,v,h,y,E,M,b,S,R,C,T,w,I,O;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.metrics.apm.start("load_more_comments"),a=n(),o=u.isLiveBlog(a),s=u.isMobile(a),i=f(s),c=a.moduleOptions,p=c.spotId,m=c.postId,g=c.eventCode,v=c.conversationId,h=c.href,y=c.canonicalHref,E=c.shouldCollapseReplies,M=c.pageSize,b=void 0===M?i:M,S=a.comments,R=S.pagination,C=R.offset,T=R.commentsRead,w=R.sortBy,I=S.isLoading,O=E?1:2,!o&&I){e.next=11;break}return e.next=10,t((0,l.fetchConversation)({spotId:p,postId:o?g:m,conversationId:v,href:h,canonicalHref:y,offset:C,commentsRead:T,pageSize:b,sortBy:w,depth:O,isFromShowMore:!0}));case 10:d.metrics.apm.end("load_more_comments");case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},t.getNewMessagesFetchCount=void 0;var r=o(n(37)),s=o(n(38)),i=n(97),l=n(455),u=a(n(50)),d=n(3),c=o(n(1)),f=function(e){var t=c.default.get("tenant_config.conversation.message_fetch_count",i.COMMENTS_FIRST_PAGE_SIZE);return e?i.MOBILE_COMMENTS_FIRST_PAGE_SIZE:t};t.getNewMessagesFetchCount=f},1012:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.resume=h,t.pause=y,t.init=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;if(!t)return void console.error("initialized reading service without an element to observe");s=e,r=n,f=0,i=!0,l=!1,clearInterval(o),m={hasMouseMoved:!0,hasMouseScrolled:!0,hasKeyboardClicked:!0},this.intersectionObserver=new IntersectionObserver((function(e){var t=(0,d.default)(e,1)[0];l?t.isIntersecting?h():(g(),y()):l=!0}),{threshold:.01}),M(t)&&h();this.intersectionObserver?this.intersectionObserver.observe(t):console.warn("unable to initialize reading service intersection observer");document.addEventListener("visibilitychange",E,!1)},t.getIsRunning=function(){return i};var o,r,s,i,l,u=a(n(7)),d=a(n(49)),c=n(3),f=0,p=[5,10,15,20,30,40,50,60,70,80,90,120,240],m={};function g(){if(0!==f){var e={type:"reading",item_type:"main",count:f,is_active_view:!0};s?s.trackEvent(e):c.metrics.error("trackEvent","trying to log reading event before reading-service initialization")}}function v(){f++,-1!==p.indexOf(f)&&(g(),m={hasMouseMoved:!1,hasMouseScrolled:!1,hasKeyboardClicked:!1})}function h(){i=!0,o=setInterval((function(){v()}),r)}function y(){i=!1,clearInterval(o)}function E(){"hidden"==document.visibilityState?y():h()}function M(e){var t=e.getBoundingClientRect();return t.top<window.innerHeight&&t.bottom>0}window.addEventListener("message",(function(e){if("object"===(0,u.default)(e.data)&&e.data.__SPOTIM_MESSAGE)switch(e.data.type){case"scroll":m.hasMouseScrolled=!0;break;case"keydown":m.hasKeyboardClicked=!0;break;case"mousemove":m.hasMouseMoved=!0}}))},1013:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ConversationNotifications=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=a(n(6)),c=o(n(46)),f=n(45),p=n(1014),m=n(1015),g=n(458),v=n(1017),h=o(n(1018));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var E=function(e){(0,i.default)(n,e);var t=y(n);function n(){return(0,r.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"render",value:function(){return d.default.createElement(h.default,this.props)}}]),n}(d.Component);t.ConversationNotifications=E,E.propTypes={notifications:c.default.object.isRequired,isLoading:c.default.bool,onMarkAllAsRead:c.default.func,onMarkAsRead:c.default.func,onLoadNext:c.default.func,onNotificationClick:c.default.func,direction:c.default.oneOf(["rtl","ltr"]).isRequired,showCircleIcon:c.default.bool.isRequired};var M=(0,f.connect)((function(e){var t=e.notifications,n=e.moduleOptions,a={isLoading:t.isLoading,notifications:t};if(n){var o=n.direction;a.direction=o}return a}),{onMarkAllAsRead:p.markAllNotificationsAsRead,onMarkAsRead:v.markNotificationAsRead,onLoadNext:m.getNotifications,onLoadAndReset:g.getAndResetNotifications})(E);t.default=M},1014:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.markAllNotificationsAsRead=function(){return function(){var e=(0,r.default)(o.default.mark((function e(t,n){var a,r,l;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n(),r=a.notifications,l=r.items.filter((function(e){return!e.read})).map((function(e){return e.id})),e.next=4,(0,i.markAllNotificationsAsRead)(l);case 4:t({type:s.MARK_ALL_READ});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()};var o=a(n(37)),r=a(n(38)),s=n(94),i=n(181)},1015:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getNotifications=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.reset,n=void 0!==t&&t;return function(){var e=(0,r.default)(o.default.mark((function e(t,a){var r,c,f,p,m,g,v,h,y,E,M;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a(),c=(0,s.getPageInfo)(r.notifications),f=c.offset,p=c.count,n&&(f=0,p=0),t({type:i.GET_START}),e.prev=4,e.next=7,(0,d.getNotifications)({offset:f,count:p});case 7:m=e.sent,g=m.body,v=(0,u.parseNotifications)(g),h=v.unreadCount,y=v.unseenCount,E=v.totalCount,M=v.notifications,t({type:i.GET_END,payload:{notifications:M,unreadCount:h,unseenCount:y,totalCount:E,offset:f,reset:n}}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),l.metrics.error("getNotifications",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,n){return e.apply(this,arguments)}}()};var o=a(n(37)),r=a(n(38)),s=n(127),i=n(94),l=n(3),u=n(457),d=n(181)},1016:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.linkUsersToNotification=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;n||(n=e.userId);e.user=t.find((function(e){return e.id===n})),e.entities&&e.entities.forEach((function(e){"user-mention"===e.type.toLowerCase()&&(e.user=t.find((function(t){return t.id===e.userId})))}));if(e.replyToUserId&&!e.replyToDisplayName){var a=t.find((function(t){return e.replyToUserId===t.id}));a&&(e.replyToDisplayName=a.displayName||a.username)}},t.linkUsersToMessages=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.forEach((function(e){linkUsersToMessage(e,t)}))}},1017:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.markNotificationAsRead=function(e){var t=e.id;return function(){var e=(0,r.default)(o.default.mark((function e(n){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.markNotificationAsRead)(t);case 2:n({type:s.MARK_AS_READ,payload:{id:t}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};var o=a(n(37)),r=a(n(38)),s=n(94),i=n(181)},1018:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Notifications=void 0;var r=o(n(33)),s=o(n(37)),i=o(n(38)),l=o(n(35)),u=o(n(36)),d=o(n(40)),c=o(n(41)),f=o(n(42)),p=o(n(53)),m=a(n(6)),g=n(45),v=o(n(18)),h=o(n(1)),y=n(1019),E=n(1021),M=n(64),b=o(n(1036)),S=a(n(50)),R=n(43),C=n(47),T=n(458),w=n(63),I=n(44),O=n(94),k=o(n(48)),_=n(55),N=n(59),x=o(n(52));function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,f.default)(e);if(t){var o=(0,f.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}var P=function(e){(0,d.default)(n,e);var t=D(n);function n(){var e;(0,l.default)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={showMenu:!1,unseenCount:e.props.notifications.unseenCount,isPostPage:e.props.contentType===M.ContentType.Post},e.onTooltipToggle=function(){e.props.onLoadAndReset(),e.setState({showMenu:!e.state.showMenu})},e.handleTooltipClick=function(t){13===t.keyCode&&(e.props.onLoadAndReset(),e.onTooltipToggle())},e.onIndicatorHover=function(){var t={type:"hovered",item_type:"header",target_type:"notifications-bell",post_id:e.props.postId};e.props.tracking.trackEvent(t)},e.onTooltipShow=(0,i.default)(s.default.mark((function t(){var n,a,o,r,i,l,u;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.props,a=n.tracking,o=n.postId,r=n.isLoaded,i=n.convId,l=n.setNotificationLoaded,r||(e.props.getAndResetNotifications(),l()),e.setState({showMenu:!0,unseenCount:0}),u={type:"notifications-bell-clicked",item_type:"notifications",target_type:"on",post_id:o,ugc_post_id:i},a.trackEvent(u),(0,_.dispatchSpotimEvent)(N.CLICKED_NOTIFICATION);case 6:case"end":return t.stop()}}),t)}))),e.onTooltipHide=function(){var t=e.props,n=t.tracking,a=t.postId,o=t.convId;e.setState({showMenu:!1});var r={type:"notifications-bell-clicked",item_type:"notifications",target_type:"off",post_id:a,ugc_post_id:o};n.trackEvent(r)},e.onNotificationClick=function(t){e.props.onNotificationClick(t),e.onTooltipToggle()},e.handleCloseTooltip=function(){e.setState({showMenu:!1})},e}return(0,u.default)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.notifications.unseenCount;this.props.notifications.unseenCount!==t&&this.setState({unseenCount:t})}},{key:"render",value:function(){var e=this,t=this.props,n=t.notifications,a=t.isLoading,o=t.connectEnabled,s=t.onLoadNext,i=t.onMarkAsRead,l=t.onMarkAllAsRead,u=t.className,d=t.showCircleIcon,c=t.isModal,f=t.isLiveBlog,p=t.currentUser,g=t.notificationsAlreadyLoaded,M=this.state,S=M.unseenCount,T=M.showMenu;u=(0,v.default)(b.default.notifications,(0,r.default)({},b.default.loginDisabled,!o),u);var O=h.default.get("init_data.config.ltr")?"bottom-end":"bottom-start";return f&&!(0,w.isLoggedIn)(p)?null:m.default.createElement("div",{className:u,id:"spotim-bell-notification"},m.default.createElement(R.Menu,{isLtr:I.isLtr,isMobile:x.default,placement:O,showMenu:T,onShowChange:function(t){t?e.onTooltipShow():e.onTooltipHide()},mobileCancelButtonContent:m.default.createElement(C.TranslationWrapper,{i18nKey:"menu.closeButton"},"Done"),menuButton:m.default.createElement(y.NotificationsIndicator,{active:T,count:S,onIndicatorHover:this.onIndicatorHover,showCircleIcon:d})},m.default.createElement(E.NotificationsTooltip,{notifications:n,isLoading:a||!g,onNotificationClick:this.onNotificationClick,onLoadNext:s,onMarkAsRead:i,onMarkAllAsRead:l,onShow:this.onTooltipShow,onHide:this.onTooltipHide,isModal:c})))}}]),n}(m.Component);t.Notifications=P,P.defaultProps={connectEnabled:!0};var U=(0,p.default)((0,g.connect)((function(e){var t=e.moduleOptions.postId,n=S.isLiveBlog(e),a=e.conversation,o=a.contentType,r=a.id;return{isLiveBlog:n,currentUser:S.getCurrentUser(e),postId:t,convId:r,notificationsAlreadyLoaded:e.notifications.isLoaded,contentType:o}}),(function(e){return{getAndResetNotifications:function(){e((0,T.getAndResetNotifications)())},setNotificationLoaded:function(){e({type:O.SET_IS_LOADED,payload:{isLoaded:!0}})}}})),(0,k.default)({}))(P);t.default=U},1019:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.NotificationsIndicator=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=o(n(46)),f=a(n(6)),p=n(45),m=o(n(18)),g=o(n(459));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var h=function(e){(0,l.default)(a,e);var t=v(a);function a(){var e;(0,s.default)(this,a);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).snippets=n(1020),e}return(0,i.default)(a,[{key:"render",value:function(){var e=this.props,t=e.count,n=e.active,a=e.onClick,o=e.onIndicatorHover,s=e.showCircleIcon,i=(0,m.default)(g.default.indicator,(0,r.default)({},g.default.active,t||n)),l=null;return t>0&&(l=f.default.createElement("span",{className:g.default.counter})),f.default.createElement("div",{onMouseEnter:o,className:i,onClick:a},this.snippets.getNotificationIcon({showCircleIcon:s}),l)}}]),a}(f.Component);t.NotificationsIndicator=h,h.displayName="NotificationsIndicator",h.propTypes={count:c.default.number,active:c.default.bool,onClick:c.default.func,onIndicatorHover:c.default.func,showCircleIcon:c.default.bool.isRequired,spotId:c.default.string},h.defaultProps={count:0,active:!1,onClick:function(){}};var y=(0,p.connect)((function(e){return{spotId:e.moduleOptions.spotId}}))(h);t.default=y},1020:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getNotificationIcon=void 0;var o=a(n(6)),r=a(n(56)),s=a(n(459));t.getNotificationIcon=function(e){return e.showCircleIcon?o.default.createElement(r.default,{className:s.default.icon,selector:"bellIcon"}):o.default.createElement(r.default,{className:s.default.icon,selector:"regularBellIcon"})}},1021:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationsTooltip=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=a(n(6)),f=o(n(18)),p=n(52),m=n(1022),g=n(1024),v=o(n(1032)),h=n(1034),y=n(127),E=o(n(1035));function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var b=function(e){(0,l.default)(n,e);var t=M(n);function n(){return(0,s.default)(this,n),t.apply(this,arguments)}return(0,i.default)(n,[{key:"render",value:function(){var e=this.props,t=e.notifications,n=e.className,a=e.isLoading,o=e.onMarkAsRead,s=e.onLoadNext,i=e.onNotificationClick,l=e.onMarkAllAsRead,u=e.isModal,d=t.items,M=t.order,b=(0,y.hasNext)(t),S=(0,y.isEmpty)(t),R=(0,f.default)(E.default.notificationsTooltip,(0,r.default)({},E.default.noNotifications,S),n),C=M.map((function(e){return d[e]}));return c.default.createElement("div",{className:R},!(0,p.isMobile)()&&c.default.createElement(m.NotificationsHeader,{unreadCount:C.length,onMarkAllAsRead:l}),!S&&c.default.createElement(g.NotificationsList,{items:C,isEmpty:S,hasNext:b,isLoading:a,onMarkAsRead:o,onNotificationClick:i,onLoadNext:s,isModal:u}),a&&S&&c.default.createElement(h.ActivityIndicator,null),!a&&S&&c.default.createElement(v.default,null))}}]),n}(c.Component);t.NotificationsTooltip=b,b.defaultProps={isLoading:!1,onNotificationClick:function(){},onLoadNext:function(){},onMarkAsRead:function(){},onMarkAllAsRead:function(){},onHide:function(){},onShow:function(){},toggleObservable:void 0,showObservable:void 0,hideObservable:void 0,className:""}},1022:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationsHeader=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=o(n(46)),c=a(n(6)),f=o(n(1023)),p=n(71);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var g=function(e){(0,i.default)(n,e);var t=m(n);function n(){var e;(0,r.default)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).handleMarkAsReadKeyUp=function(t){var n=e.props.onMarkAllAsRead;13===t.keyCode&&(t.stopPropagation(),n())},e}return(0,s.default)(n,[{key:"render",value:function(){var e=this.props,t=e.unreadCount,n=e.onMarkAllAsRead,a=null;return t>0&&(a=c.default.createElement(p.TranslatedText,{textKey:"notifications.markAsRead",className:f.default.markAsRead,onClick:n,onKeyUp:this.handleMarkAsReadKeyUp})),c.default.createElement("header",{className:f.default.notificationsTooltipHeader},c.default.createElement(p.TranslatedText,{textKey:"notifications.title",className:f.default.title}),t>0&&c.default.createElement("div",{className:f.default.counter},t),a)}}]),n}(c.Component);t.NotificationsHeader=g,g.displayName="NotificationsHeader",g.propTypes={unreadCount:d.default.number,onMarkAllAsRead:function(){}},g.defaultProps={unreadCount:0,onMarkAllAsRead:function(){}}},1024:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationsList=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=a(n(6)),c=o(n(1025)),f=o(n(1031));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var m=function(e){(0,i.default)(n,e);var t=p(n);function n(){var e;(0,r.default)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).scrollWrapperRef=d.default.createRef(),e.onScroll=function(){var t=e.scrollWrapperRef.current;if(t){var n=t.scrollTop;if(t.scrollHeight-t.clientHeight-n<30){var a=e.props,o=a.hasNext,r=a.onLoadNext,s=a.isLoading;o&&!s&&r()}}},e}return(0,s.default)(n,[{key:"render",value:function(){var e=this.props,t=e.items,n=e.isEmpty,a=e.onMarkAsRead,o=e.onNotificationClick,r=e.isModal;return n?null:d.default.createElement("ul",{className:f.default.list,ref:this.scrollWrapperRef,onScroll:this.onScroll},t.map((function(e){return d.default.createElement(c.default,{key:e.id,onClick:o,onMarkAsRead:a,item:e,isModal:r})})))}}]),n}(d.Component);t.NotificationsList=m,m.defaultProps={isEmpty:!1,hasNext:!1,isLoading:!1,onMarkAsRead:function(){},onNotificationClick:function(){},onLoadNext:function(){}}},1025:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.NotificationItem=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=o(n(53)),f=a(n(6)),p=n(45),m=o(n(18)),g=n(1026),v=n(1028),h=o(n(93)),y=o(n(1030)),E=n(101),M=n(78),b=o(n(48));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var R=function(e){(0,l.default)(n,e);var t=S(n);function n(e){var a;return(0,s.default)(this,n),(a=t.call(this,e)).onClick=function(e){var t=a.props,n=t.tracking,o=t.onMarkAsRead,r=t.item,s=t.onClick,i=t.postId,l=r.id,u=r.conversationUrl,d=r.message,c=r.spotId,f=r.conversationId,p=r.type;o({id:l}),s({conversationUrl:u,message:d,spotId:c,conversationId:f,newTab:"button"in e&&1===e.button||e.ctrlKey||e.metaKey});var m={type:"notification-click",item_type:"notifications",target_type:p,item_id:d&&d.id,conversation_id:f,post_id:i};n.trackEvent(m)},a.handleNotificationKeyUp=function(e){13===e.keyCode&&(e.stopPropagation(),a.onClick(e))},a.hideNotification=function(){a.setState({show:!1})},a.state={show:!0},a}return(0,i.default)(n,[{key:"render",value:function(){var e=this.props.item,t=e.users[e.userId]||(0,M.createUserObject)();return this.state.show?f.default.createElement("li",{className:(0,m.default)(y.default.item,(0,r.default)({},y.default.read,e.read)),onClick:this.onClick,onKeyUp:this.handleNotificationKeyUp},f.default.createElement(h.default,{size:E.USER_IMAGE_SIZE.NORMAL,disableUserImageUpload:!0,disableOnlineIndicator:!0,user:t}),f.default.createElement("div",{className:y.default.contentWrap},f.default.createElement(g.Content,{item:e,message:e.message,user:t,hideNotification:this.hideNotification}),f.default.createElement(v.Details,{item:e}))):null}}]),n}(f.Component);t.NotificationItem=R,R.defaultProps={onClick:function(){},onMarkAsRead:function(){}};var C=(0,c.default)((0,p.connect)((function(e){return{spotId:e.moduleOptions.spotId,postId:e.moduleOptions.postId}})),(0,b.default)({}))(R);t.default=C},1026:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Content=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=a(n(6)),f=o(n(18)),p=n(51),m=n(20),g=n(127),v=o(n(1027)),h=n(71);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var E=function(e){(0,l.default)(n,e);var t=y(n);function n(e){var a;return(0,s.default)(this,n),(a=t.call(this,e)).getMentionEndingKey=function(e){var t="more";switch(e){case 0:t="zero";break;case 1:t="one"}return t},a.getMessageComponent=function(){var e=a.props,t=e.message,n=e.hideNotification,o=null;if(t)try{var r=(0,p.getCleanText)(t);r=r.replace(/\n/gm," ").replace(/\&nbsp;/gm," "),o=c.default.createElement("em",{className:v.default.message},r)}catch(e){n()}return o},a.getTitleComponent=function(){var e=a.props,t=e.item,n=e.user,o=e.message,r=t.totalCount,s="notifications.types."+t.type;t.type===g.NotificationType.MENTION&&(s+=".".concat(a.getMentionEndingKey(r)));var i=null,l="";switch(t.type){case g.NotificationType.MENTION:case g.NotificationType.REPLIED_YOUR_MESSAGE:n&&(l=o&&o.userDisplayName||(0,m.getDisplayName)(n)),i=c.default.createElement(h.TranslatedText,{className:v.default.description,textKey:s,params:{totalCount:r,username:l},pluralValue:r});break;case g.NotificationType.LIKED_MESSAGE:n&&(l=(0,m.getDisplayName)(n)),i=c.default.createElement(h.TranslatedText,{className:v.default.description,textKey:s,params:{totalCount:r,username:l},pluralValue:r});break;default:i=c.default.createElement(h.TranslatedText,{className:v.default.description,textKey:s,params:{totalCount:r},pluralValue:r})}return i},a.state={messageComponent:null,titleComponent:null},a}return(0,i.default)(n,[{key:"componentDidMount",value:function(){var e=this.getMessageComponent(),t=this.getTitleComponent();this.setState({messageComponent:e,titleComponent:t})}},{key:"render",value:function(){var e=this.props,t=e.item,n=e.message,a=this.state,o=a.messageComponent,s=a.titleComponent,i=t.conversationTitle,l=(0,f.default)(v.default.title,(0,r.default)({},v.default.noMessage,!n));return c.default.createElement("div",{className:v.default.content},s,c.default.createElement("span",{className:l},i),o)}}]),n}(c.Component);t.Content=E},1028:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Details=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=a(n(6)),c=o(n(18)),f=o(n(432)),p=o(n(56)),m=n(127),g=o(n(1029));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var h=function(e){(0,i.default)(n,e);var t=v(n);function n(){return(0,r.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"render",value:function(){var e=this.props.item,t=null;switch(e.type){case m.NotificationType.REPLIED_YOUR_MESSAGE:case m.NotificationType.ALSO_REPLIED:t="commentIcon";break;case m.NotificationType.LIKED_MESSAGE:t="voteUpIcon";break;case m.NotificationType.MENTION:t="mentionIcon"}return d.default.createElement("div",{className:(0,c.default)(g.default.details,g.default[t])},d.default.createElement(p.default,{className:g.default.icon,selector:t}),d.default.createElement("div",{className:g.default.updatedAt},d.default.createElement(f.default,{date:e.updatedAt,longDate:!0})))}}]),n}(d.Component);t.Details=h},1032:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(6)),r=a(n(1033)),s=n(47),i=function(){return o.default.createElement("div",{className:r.default.notificationsEmptyState},o.default.createElement("div",{className:r.default.placeholder},o.default.createElement("div",{className:r.default.circle}),o.default.createElement("div",{className:r.default.line1}),o.default.createElement("div",{className:r.default.line2})),o.default.createElement("div",{className:r.default.title},o.default.createElement(s.TranslationWrapper,{i18nKey:"notification.emptyStateTitle"},"No Notifications Yet :(")),o.default.createElement("div",{className:r.default.subtitle},o.default.createElement(s.TranslationWrapper,{i18nKey:"notification.emptyStateBody"},"Start interacting with others and your inbox will be full in no time!")))};t.default=i},1034:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityIndicator=void 0;var o=a(n(6)),r=a(n(178)),s=a(n(1));t.ActivityIndicator=function(){return o.default.createElement(r.default,{rtl:!s.default.get("init_data.config.ltr"),width:310,height:280,speed:2,backgroundColor:getComputedStyle(document.documentElement).getPropertyValue("--spotim-content-loader-primary-color"),foregroundColor:getComputedStyle(document.documentElement).getPropertyValue("--spotim-content-loaders-secondary-color")},o.default.createElement("circle",{cx:"47",cy:"47",r:"17"}),o.default.createElement("rect",{x:"73",y:"30",rx:"8",ry:"8",width:"174",height:"13"}),o.default.createElement("rect",{x:"73",y:"50",rx:"8",ry:"8",width:"139",height:"13"}),o.default.createElement("circle",{cx:"47",cy:"138",r:"17"}),o.default.createElement("rect",{x:"73",y:"121",rx:"8",ry:"8",width:"174",height:"13"}),o.default.createElement("rect",{x:"73",y:"141",rx:"8",ry:"8",width:"139",height:"13"}),o.default.createElement("circle",{cx:"47",cy:"229",r:"17"}),o.default.createElement("rect",{x:"73",y:"212",rx:"8",ry:"8",width:"174",height:"13"}),o.default.createElement("rect",{x:"73",y:"232",rx:"8",ry:"8",width:"139",height:"13"}))}},1037:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ConversationSurvey=void 0;var r=o(n(49)),s=a(n(6)),i=o(n(1));t.ConversationSurvey=function(e){var t=e.commentsRootCount,n=e.postId,a=(0,s.useRef)(null),o=function(e,t){var n,a;e&&(null===(n=window)||void 0===n||null===(a=n.__SPOTIM__)||void 0===a||a.renderSurvey({element:e,postId:t}))},l=(0,s.useMemo)((function(){var e=i.default.get("tenant_config.conversation-survey.enabled",!1),n=i.default.get("tenant_config.conversation-survey.minimum_num_of_comments",10);return e&&n<=t}),[t]);return(0,s.useEffect)((function(){return function(){if(null==a?void 0:a.current){var e=new IntersectionObserver((function(e,t){(0,r.default)(e,1)[0].isIntersecting&&(t.disconnect(),o(a.current,n))}),{threshold:[.99],rootMargin:"0px 0px ".concat("-160px"," 0px")});return e.observe(a.current),function(){(null==a?void 0:a.current)&&e.unobserve(a.current)}}}()}),[l]),l&&s.default.createElement("div",{ref:a})}},1038:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldRenderUserMenu=t.isPCAForceDisabled=t.claimDisqusForumAccount=t.getloadMoreCommentsTextKey=t.getRichEditorPlaceholder=void 0;t.getRichEditorPlaceholder=function(e){var t=e.messagesCount,n=e.isStarsRatingEnabled;return t>0?n?"richEditor.placeholder.hasMessagesWithStarsRatingEnabled":"richEditor.placeholder.hasMessages":n?"richEditor.placeholder.noMessagesWithStarsRatingEnabled":"richEditor.placeholder.noMessages"};t.getloadMoreCommentsTextKey=function(e){return e.isLiveBlog?"liveBlog.loadMoreReplies":"inpage.conversation.loadMoreReplies"};t.claimDisqusForumAccount=!1;t.isPCAForceDisabled=!1;t.shouldRenderUserMenu=function(){return!0}},122:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.removeFeaturedComment=function(e){return function(){var t=(0,r.default)(o.default.mark((function t(n,a){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:s.REMOVE_FEATURED_COMMENT,payload:e}),t.prev=1,t.next=4,(0,i.removeAsFeatured)(e,(function(){l(!0)}));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(e,n){return t.apply(this,arguments)}}()},t.pinFeaturedComment=u,t.addFeaturedComment=function(e,t){return function(){var n=(0,r.default)(o.default.mark((function n(a,r){var l,d;return o.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return l=r(),d=l.conversation.postId,a({type:s.ADD_FEATURED_COMMENT,payload:e}),n.prev=2,n.next=5,(0,i.setAsFeaturedMessage)(e,t,(function(){u(e)}),d);case 5:n.next=9;break;case 7:n.prev=7,n.t0=n.catch(2);case 9:case"end":return n.stop()}}),n,null,[[2,7]])})));return function(e,t){return n.apply(this,arguments)}}()},t.updateShouldFetchFeaturedComment=void 0;var o=a(n(37)),r=a(n(38)),s=n(39),i=n(941),l=function(e){return{type:s.UPDATE_SHOULD_FETCH_FEATURED_COMMENT,payload:e}};function u(e){return function(){var t=(0,r.default)(o.default.mark((function t(n,a){var r;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a(),r.conversation.postId,n({type:s.PIN_FEATURED_COMMENT,payload:e}),t.prev=2,t.next=5,(0,i.pinFeaturedCommentApi)(e);case 5:t.next=9;break;case 7:t.prev=7,t.t0=t.catch(2);case 9:case"end":return t.stop()}}),t,null,[[2,7]])})));return function(e,n){return t.apply(this,arguments)}}()}t.updateShouldFetchFeaturedComment=l},179:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.votesType=t.VotesType=void 0;var o,r=a(n(1));t.VotesType=o,function(e){e.Like="like",e.UpDown="updown",e.Recommend="recommend"}(o||(t.VotesType=o={}));var s=r.default.get("tenant_config.shared.votes_type",o.Like);t.votesType=s},181:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getNotifications=function(e){var t=e.offset,n=e.count,a={offset:t,count:n};return(0,o.default)("notifications/my-notifications",{data:a})},t.getAndResetNotifications=function(){return(0,o.default)("notifications/my-notifications-and-reset-unseen",{})},t.markNotificationAsRead=function(e){var t=e.notificationId;return(0,o.default)("notifications/mark_as_read",{method:"POST",data:{notifications_ids:[t]}})},t.markAllNotificationsAsRead=function(e){var t=e.notificationIds;return(0,o.default)("notifications/mark_as_read",{method:"POST",data:{notifications_ids:t}})};var o=a(n(73))},246:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ViewportGuard=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=a(n(6)),c=o(n(46)),f=n(787),p=n(77),m=n(401),g=n(352);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var h=function(e){(0,i.default)(n,e);var t=v(n);function n(e){var a;return(0,r.default)(this,n),(a=t.call(this,e)).guardRef=d.default.createRef(),a.onViewportChange=function(e){var t=a.props.useViewportObserver;a.isRendered&&(t&&e.isVisible||!t&&"FULL_ENTER"===e?a.onEnter():a.onLeave())},a.isRendered=!1,a.state={overflow:e.visibleOnMount?"visible":"hidden",height:e.visibleOnMount?"auto":0},a}return(0,s.default)(n,[{key:"componentDidMount",value:function(){if(!g.isChrome&&!g.isSafari){var e=this.guardRef.current;this.props.viewportObserver.getVisibilityState(e).isVisible&&this.onEnter(),this.isRendered=!0,this.updateMargins()}}},{key:"updateMargins",value:function(){var e=this.guardRef.current;if(e.childNodes.length>0&&e.childNodes[0].nodeType===Node.ELEMENT_NODE){var t=e.childNodes[0],n=window.getComputedStyle(t);e.style.margin=n.margin,g.isFirefox||p.isIE||g.isEdge||t.style.setProperty("margin","0","important")}}},{key:"onEnter",value:function(){var e=this;"visible"!==this.state.overflow&&this.setState({overflow:"visible",height:"auto"},(function(){return e.props.onSizeChange()}))}},{key:"onLeave",value:function(){if("hidden"!==this.state.overflow){var e=this.guardRef.current;if(e){for(var t=0,n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeType===Node.ELEMENT_NODE&&(t+=(0,m.outerHeight)(e.childNodes[n]));this.setState({overflow:"hidden",height:t})}}}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.viewportObserver,a=e.className,o=e.tagName,r=e.useViewportObserver,s=this.state,i=s.overflow,l=s.height;if(g.isChrome||g.isSafari)return d.default.createElement("div",{className:a},t);var u=d.default.createElement(o,{ref:this.guardRef,style:{overflow:i,height:l},className:a},t);return r?d.default.createElement(f.ElementObserver,{viewportObserver:n,onViewportChange:this.onViewportChange},u):u}}]),n}(d.Component);t.ViewportGuard=h,h.displayName="ViewportGuard",h.propTypes={viewportObserver:c.default.object.isRequired,children:c.default.element.isRequired,onSizeChange:c.default.func,visibleOnMount:c.default.bool,className:c.default.string,tagName:c.default.string,useViewportObserver:c.default.bool},h.defaultProps={onSizeChange:function(){},visibleOnMount:!1,className:void 0,tagName:"div"}},250:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getUserModerationStatus=t.setUserModerationStatus=void 0;var o=a(n(37)),r=a(n(38)),s=n(39),i=a(n(948)),l=n(81),u=n(44),d=function(e,t,n){return{type:s.MODERATION_USER_STATUS,payload:{message:{id:e.id},isUserAllowed:n,isUserBlocked:t}}};t.setUserModerationStatus=d;t.getUserModerationStatus=function(e){return function(){var t=(0,r.default)(o.default.mark((function t(n,a){var r,s,c,f,p,m,g,v,h,y;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a(),s=r.conversation.postId,c=r.moduleOptions.spotId,f=!1,!u.isModerationV2BlockAndAllowUserEnabled){t.next=12;break}return t.next=5,(0,i.default)(e.user.id,s);case 5:m=t.sent,g=m.blocked,v=m.allowed,f=g,p=v,t.next=17;break;case 12:return t.next=14,(0,l.getWhiteListUserStatus)({spotId:c,userId:e.user.id});case 14:h=t.sent,y=h.isWhiteListed,p=y;case 17:n(d(e,f,p));case 18:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}},251:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=new(a(n(995)).default);t.default=o},28:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=o(n(53)),f=a(n(6)),p=o(n(46)),m=o(n(18)),g=n(45),v=n(4),h=o(n(1)),y=a(n(96)),E=n(725),M=o(n(729)),b=o(n(782)),S=o(n(400)),R=o(n(785)),C=o(n(994)),T=o(n(996)),w=o(n(999)),I=o(n(203)),O=o(n(251)),k=o(n(456)),_=a(n(50)),N=n(1011),x=a(n(1012)),D=n(63),P=o(n(1013)),U=n(460),L=n(1037),A=n(136),B=n(107),F=n(80),j=n(446),V=n(44),K=n(117),W=o(n(48)),H=n(55),q=o(n(440)),G=n(43),z=n(47);function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var Y=h.default.get("tenant_config.conversation.isSocialValueEnabled",!1),J=(0,f.lazy)((function(){return Promise.all([n.e(0),n.e(22),n.e(60)]).then(n.t.bind(null,1099,7))})),Z=(0,f.lazy)((function(){return Promise.all([n.e(0),n.e(87)]).then(n.t.bind(null,1105,7))})),X=(0,f.lazy)((function(){return Promise.all([n.e(0),n.e(23)]).then(n.t.bind(null,461,7))})),$=function(e){(0,l.default)(a,e);var t=Q(a);function a(){var e;(0,s.default)(this,a);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={},e.snippets=n(1038),e.getSnippets=function(){return e.snippets},e.handleStarRatingModuleVote=function(t){var n=t.detail;e.props.conversation.id===n.conversationId&&e.props.onRatingsClick(n.rank)},e.subscribeToStarRating=function(){document.addEventListener("spot-im-star-rating-module-vote",e.handleStarRatingModuleVote)},e.unSubscribeToStarRating=function(){document.removeEventListener("spot-im-star-rating-module-vote",e.handleStarRatingModuleVote)},e.scrollToComments=function(){var t=(0,v.findDOMNode)(e.messagesStackElement).getBoundingClientRect().top;(0,q.default)(window,t,200)},e.renderUserMenu=function(t){var n=t.currentUser,a=t.useDisqusLogin,o=t.handleDisqusLogin,r=t.onNotificationClick,s=t.direction,i=t.claimDisqusForumAccount,l=t.postId;return f.default.createElement("div",{"data-spot-im-class":"registration-buttons",className:k.default.registrationButtons},!(0,D.isLoggedIn)(n)&&a&&!e.props.isLiveBlog&&i&&f.default.createElement(b.default,{onClick:e.openDiscusForumAccount}),!(0,D.isLoggedIn)(n)&&a&&!e.props.isLiveBlog&&f.default.createElement(S.default,{onClick:o,postId:l}),f.default.createElement(P.default,{onNotificationClick:r,direction:s,showCircleIcon:!1}),f.default.createElement(w.default,null))},e.openDiscusForumAccount=function(){(0,H.dispatchSpotimEvent)(A.DISQUS_FORUM_CLAIM_EVENT_NAME)},e.viewMessage=function(t){e.messagesStackElement&&e.messagesStackElement.wrappedInstance.viewMessage(t)},e.handleLogin=function(){var t=e.props,n=t.tracking,a=t.conversation;(0,t.onLogin)();var o={item_type:"login",target_type:"commnet-sign-up",type:"login-clicked",post_id:a.postId};n.trackEvent(o)},e.handleUploadProfileImage=function(t){var n=e.props.currentUser;e.props.onProfileImageUpload({userId:n.id,rawImage:t})},e.handleUserProfileClick=function(){var t=e.props.currentUser;(t.isRegistered||t.displayName)&&e.props.onOpenUserProfileModal({user:t,mode:"main"})},e.shouldDisplayUsername=function(){var t=e.props,n=t.forceRegister;return t.currentUser.isRegistered||!n},e.getSurveyComponent=function(){var t=e.props,n=t.hasNextComments,a=t.isLiveBlog,o=t.conversation,r=t.commentsList,s=o.postId;return n&&!a&&f.default.createElement(L.ConversationSurvey,{commentsRootCount:r.rootOrder.length,postId:s})},e}return(0,i.default)(a,[{key:"componentDidMount",value:function(){O.default.on("scrollToComments",this.scrollToComments);var e=this.props,t=e.conversation.messagesCount,n=e.tracking;t>0&&x.init(n,(0,v.findDOMNode)(this.messagesStackElement)),this.subscribeToStarRating()}},{key:"componentWillUnmount",value:function(){O.default.off("scrollToComments",this.scrollToComments),this.unSubscribeToStarRating()}},{key:"render",value:function(){var e,t=this,n=this.props,a=n.spotId,o=n.comments,s=n.conversation,i=n.isStarsRatingEnabled,l=n.isConnectEnabled,u=n.enableSSO,d=n.editableSSO,c=n.onNotificationClick,p=n.verifyEmailSent,g=n.summaryWidget,v=n.pagination,h=n.pageSize,b=n.useDisqusLogin,S=n.isSafari,w=n.onVerifyEmailSend,I=n.currentUser,O=n.onLoadMore,_=n.handleDisqusLogin,N=n.loadMoreMessagesText,x=n.isLoadingMoreComments,D=n.hasNextComments,P=n.direction,U=n.isLiveBlog,L=n.isReporter,A=n.isLiveBlogOnline,B=n.href,F=(n.commentsList,n.liveBlogEndDate),K=n.liveBlogStartDate,W=n.isReadOnly,H=s.messagesCount,q=s.commentsCount,Q=s.postId,$=this.getSnippets().getRichEditorPlaceholder({messagesCount:H,isStarsRatingEnabled:i}),ee=this.snippets.claimDisqusForumAccount,te=y.getAggregatedStacksSequence(o),ne=0===H,ae=(0,m.default)(k.default.conversation,(e={},(0,r.default)(e,k.default.emptyState,ne),(0,r.default)(e,k.default.safari,S),e)),oe=this.getSnippets().getloadMoreCommentsTextKey({isLiveBlog:U});return f.default.createElement("div",{ref:function(e){return t.wrapper=e},"data-spot-im-class":"conversation-body",className:ae},i&&f.default.createElement(f.Suspense,{fallback:null},f.default.createElement(J,{summaryWidget:g,conversation:s})),f.default.createElement(f.Suspense,{fallback:null},U&&f.default.createElement("div",{className:k.default.topStrip,"data-spot-im-class":"top-strip"},f.default.createElement(f.default.Fragment,null,f.default.createElement(X,{liveBlogEndDate:F,liveBlogStartDate:K,isEmpty:ne,isReporter:L,isLiveBlogOnline:A}),!L&&this.renderUserMenu({currentUser:I,useDisqusLogin:b,handleDisqusLogin:_,onNotificationClick:c,direction:P,claimDisqusForumAccount:ee,postId:Q})))),(!U||L)&&f.default.createElement("div",{className:(0,m.default)(k.default.userAreaContainer,(0,r.default)({},k.default.hasUserUsername,this.shouldDisplayUsername()))},W?f.default.createElement(z.TranslationWrapper,{i18nKey:"commentingEnded"},f.default.createElement(G.Typography,{type:"h4"},"Commenting on this article has ended")):this.shouldDisplayUsername()&&f.default.createElement(j.UserSayControlDetails,{spotId:a,currentUser:I,enableSSO:u,editableSSO:d,handleLogin:this.handleLogin,handleUploadProfileImage:this.handleUploadProfileImage,handleUserProfileClick:this.handleUserProfileClick}),(!u||I.isRegistered||V.enableSsoLogin)&&this.renderUserMenu({currentUser:I,useDisqusLogin:b,handleDisqusLogin:_,onNotificationClick:c,direction:P,claimDisqusForumAccount:ee,postId:Q})),l&&!u&&f.default.createElement(E.CompleteEmailRegistration,{currentUser:I,email:I.email,isEmailVerified:I.isEmailVerified,onVerifyEmailSend:w,isVerificationEmailSent:p,spotId:a,hostUrl:B}),!W&&(!U||L)&&f.default.createElement(C.default,{placeholderTextKey:$}),!ne&&f.default.createElement(T.default,{conversation:s,sortBy:v.sortBy,pageSize:h}),f.default.createElement(f.Suspense,{fallback:null},Y&&!U&&f.default.createElement(Z,{spotId:a})),f.default.createElement(R.default,{key:"messageStack",ref:function(e){t.messagesStackElement=e},stackList:o,commentsCount:q-te.length,currentUser:I,hasNextComments:D}),!V.isSurveyBelowShowMoreCommentsEnabled&&this.getSurveyComponent(),f.default.createElement(M.default,{hasNext:D,loadMoreMessagesText:N,isLoading:x,onLoadMore:O,textKey:oe}),V.isSurveyBelowShowMoreCommentsEnabled&&this.getSurveyComponent())}}]),a}(f.Component);$.propTypes={spotId:p.default.string.isRequired,direction:p.default.oneOf(["rtl","ltr"]).isRequired,currentUser:p.default.object.isRequired,isStarsRatingEnabled:p.default.bool,isConnectEnabled:p.default.bool.isRequired,useDisqusLogin:p.default.bool.isRequired,conversation:p.default.any.isRequired,enableSSO:p.default.bool,verifyEmailSent:p.default.bool.isRequired,pagination:p.default.object.isRequired,comments:p.default.object.isRequired,summaryWidget:p.default.object.isRequired,isSafari:p.default.bool,pageSize:p.default.number,onVerifyEmailSend:p.default.func.isRequired,onNotificationClick:p.default.func.isRequired,onLoadMore:p.default.func.isRequired,loadMoreMessagesText:p.default.string,isLoadingMoreComments:p.default.bool.isRequired,hasNextComments:p.default.bool.isRequired,handleDisqusLogin:p.default.func.isRequired,isReporter:p.default.bool,isLiveBlog:p.default.bool,isLiveBlogOnline:p.default.bool,hasCommunity:p.default.bool,href:p.default.string},$.defaultProps={isSafari:!1,isReporter:!1,isLiveBlog:!1,isLiveBlogOnline:!1};var ee=(0,c.default)((0,g.connect)((function(e){var t=e.moduleOptions,n=e.currentUser,a=e.registration,o=e.comments,r=e.conversation,s=e.isReadOnly,i=t.spotId,l=t.isStarsRatingEnabled,u=t.isConnectEnabled,d=t.enableSSO,c=t.useDisqusLogin,f=t.textsOverrides,p=t.direction,m=t.isSafari,g=t.hasCommunity,v=t.href,h=t.conversationId,y=t.editableSSO,E=t.forceRegister,M=a.verifyEmailSent,b=o.loadingFromShowMore,S=o.pagination.hasNext,R=o.list,C=_.isReporter(e,n.id),T=_.isLiveBlog(e),w=_.isLiveBlogOnline(e),I=_.getLiveBlogEndDate(e),O=_.getLiveBlogStartDate(e);return{spotId:i,isStarsRatingEnabled:l,isConnectEnabled:u,enableSSO:d,useDisqusLogin:c,verifyEmailSent:M,currentUser:n,loadMoreMessagesText:f.conversationLoadMoreMessagesText,isLoadingMoreComments:b,hasNextComments:S,direction:p,isSafari:m,conversation:r,isReporter:C,isLiveBlog:T,isLiveBlogOnline:w,hasCommunity:g,href:v,commentsList:R,liveBlogEndDate:I,liveBlogStartDate:O,conversationId:h,editableSSO:y,forceRegister:E,isReadOnly:s}}),(function(e){return{onVerifyEmailSend:function(t){var n=t.email,a=t.spotId,o=t.url;return e((0,I.default)({email:n,spotId:a,url:o}))},onLoadMore:function(){return e((0,N.loadMore)())},handleDisqusLogin:K.initDisqusLogin,onRatingsClick:function(t){e((0,U.rankConversation)(t))},onLogin:function(){e((0,F.openLoginSelectorModal)({mode:"signup"}))},onProfileImageUpload:function(t){var n=t.rawImage;e((0,D.profileImageUpload)({rawImage:n}))},onOpenUserProfileModal:function(t){var n=t.user,a=t.overrideDisplayName,o=t.overrideImageId,r=t.mode;e((0,B.openUserProfileModal)({user:n,overrideDisplayName:a,overrideImageId:o,mode:r}))}}}),null,{forwardRef:!0}),(0,W.default)({},{forwardRef:!0}))($);t.default=ee},401:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.outerWidth=function(e){var t=e.offsetWidth,n=getComputedStyle(e);return t+=parseInt(n.marginLeft)+parseInt(n.marginRight)},t.outerHeight=function(e){var t=e.offsetHeight,n=getComputedStyle(e);return t+=parseInt(n.marginTop)+parseInt(n.marginBottom)},t.empty=function(e){e.innerHTML=""},t.addClass=r,t.removeClass=s,t.hasClass=i,t.toggleClass=function(e,t){i(e,t)?s(e,t):r(e,t)},t.setElementStyle=function(e,t,n){e.style[t]=n},t.position=function(e){return{left:e.offsetLeft,top:e.offsetTop}},t.offset=function(e){var t=e.getBoundingClientRect();return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}},t.closest=function(e,t){for(var n=t.charAt(0);e&&e!==document;e=e.parentNode){if("."===n&&e.classList.contains(t.substr(1)))return e;if("#"===n&&e.id===t.substr(1))return e;if("["===n&&e.hasAttribute(t.substr(1,t.length-2)))return e;if(e.tagName.toLowerCase()===t)return e}return},t.ready=function(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)};var o=a(n(7));function r(e,t){if(t&&(t=t.trim()).length>0)if(e.classList)e.classList.add(t);else if("string"==typeof e.className)e.className+=" "+t;else if("object"===(0,o.default)(e.className)){var n=e.getAttribute("class")||"";e.setAttribute("class",n+" "+t)}}function s(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}function i(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)}},402:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=o(n(46)),c=a(n(6)),f=o(n(18)),p=o(n(788)),m=n(47),g=n(43);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var h=function(e){(0,i.default)(n,e);var t=v(n);function n(){return(0,r.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"render",value:function(){var e=this.props,t=e.messagesCount,n=e.onClick,a=e.isLiveBlog,o=(0,f.default)(p.default.showNewButton,"brand-bg-color","brand-bg-color-hover");return c.default.createElement("div",{className:p.default.showNewButtonWrapper},c.default.createElement("div",{className:p.default.leftSeparator}),c.default.createElement(g.Button,{mode:"primary",className:o,onClick:n},c.default.createElement("span",null,t>1&&(a?c.default.createElement(m.TranslationWrapper,{i18nKey:"liveBlog.showNewUpdates",values:{messagesCount:t}}):c.default.createElement(m.TranslationWrapper,{i18nKey:"inpage.conversation.showNewMessages",values:{messagesCount:t}})),1===t&&(a?c.default.createElement(m.TranslationWrapper,{i18nKey:"liveBlog.showNewUpdate",values:{messagesCount:t}},"Show 1 New Update"):c.default.createElement(m.TranslationWrapper,{i18nKey:"inpage.conversation.showNewMessage",values:{messagesCount:t}},"Show 1 New Comment")))),c.default.createElement("div",{className:p.default.rightSeparator}))}}]),n}(c.Component);h.propTypes={messagesCount:d.default.number,onClick:d.default.func,isLiveBlog:d.default.bool},h.defaultProps={messagesCount:"",onClick:function(){}};var y=h;t.default=y},403:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ConversationTyping=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=a(n(6)),f=o(n(18)),p=o(n(789)),m=n(790),g=o(n(93)),v=n(101),h=n(44);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var E=function(e){(0,l.default)(n,e);var t=y(n);function n(){return(0,s.default)(this,n),t.apply(this,arguments)}return(0,i.default)(n,[{key:"render",value:function(){var e=this.props,t=e.users,n=e.className,a=e.size,o=e.typingUsersCount;e.spotId;if(o>0&&t.length>0){var s,i=t[t.length-1],l="large"===a?"medium":"normal",u=(0,f.default)(n,p.default.conversationTyping,(0,r.default)({},p.default.small,"small"===a)),d=(0,f.default)((s={},(0,r.default)(s,p.default.userImageWrapper,!h.disableUserAvatar||o>1),(0,r.default)(s,p.default.counter,o>1),s),p.default[l]),y={height:"".concat(v.USER_IMAGE_SIZE.NORMAL,"px"),width:"".concat(v.USER_IMAGE_SIZE.NORMAL,"px")};return c.default.createElement("div",{className:u},c.default.createElement("div",{className:d,style:h.disableUserAvatar&&o>1?y:{},"data-typing-users-count":o},c.default.createElement(g.default,{isOnline:!1,size:v.USER_IMAGE_SIZE.NORMAL,disableUserImageUpload:!0,disableTooltip:!0,user:i})),c.default.createElement("div",{className:p.default.details,"data-spot-im-class":"typing-animation-box"},c.default.createElement(m.TypingAnimation,{transparent:!0})))}return null}}]),n}(c.Component);t.ConversationTyping=E,E.defaultProps={size:"large",users:[]}},405:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MessageStack=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=o(n(53)),c=a(n(6)),f=o(n(18)),p=n(45),m=n(246),g=o(n(1)),v=o(n(797)),h=o(n(438)),y=o(n(974)),E=o(n(976)),M=o(n(980)),b=o(n(982)),S=n(435),R=a(n(50)),C=n(983),T=n(95),w=o(n(984)),I=o(n(109)),O=n(54),k=o(n(437));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var N=g.default.get("isConversationPageTriggered",!1),x=function(e){(0,i.default)(n,e);var t=_(n);function n(){var e;(0,r.default)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).showPostCommentAction=!1,e.messageRef=c.default.createRef(),e.viewMessage=function(t){e.messageRef.current&&e.messageRef.current.wrappedInstance.viewMessage(t)},e}return(0,s.default)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.stack,n=e.highlightMessage,a=e.shouldHighlightImmediate;e.t;a&&n(t.message.id)}},{key:"render",value:function(){var e,t=this.props,n=t.stack,a=t.className,o=t.starsRating,r=t.enterAnimationDisabled,s=t.messageIndex,i=t.repliesMaxDepth,l=t.isEdit,u=t.showReplySayControl,d=t.isTheFirstMessage,p=t.isLastMessageInThread,g=(t.shouldCollapseReplies,t.isPostCommentActionEnabled);u&&(e=(0,I.default)(n,"message.userDisplayName")||(0,I.default)(n,"message.user.displayName")||(0,I.default)(n,"message.user.username"));var S=null;if(!n.isAggregated){var R=(0,f.default)(w.default.messageStack,a),C=n.message;if(C.isCollapsed)return null;S=c.default.createElement("div",{className:R},!l&&c.default.createElement(v.default,{ref:this.messageRef,message:C,enterAnimationDisabled:r,messageIndex:s,isTheFirstMessage:d}),l&&c.default.createElement(h.default,{autoFocus:!0,stackId:n.id,className:(0,f.default)(w.default.replyWrapper,w.default["depth-".concat(Math.min(C.depth,i)-1)]),rootMessageId:C.rootMessageId||C.id,messageToEdit:C,parentMessageId:C.parentMessageId,userImageSize:"medium",isCollapsed:!0,depth:C.depth,starsRating:o,isEditRichEditor:!0}),c.default.createElement(b.default,{message:C,repliesMaxDepth:i,isLegacyEnabled:g&&C.isMine}),u&&c.default.createElement(h.default,{starsRating:o,autoFocus:!0,focusOnUpdate:!1,stackId:n.id,className:(0,f.default)(w.default.replyWrapper,w.default["depth-".concat(Math.min(C.depth,i-1))]),rootMessageId:C.rootMessageId||C.id,replyToStackId:n.id,replyToMessage:C,parentMessageId:C.id,userImageSize:"medium",depth:C.depth+1,isEditRichEditor:!1,placeholderTextKey:"richEditor.placeholder.replyTo",placeholderReplyToName:e}),c.default.createElement(y.default,{messageStack:n}),c.default.createElement(E.default,{messageStack:n}),c.default.createElement(M.default,{depth:C.depth,isLastMessageInThread:p,messageStack:n})),C.isNew&&!C.isMine&&(S=c.default.createElement(m.ViewportGuard,{viewportObserver:T.viewportObserver},S))}return S}}]),n}(c.Component);t.MessageStack=x,x.defaultProps={isEdit:!1,starsRating:-1,messageIndex:-1,shouldHighlightImmediate:!1,isMobileDevice:!1,showReplySayControl:!0,highlightMessage:function(){},isTheFirstMessage:!1,onDoneLoadingReplies:function(){},shouldCollapseReplies:!1};var D=(0,d.default)((0,p.connect)((function(e,t){var n=e.moduleOptions,a=e.messageSayControls,o=e.comments,r=e.conversation,s=r.isSubmittingReply,i=r.submittedReplyParentMessageId,l=r.isSubmittingEdit,u=r.editedMessageId,d=t.stack,c=n.direction,f=n.repliesMaxDepth,p=n.highlightedCommentId,m=n.highlightedReplyId,g=n.highlightImmediate,v=n.isMobile,h=n.shouldCollapseReplies,y=d.message.id,E=o.isPostCommentActionEnabled,M=(y===p||y===m)&&g,b=a[y],S=R.isMobile(e)||v,C=R.wasAggregated(e,d.id),T=R.isLiveBlog(e),w=0===d.message.depth,I=!!(null==b?void 0:b.isEdit)||l&&u===y;return{showReplySayControl:!!(s&&i===y||b&&b.isCreate&&(!T||!w)),starsRating:b&&b.starsRating,isEdit:I,direction:c,repliesMaxDepth:f,isPostCommentActionEnabled:E,messageSayControl:b,enterAnimationDisabled:C,isMobileDevice:S,shouldHighlightImmediate:M,shouldCollapseReplies:h}}),(function(e){return{expandChildren:function(t){e((0,C.expandChildren)(t))},highlightMessage:function(t){(0,k.default)((function(){e((0,S.scrollToMessage)(t,N))}))}}}),null,{forwardRef:!0}),(0,O.withTranslation)(void 0,{withRef:!0}))(x);t.default=D},425:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.label,n=e.showSpinner;return o.default.createElement("div",{className:(0,r.default)(i.default.wrapper,n&&i.default.showSpinner)},o.default.createElement("div",{className:i.default.label},t),o.default.createElement("div",{className:i.default.spinnerWrapper},o.default.createElement(s.default,null)))};var o=a(n(6)),r=a(n(18)),s=a(n(86)),i=a(n(900))},426:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.openMessageSayControl=function(e){var t=e.messageId;return function(){var e=(0,s.default)(r.default.mark((function e(n,a){var o,s;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=a(),s=l.isLiveBlog(o),n({type:i.OPEN_MESSAGE_SAY_CONTROL,payload:{messageId:t,isLiveBlog:s}});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()};var r=o(n(37)),s=o(n(38)),i=n(39),l=a(n(50))},427:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getUpvotes=function(e){var t=e.messageDepth,n=e.messageId,a=e.conversationId,m=e.offset,g=e.count;return function(){var e=(0,s.default)(o.default.mark((function e(s,v){var h,y,E,M,b,S,R;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,h=v().conversation.postId,s({type:u.REQUEST_GET_UP_VOTES,payload:{messageDepth:t,messageId:n,conversationId:a,spotId:p.spotId,offset:m,count:g}}),e.next=5,(0,l.getUpvotesRequest)(t,n,p.spotId,m,g,h);case 5:y=e.sent,E=v(),M=E.comments.list.messages,b=E.currentUser,S=M[n],R=f.default.map(y.Users,(0,d.getUsersMap)("",y.Users)),S.message.isVotedUp&&(R=(0,i.default)([].concat((0,r.default)(R),[b]),"id")),s({type:u.RESPONSE_GET_UP_VOTES,payload:{users:R,messageDepth:t,conversationId:a,messageId:n,spotId:p.spotId,offset:m,count:g}}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),s({type:u.RESPONSE_GET_UP_VOTES,payload:{error:e.t0},error:!0}),c.metrics.error("getUpvotes",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}()};var o=a(n(37)),r=a(n(87)),s=a(n(38)),i=a(n(916)),l=n(917),u=n(39),d=n(152),c=n(3),f=a(n(83)),p=n(44)},429:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(49)),s=a(n(6)),i=o(n(18)),l=n(43),u=n(54),d=n(48),c=o(n(56)),f=o(n(86)),p=n(20),m=o(n(52)),g=n(51),v=o(n(925)),h=o(n(926)),y=n(3),E=n(79),M=n(44),b=n(417),S=function(e){var t=e.show,n=e.onClose,a=e.message,o=e.spotName,S=e.currentUser,R=e.postId,C=(0,s.useState)(""),T=(0,r.default)(C,2),w=T[0],I=T[1],O=(0,s.useState)(!1),k=(0,r.default)(O,2),_=k[0],N=k[1],x=(0,s.useState)(""),D=(0,r.default)(x,2),P=D[0],U=D[1],L=(0,u.useTranslation)().t,A=(0,d.useTracking)();function B(e,t){return'"'.concat(e,'"  ').concat(t)}function F(e,t){if(t.preventDefault(),"link"!==e){var n=function(e,t,n){var o=encodeURIComponent(t);switch(e){case"facebook":return"https://www.facebook.com/sharer/sharer.php?u=".concat(o);case"email":return"mailto:?subject=".concat(n,"&body=").concat(o);case"twitter":var r=(0,g.getCleanText)(a),s="@".concat(a.user.username),i=B("",s),l=B(r.substring(0,113-i.length)+"...",s),u=encodeURIComponent(l);return"https://twitter.com/intent/tweet?text=".concat(u,"&url=").concat(o)}}(e,w,P),o=["width=500","height=400","left="+(window.innerWidth-500)/2,"top="+(window.innerHeight-400)/2.5].join(",");if("email"===e){var r=m.default?"_top":"_blank";window.open(n,r)}else window.open(n,void 0,o)}else N(!0);A.trackEvent({type:"share-message-clicked",item_type:"main",target_type:e,user_id:S.id,is_registered:S.isRegistered})}return(0,s.useEffect)((function(){if(t&&!w){var e,n=(0,p.getDisplayName)(S);(0,b.getMessageShareUrl)({messageDepth:a.depth,messageId:a.id,postId:R}).then((function(e){I(e)})),e=L("share.emailSubject",{username:n,spotName:o}),U(e),y.metrics.send("share_modal_shown")}}),[t]),s.default.createElement(l.Modal,{disableCustomBodyScroll:M.disableModalDefaultScroll,shadowRootCssModules:E.isUseShadowDomOnOverlays?["conversation"]:void 0,isLtr:M.isLtr,closeButton:!0,className:v.default.shareModal,showModal:t,onClose:n,modalTitle:L("shareModal.title","Share Post"),size:"sm",fullScreenMobile:!1},!w&&s.default.createElement("div",{className:v.default.spinnerWrapper},s.default.createElement(f.default,null)),s.default.createElement("div",{className:(0,i.default)(v.default.shareButtons,w&&v.default.show)},s.default.createElement("a",{href:"#",onClick:F.bind(null,"facebook"),className:v.default.shareButton},s.default.createElement(c.default,{className:(0,i.default)(v.default.icon,v.default.facebookIcon),selector:"facebookIcon"})),s.default.createElement("a",{href:"#",onClick:F.bind(null,"twitter"),className:v.default.shareButton},s.default.createElement(c.default,{className:(0,i.default)(v.default.icon,v.default.twitterIcon),selector:"twitterIcon"})),s.default.createElement("a",{href:"#",onClick:F.bind(null,"email"),className:v.default.shareButton},s.default.createElement(c.default,{className:(0,i.default)(v.default.icon,v.default.emailIcon),selector:"emailIcon"})),s.default.createElement("a",{href:"#",onClick:F.bind(null,"link"),className:v.default.shareButton},s.default.createElement(c.default,{className:(0,i.default)(v.default.icon,v.default.linkIcon),selector:"linkIcon"}))),_&&s.default.createElement("div",{className:v.default.linkWrapper},s.default.createElement("input",{className:v.default.linkInput,value:w}),s.default.createElement("button",{className:v.default.copyLinkButton,onClick:function(){(0,h.default)(w)}},L("share.copy","Copy"))))};t.default=S},430:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=o(n(53)),f=a(n(6)),p=n(45),m=n(43),g=n(54),v=o(n(18)),h=n(355),y=o(n(931)),E=n(47),M=n(44),b=n(52),S=o(n(1));function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var C=(0,n(5).formatLanguageCode)(S.default.get("init_data.config.main_language","en")),T=S.default.get("tenant_config.conversation.translation_text_overrides.".concat(C),{}),w=function(e){(0,l.default)(n,e);var t=R(n);function n(){var e;(0,s.default)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).customBadge=function(t){var n=null;switch(e.props.badge){case h.Badges.REPORTER:n=e.getRoleBadge(t,e.props.reporterBadgeText,h.Badges.REPORTER);break;case h.Badges.JOURNALIST:n=e.getRoleBadge(t,e.props.journalistBadgeText,h.Badges.JOURNALIST);break;case h.Badges.COMMUNITY_MODERATOR:n=e.getRoleBadge(t,e.props.communityModeratorBadgeText,h.Badges.COMMUNITY_MODERATOR);break;case h.Badges.MODERATOR:n=e.getRoleBadge(t,e.props.moderatorBadgeText,h.Badges.MODERATOR);break;case h.Badges.ADMIN:n=e.getRoleBadge(t,e.props.adminBadgeText,h.Badges.ADMIN);break;case h.Badges.SUBSCRIBER:n=e.getSubscriberBadge()}return n},e.getRoleBadge=function(t,n,a){var o=e.props.spotName,r=(0,v.default)(y.default.isRoleBadge,y.default[a]),s=null==T?void 0:T[t];return f.default.createElement("span",{className:r,"data-open-web-class":"user-badge"},s||!n?f.default.createElement(E.TranslationWrapper,{i18nKey:t,values:{spotName:o}}):n)},e.getSubscriberBadge=function(){var t=e.props.t,n=M.subscriberIcon.name,a=M.subscriberIcon.type;return f.default.createElement("div",{"data-balloon-pos":"up","aria-label":t("conversation.user.badges.subscriber","Subscribed"),className:y.default.subscriber},f.default.createElement(m.Icon,{name:n,type:a}))},e}return(0,i.default)(n,[{key:"render",value:function(){var e=this.props,t=e.badge,n=e.className,a=e.badgeTextKey,o=t===h.Badges.MODERATOR||t===h.Badges.REPORTER||t===h.Badges.ADMIN||t===h.Badges.COMMUNITY_MODERATOR||t===h.Badges.JOURNALIST||t===h.Badges.SUBSCRIBER,s=null,i=(0,v.default)(n,y.default.badge,(0,r.default)({},y.default.isRoleBadge,t!==h.Badges.SUBSCRIBER));if(o){a="user.badges."+t.toLowerCase();s=t===h.Badges.COMMUNITY_MODERATOR?f.default.createElement(m.Tooltip,{isLtr:M.isLtr,placement:"bottom",trigger:(0,b.isMobile)()?"click":"hover",tooltipContent:f.default.createElement("div",{className:y.default.tooltipContainer},f.default.createElement(m.Typography,{color:"#fff",type:"infoXs",weight:"bold"},f.default.createElement(E.TranslationWrapper,{i18nKey:a},"Community Moderator")),f.default.createElement(m.Typography,{color:"#fff",type:"infoXs",className:y.default.communityModeratorDescriptionText},f.default.createElement(E.TranslationWrapper,{i18nKey:"user.badges.communityModeratorDescription"},"Top members of the community entrusted in keeping discussions civil")))},f.default.createElement(m.Icon,{className:y.default.communityModeratorShieldBadge,type:"custom",name:"community-moderator-shield"})):f.default.createElement("span",{className:i,"data-spot-im-class":"user-badge"},this.customBadge(a))}return s}}]),n}(f.PureComponent),I=(0,c.default)((0,p.connect)((function(e){return{spotId:e.moduleOptions.spotId}})),(0,g.withTranslation)())(w);t.default=I},431:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MessageReplyTo=function(e){var t=e.message,n=(0,r.getDisplayName)({id:t.replyToUserId||"",username:t.replyToUsername||"",displayName:t.replyToDisplayName||"",isRegistered:!1});if(!n)return null;return o.default.createElement(o.default.Fragment,null,o.default.createElement(s.default,{className:i.default.replyToIcon,selector:"chevronRightIcon"}),o.default.createElement(l.Typography,{type:"infoSm",className:i.default.replyUsername},n))};var o=a(n(6)),r=n(20),s=a(n(56)),i=a(n(932)),l=n(43)},432:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(70)),r=a(n(66)),s=a(n(6)),i=n(934),l=n(54),u=n(43);var d=function(e){var t=(0,l.useTranslation)().t;function n(){var n=e.date,a="number"==typeof n?new Date(1e3*n):n;return(0,i.toolTipDate)(a,t)}e.longDate;var a=(0,r.default)(e,["longDate"]);return s.default.createElement(u.Typography,{type:"infoSm"},s.default.createElement("time",(0,o.default)({},a,{"aria-label":n(),title:n()}),function(){var n=e.date,a=e.longDate,o="number"==typeof n?new Date(1e3*n):n;return(0,i.prettyDate)(o,a,t)}()))};t.default=d},433:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.deleteMessage=function(e){var t=e.message;return function(){var e=(0,s.default)(r.default.mark((function e(n,a){var o,s,p,g,v,h,y,E;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o="delete_".concat(0===t.depth?"comment":"reply"),i.metrics.apm.start(o),n({type:u.DELETE_MESSAGE_START,payload:{message:t}}),s=t.rootMessageId,p=a(),g=p.conversation.messagesCount,v=p.moduleOptions.postId,!l.isModerationV2DeleteEnabled){e.next=12;break}return e.next=9,c.deleteMessage(t.id,v);case 9:h=e.sent,e.next=21;break;case 12:if(!(t.depth>0)){e.next=18;break}return e.next=15,(0,f.deleteReply)(s,t.id);case 15:h=e.sent,e.next=21;break;case 18:return e.next=20,(0,f.deleteComment)(t.id);case 20:h=e.sent;case 21:y=m(h.body),(E=y.conversation).messagesCount=g,n({type:u.DELETE_MESSAGE_END,payload:{conversation:E,starsRating:t.starsRating||0}}),"top"===t.featuredComment&&n((0,d.updateShouldFetchFeaturedComment)(!0)),i.metrics.apm.end(o),e.next=32;break;case 28:e.prev=28,e.t0=e.catch(0),n({type:u.DELETE_MESSAGE_END,payload:{error:e.t0},error:!0}),i.metrics.error("delete",e.t0);case 32:case"end":return e.stop()}}),e,null,[[0,28]])})));return function(t,n){return e.apply(this,arguments)}}()},t.parse=m;var r=o(n(37)),s=o(n(38)),i=n(3),l=n(44),u=n(39),d=n(122),c=a(n(82)),f=n(81),p=o(n(83));function m(e){return p.default.map(e,{etag:"conversation.etag",messages_count:"conversation.messagesCount",comments_count:"conversation.commentsCount",soft_deleted:"rootMessage.isDeleted","comment.id":"rootMessage.id","comment.replies_count":"rootMessage.repliesCount"})}},434:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openEditSayControl=function(e){var t=e.messageId,n=e.starsRating;return{type:a.OPEN_EDIT_SAY_CONTROL,payload:{messageId:t,starsRating:n}}};var a=n(39)},435:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scrollToMessage=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var s=r().moduleOptions.elementId;(0,a.scrollAndHighlightMessage)(e,s,t),n((0,o.markMessage)({id:e}))}};var a=n(409),o=n(408)},436:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return function(){var n=(0,s.default)(r.default.mark((function n(a,o){var s,c,f,p,m;return r.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=o(),c=s.conversation,c.contentType,f=c.postId,p=s.moduleOptions.spotId,"add"!==e){n.next=14;break}if(!u.isModerationV2BlockAndAllowUserEnabled){n.next=8;break}return n.next=5,l.addUserToAllowedList(t.user.id,f);case 5:m=n.sent,n.next=11;break;case 8:return n.next=10,(0,i.addWhiteListUser)({spotId:p,userId:t.user.id});case 10:m=n.sent;case 11:m.isWhiteListed=!0,n.next=25;break;case 14:if(!u.isModerationV2BlockAndAllowUserEnabled){n.next=20;break}return n.next=17,l.removeUserFromAllowedList(t.user.id,f);case 17:m=n.sent,n.next=24;break;case 20:return n.next=22,(0,i.removeWhiteListUser)({spotId:p,userId:t.user.id});case 22:(m=n.sent).isWhiteListed=!1;case 24:m.isWhiteListed=!1;case 25:(m.isSuccess||m)&&a((0,d.setUserModerationStatus)(t,t.user.isBlockListed,m.isWhiteListed));case 26:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()};var r=o(n(37)),s=o(n(38)),i=n(81),l=a(n(82)),u=n(44),d=n(250)},437:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=!1;function o(e){"undefined"!=typeof window?window.addEventListener("load",e):e()}o((function(){a=!0}));var r=function(e){e&&"function"==typeof e&&(a||"complete"===document.readyState?e():o(e))};t.default=r},438:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MessageSayControl=void 0;var r=o(n(33)),s=o(n(37)),i=o(n(38)),l=o(n(35)),u=o(n(36)),d=o(n(40)),c=o(n(41)),f=o(n(42)),p=o(n(53)),m=a(n(6)),g=n(45),v=o(n(1)),h=n(180),y=o(n(52)),E=n(949),M=n(950),b=n(951),S=n(439),R=n(441),C=n(176),T=n(442),w=n(954),I=n(443),O=n(80),k=a(n(50)),_=n(63),N=n(444),x=n(445),D=a(n(91)),P=n(446),U=n(107),L=n(447),A=o(n(48)),B=n(44);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,f.default)(e);if(t){var o=(0,f.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}var K=(0,m.lazy)((function(){return Promise.all([n.e(0),n.e(17),n.e(24)]).then(n.t.bind(null,467,7))})),W=function(e){(0,d.default)(n,e);var t=V(n);function n(){var e;(0,l.default)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).wrapperRef=void 0,e.getDraftKey=function(){var t=e.props,n=t.stackId,a=t.depth;return"conversation_".concat(n,"-depth-").concat(a)},e.handleFocus=function(t){var n=t.element,a=e.props,o=a.conversationId,r=a.stackId;e.props.onFocus({element:n,stackId:r}),e.props.tracking.trackEvent({type:"editor-reply-focus",ugc_post_id:o})},e.handleBlur=function(){var t=e.props.stackId;e.props.onBlur({stackId:t})},e.handleCloseEditSayControl=function(t){var n=t.messageId;e.props.closeEditSayControl({messageId:n})},e.handleUploadProfileImage=function(t){e.props.onProfileImageUpload({rawImage:t})},e.editMessage=function(t){var n=t.entities,a=t.displayName,o=t.starsRating,r=void 0===o?0:o,s=e.props,i=s.messageToEdit,l=s.editMessage,u=i.depth,d=i.status,c=i.starsRating;l({entities:n,oldEntities:i.entities,starsRating:r,oldStarsRating:c,depth:u,messageId:i.id,displayName:a,status:d})},e.createMessage=function(t){var n=t.entities,a=t.displayName,o=t.starsRating,r=void 0===o?0:o,s=e.props,i=s.replyToMessage,l=s.rootMessageId,u=s.replyToStackId,d=(s.conversationId,{entities:n,starsRating:r,rootMessageId:l});return a&&(d.displayName=a),u&&(d.replyToStackId=u),i&&(d.parentMessageId=i.id,d.replyToUserId=i.user.id,d.replyToUsername=i.user.username,d.replyToDisplayName=i.userDisplayName||i.user.displayName,d.depth=i.depth+1),(0,h.clearDraftMessage)(e.getDraftKey()),e.props.createMessage(d)},e.handleStarsRatingClick=function(t){var n=e.props.messageToEdit.id;e.props.onStarsRatingClick(t,n)},e.handleRichEditorContract=function(){e.props.onContract({messageId:e.props.replyToMessage.id})},e.onTyping=function(t){var n=e.props,a=n.isMessageBlocked,o=n.onTyping,r=n.closeModerationAlert,s=n.isModerationAlertVisible,i=n.isUserSuspended,l=n.currentUser,u=n.isAfterClickFeedback;!i&&a&&s&&D.isValidKeyPress(t)&&(r(),u&&e.props.tracking.trackEvent({item_type:"realtime-moderation",user_id:l.id,is_registered:l.isRegistered,type:"post-edited",target_type:"after-post"})),o()},e.onRealtimeModeration=function(t){var n=e.props,a=n.isMessageBlocked,o=n.onRealtimeModeration;a||o(t)},e.setWrapperRef=function(t){e.wrapperRef=t},e.handleClickOutside=function(t){var n=e.props.isModerationAlertVisible,a=null==t?void 0:t.composedPath();try{var o,r=a.some((function(e){var t;return null===(t=e.dataset)||void 0===t?void 0:t.spotimOverlay}));(null===(o=e.wrapperRef)||void 0===o?void 0:o.contains(a[1]))||r||e.state.hasText||n||e.handleRichEditorContract()}catch(e){}},e.onChange=function(t){var n=t.isEmpty;e.setState({hasText:!n})},e.handleUserProfileClick=function(){var t=e.props.currentUser;(t.isRegistered||t.displayName)&&e.props.onOpenUserProfileModal({user:t,mode:"main"})},e.shouldDisplayUsername=function(){var t=e.props,n=t.forceRegister,a=t.currentUser;return!n||a.isRegistered},e}return(0,u.default)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.isRendered,a=t.isEditRichEditor,o=t.replyToMessage,r=t.messageToEdit,s=t.onRendered,i=a?r.id:o.id;n||s(i),requestAnimationFrame((function(){return document.addEventListener("click",e.handleClickOutside)}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClickOutside)}},{key:"handleLogin",value:function(){var e=this.props,t=e.tracking,n=e.onLogin,a=e.postId;n();var o={item_type:"login",target_type:"commnet-sign-up",type:"login-clicked",post_id:a};t.trackEvent(o)}},{key:"render",value:function(){var e,t=this.props,n=(t.conversationId,t.currentUser),a=t.spotId,o=t.isUploadImageButtonVisible,r=t.className,s=t.animationRating,i=t.blurOnFocusForGuestUser,l=t.isStarsRatingEnabled,u=t.disableSendButtonWithEmptyText,d=t.forceRegister,c=t.placeholderTextKey,f=t.direction,p=t.messageToEdit,g=t.userImageSize,v=(t.onTyping,t.showButton),h=t.starsRating,y=t.enableRichToolbar,E=t.depth,M=t.isMobileDevice,b=t.useExpandButton,S=t.isEditRichEditor,R=t.placeholderReplyToName,C=t.replyToMessage,T=t.autoFocus,w=t.moderationAlert,I=t.isModerationAlertVisible,O=t.isModerationAlertRendered,k=t.isMessageBlocked,N=t.isUserSuspended,x=t.preventScrollOnAutoFocus,D=t.isDisableRichFormatting,U=t.onLogin;return m.default.createElement("div",{ref:this.setWrapperRef,className:r},this.shouldDisplayUsername()&&m.default.createElement(P.UserSayControlDetails,{currentUser:n,handleUploadProfileImage:this.handleUploadProfileImage,handleUserProfileClick:this.handleUserProfileClick}),m.default.createElement(L.EditorWrapper,{isExpanded:this.props.isExpanded,isDisableRichFormatting:D,onChange:this.onChange,tabIndexType:"message-details",showButton:v,starsRating:h,spotId:a,useExpandButton:b,login:this.handleLogin.bind(this),onStarsRatingClick:this.handleStarsRatingClick,isLoggedIn:(0,_.isLoggedIn)(n),isUploadImageButtonVisible:o,enableStarsRating:l&&0===E,isMustRegisterToComment:d,createMessage:this.createMessage,editMessage:this.editMessage,onTyping:this.onTyping,onFocus:this.handleFocus,onBlur:this.handleBlur,closeEditRichEditor:this.handleCloseEditSayControl,uploadProfileImage:this.handleUploadProfileImage,userImageSize:g,placeholderTextKey:c,placeholderReplyToName:R,direction:f,messageToEdit:p,currentUser:n,enableRichToolbar:y,isMobileDevice:M,animationRating:s,disableSendButtonWithEmptyText:u,blurOnFocusForGuestUser:i,isEditRichEditor:S,msnSocialLogin:U,replyToMessage:C,autoFocus:T,onContract:this.handleRichEditorContract,isReply:!0,moderationAlert:w,showErrorBorder:I&&O,isPostAnyway:k&&!N,onRealtimeModeration:this.onRealtimeModeration,isEdit:(null==p||null===(e=p.entities)||void 0===e?void 0:e.length)>0,preventScrollOnAutoFocus:x,draftKey:this.getDraftKey()}))}}]),n}(m.Component);t.MessageSayControl=W,W.defaultProps={isStarsRatingEnabled:!1,forceRegister:!1,isExpanded:!1,autoFocus:!1,onTyping:function(){},onFocus:function(){},onBlur:function(){},onLogin:function(){},onStarsRatingClick:function(){},createMessage:function(){},onRendered:function(){},editMessage:function(){},closeEditSayControl:function(){},placeholderTextKey:"richEditor.placeholder.hasMessages",userImageSize:"medium",showButton:!0,focusOnUpdate:!0,moderationAlert:null,isModerationAlertVisible:!1,isModerationAlertRendered:!1,isMessageBlocked:!1,preventScrollOnAutoFocus:!1};var H=(0,p.default)((0,g.connect)((function(e,t){var n,a=e.currentUser,o=e.moduleOptions,r=e.messageSayControls,s=e.userSuspension,i=o.spotId,l=o.enableSSO,u=o.animationRating,d=o.isConnectEnabled,c=o.isStarsRatingEnabled,f=o.forceRegister,p=o.direction,g=o.conversationRichToolbarEnabled,h=o.isMobile,E=o.disableSendButtonWithEmptyText,M=o.blurOnFocusForGuestUser,b=o.liveBlogRichToolbarEnabled,S=o.isConversationLiveBlog,R=o.postId,C=o.conversationId,T=t.messageToEdit,w=t.replyToMessage,I=t.isEditRichEditor,O=t.parentMessageId,_=r[I?T&&T.id:w&&w.id],N=null==_?void 0:_.isExpanded,x=null==_?void 0:_.isRendered,D=r.settings.isModerationAlertRendered,P=s.isUserSuspended,U=v.default.get("isConversationPageTriggered",!1),L=k.isReporter(e,a.id),A=b&&S&&L,F=S?!B.disableImageUploadInLiveBlog:!B.disableImageUploadInConversation,j=_||{},V=j.isModerationAlertVisible,W=j.verdict,H=j.moderationTags,q=j.isMessageBlocked,G=j.tempMessageId,z=V&&m.default.createElement(m.Suspense,{fallback:null},m.default.createElement(K,{verdict:W,moderationTags:H,isRealtimeFeedback:!q,sayControlSessionId:G})),Q=v.default.get("tenant_config.conversation.forceSimpleEditor",!1),Y=O&&(null===(n=r[O])||void 0===n?void 0:n.isMessageBlocked);return{conversationId:C,currentUser:a,spotId:i,isUploadImageButtonVisible:F,isStarsRatingEnabled:c,forceRegister:f,direction:p,disableSendButtonWithEmptyText:E,blurOnFocusForGuestUser:M,isMobileDevice:y.default||h,animationRating:u,showButton:d&&!l,enableRichToolbar:!y.default&&!h&&(g||A),enableSSO:l,isRendered:x,moderationAlert:z,isModerationAlertVisible:V,isModerationAlertRendered:D,isMessageBlocked:q,isUserSuspended:P,isExpanded:N,preventScrollOnAutoFocus:U,postId:R,isDisableRichFormatting:Q,isAfterClickFeedback:Y}}),(function(e,t){var n,a=t.isEditRichEditor,o=t.parentMessageId;return{onTyping:function(){a||e((0,T.notifyTyping)(o))},onFocus:function(t){var n=t.element,r=t.stackId;a||e((0,T.notifyTyping)(o)),e((0,S.focusSayControl)({element:n,stackId:r,depth:1}))},onRendered:function(t){e((0,E.SayControlRendered)({messageId:t}))},onBlur:function(t){var n=t.stackId;e((0,R.blurSayControl)({stackId:n}))},onLogin:function(){e((0,O.openLoginSelectorModal)())},onStarsRatingClick:(n=(0,i.default)(s.default.mark((function t(n,a){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e((0,I.updateStarsRating)(n,a));case 1:case"end":return t.stop()}}),t)}))),function(e,t){return n.apply(this,arguments)}),closeEditSayControl:function(t){var n=t.messageId;e((0,M.closeEditSayControl)({messageId:n}))},createMessage:function(t){return e((0,C.createMessage)(t))},editMessage:function(t){e((0,w.editMessage)(t))},onProfileImageUpload:function(t){var n=t.rawImage;e((0,_.profileImageUpload)({rawImage:n}))},onContract:function(t){var n=t.messageId;e((0,b.closeReplySayControl)({messageId:n}))},onOpenUserProfileModal:function(t){var n=t.user,a=t.overrideDisplayName,o=t.overrideImageId,r=t.mode;e((0,U.openUserProfileModal)({user:n,overrideDisplayName:a,overrideImageId:o,mode:r}))},closeModerationAlert:function(){return e((0,N.closeModerationAlert)(o))},onRealtimeModeration:function(t){e((0,x.realtimeModerate)(j(j({},t),{},{parentMessageId:o})))}}})),(0,A.default)({}))(W);t.default=H},439:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.focusSayControl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.element,n=e.stackId,a=void 0===n?null:n,f=e.depth;return function(e,n){if((0,u.dispatchSpotimEvent)(d.CURRENT_USER_TYPING_START),o.default){var p=document.body.getBoundingClientRect(),m=t.getBoundingClientRect().top-p.top;(0,c.default)(window,m-20,200)}var g=n(),v=g.currentUser,h=g.moduleOptions.loginUponSayControlFocus,y=(0,i.isLoggedIn)(v);h&&!y&&e((0,r.openLoginSelectorModal)()),e((0,l.fetchUserSuspensionStatus)()),e({type:s.FOCUS_SAY_CONTROL,payload:{stackId:a,depth:f}})}};var o=a(n(52)),r=n(80),s=n(39),i=n(63),l=n(952),u=n(55),d=n(59),c=a(n(440))},440:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scrollToTop=function(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=window.pageYOffset,r=e-o;window.requestAnimationFrame((function e(s){n||(n=s);var i=s-n,l=Math.min(i/t,1);window.scrollTo(0,o+r*l),i<t?window.requestAnimationFrame(e):a()}))},t.default=t.EASINGS=void 0;var a={LINEAR:function(e){return e},IN_OUT_QUART:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e}};t.EASINGS=a;var o=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a.LINEAR;return new Promise((function(a){var r=window===e;if(n<=0)a();else{var s=r?e.pageYOffset:e.scrollTop,i=t-s,l=Date.now()+n;requestAnimationFrame((function e(){var r=1-(l-Date.now())/n;if(r>=0&&r<=1){var d=o(r)*i;u(Math.floor(s+d)),requestAnimationFrame(e)}else u(t),a()}))}function u(t){r?e.scroll(0,t):e.scrollTop=t}}))};t.default=o},441:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.blurSayControl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.stackId,n=void 0===t?null:t;return function(){var e=(0,r.default)(o.default.mark((function e(t,a){var r,d;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a(),(null==(d=r.communityView)?void 0:d.focusSayControlOnSwitchTab)&&t((0,i.setIsFocusSayControl)(!1)),(0,u.dispatchSpotimEvent)(l.CURRENT_USER_TYPING_END),t({type:s.BLUR_SAY_CONTROL,payload:{stackId:n}});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()};var o=a(n(37)),r=a(n(38)),s=n(39),i=n(118),l=n(59),u=n(55)},442:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.notifyTyping=function(e){return function(t,n){try{var a=n().conversation.id;u[e]?u[e]():u[e]=(0,r.default)((function(){i.notifyTyping(a,e)}),l.TYPING_NOTIFY_INTERVAL,null,{trailing:!1})}catch(e){s.metrics.error("notifyTyping",e)}}};var r=o(n(153)),s=n(3),i=a(n(953)),l=n(97),u={}},443:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.updateStarsRating=function(e,t){return function(){var n=(0,r.default)(o.default.mark((function n(a){var r;return o.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:try{r=e,a(t?{type:s.RANK_CONVERSATION_MESSAGE_SAY_CONTROL,payload:{starsRating:r,messageId:t}}:{type:s.RANK_CONVERSATION,payload:{starsRating:r}})}catch(e){a({type:s.RANK_CONVERSATION,payload:{error:error},error:!0}),i.metrics.error("updateStarsRating",e)}case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()};var o=a(n(37)),r=a(n(38)),s=n(39),i=n(3)},444:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.closeModerationAlert=function(e){return{type:a.CLOSE_MODERATION_ALERT,payload:{parentMessageId:e}}};var a=n(39)},445:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.realtimeModerate=function(e){var t=e.entities,n=void 0===t?[]:t,a=e.starsRating,c=void 0===a?0:a,f=e.parentMessageId;return function(){var e=(0,r.default)(o.default.mark((function e(t,a){var r,p,m,g,v,h;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=a(),p=r.moduleOptions.postId,!(0===n.length||1===n.length&&n.find((function(e){return"text"===e.type&&""===e.text})))){e.next=6;break}return t({type:s.REALTIME_MODERATE,payload:{verdict:u.TPolicyVerdict.APPROVE_ALL,tags:[],parentMessageId:f}}),e.abrupt("return");case 6:return m=(0,i.createEntitiesData)(n),e.next=9,(0,d.onTyping)(p,{content:m,stars:c,metadata:{}});case 9:g=e.sent,v=g.verdict,h=g.tags,t({type:s.REALTIME_MODERATE,payload:{verdict:v,tags:h,parentMessageId:f}}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),t({type:s.REALTIME_MODERATE,payload:{error:e.t0,parentMessageId:f}}),l.metrics.error("realtimeModerate",e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,n){return e.apply(this,arguments)}}()};var o=a(n(37)),r=a(n(38)),s=n(39),i=n(420),l=n(3),u=n(160),d=n(177)},446:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.UserSayControlDetails=void 0;var o=a(n(33)),r=a(n(6)),s=a(n(18)),i=n(44),l=n(77),u=a(n(93)),d=a(n(955)),c=n(101),f=n(43),p=n(47),m=n(956),g=n(45),v=n(48),h=n(20),y=n(64),E=a(n(430)),M=(0,g.connect)((function(e){var t=e.moduleOptions,n=t.enableGamificationBadges,a=t.spotName,o=t.textsOverrides,r=o.moderatorBadgeText,s=o.communityModeratorBadgeText,i=o.reporterBadgeText,l=o.adminBadgeText,u=o.journalistBadgeText,d=e.liveBlogConfig.reporters,c=e.conversation;return{contentType:c.contentType,convId:c.id,moderatorBadgeText:r,communityModeratorBadgeText:s,reporterBadgeText:i,enableGamificationBadges:n,adminBadgeText:l,journalistBadgeText:u,spotName:a,reporters:d}}))((function(e){var t,n=e.currentUser,a=e.handleUploadProfileImage,g=e.handleUserProfileClick,M=e.contentType,b=e.convId,S=e.moderatorBadgeText,R=e.communityModeratorBadgeText,C=e.reporterBadgeText,T=e.adminBadgeText,w=e.journalistBadgeText,I=e.enableGamificationBadges,O=e.spotName,k=e.reporters,_=n.isRegistered&&i.enableUserReputation&&!(0,l.isStaffMember)(n),N=(0,v.useTracking)();function x(){M===y.ContentType.Post&&N.trackEvent({type:"my-profile-clicked",item_type:"post-card",ugc_post_id:b})}var D=(0,h.getDisplayName)(n),P=D&&!i.disableUserProfile?d.default.username:d.default.emptyUsername,U=Array.isArray(k)&&(k.some((function(e){return e===n.username}))||k.some((function(e){return e===n.id}))),L=(0,l.getUserBadge)(n,U);return r.default.createElement(c.Row,{className:(0,s.default)((0,o.default)({},d.default.usernameWrapper,!i.disableUserAvatar))},r.default.createElement(u.default,{className:d.default.richEditorUserAvatar,isOnline:n.isOnline,size:c.USER_IMAGE_SIZE.NORMAL,onImageUpload:a,user:n,onClick:function(){x()}}),r.default.createElement(f.Button,{onClick:function(){i.disableUserProfile||(x(),g())},className:(0,s.default)((0,o.default)({},d.default.emptyUsername,!D||i.disableUserProfile))},r.default.createElement(f.Typography,{type:"username",className:P,"data-open-web-class":"user-name"},D||r.default.createElement(p.TranslationWrapper,{i18nKey:"richEditor.placeholder.displayName"},"Your Username"))),r.default.createElement(E.default,{user:n,spotName:O,badge:L,reporterBadgeText:C,moderatorBadgeText:S,communityModeratorBadgeText:R,adminBadgeText:T,journalistBadgeText:w,enableGamificationBadges:I}),!n.isRegistered&&((0,l.isUserDisplayNameBlocked)(n.id)?r.default.createElement("div",{className:d.default.guestBadge},r.default.createElement("span",{className:d.default.dotSeparator}),r.default.createElement(f.Typography,{type:"infoMd"},r.default.createElement(p.TranslationWrapper,{i18nKey:"general.guest"},"Guest"))):null),_&&r.default.createElement(m.UserPoints,{total:(null===(t=n.reputation)||void 0===t?void 0:t.total)||1,isLtr:i.isLtr}))}));t.UserSayControlDetails=M},447:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"EditorWrapper",{enumerable:!0,get:function(){return a.EditorWrapper}});var a=n(958)},448:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;var o=a(n(70)),r=a(n(66)),s=a(n(6)),i=a(n(977)),l=a(n(18));t.Button=function(e){var t=e.children,n=e.className,a=(0,r.default)(e,["children","className"]);return s.default.createElement("button",(0,o.default)({},a,{type:"button",className:(0,l.default)(n,i.default.emptyButton)}),t)}},449:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(6)),r=a(n(18)),s=a(n(178)),i=a(n(1)),l=a(n(978)),u=function(e){var t=e.className,n=void 0===t?"":t;return o.default.createElement("div",{className:(0,r.default)(l.default.messageContentLoader,n)},o.default.createElement(s.default,{rtl:!i.default.get("init_data.config.ltr"),height:313,width:646,speed:2,backgroundColor:getComputedStyle(document.documentElement).getPropertyValue("--spotim-content-loader-primary-color"),foregroundColor:getComputedStyle(document.documentElement).getPropertyValue("--spotim-content-loaders-secondary-color")},o.default.createElement("circle",{cx:"62",cy:"69",r:"24"}),o.default.createElement("rect",{x:"104",y:"51",rx:"5",ry:"5",width:"174",height:"13"}),o.default.createElement("rect",{x:"104",y:"73",rx:"5",ry:"5",width:"139",height:"13"}),o.default.createElement("rect",{x:"39",y:"110",rx:"5",ry:"5",width:"499",height:"15"}),o.default.createElement("rect",{x:"39",y:"141",rx:"5",ry:"5",width:"431",height:"15"}),o.default.createElement("circle",{cx:"62",cy:"226",r:"24"}),o.default.createElement("rect",{x:"104",y:"208",rx:"5",ry:"5",width:"174",height:"13"}),o.default.createElement("rect",{x:"104",y:"230",rx:"5",ry:"5",width:"139",height:"13"}),o.default.createElement("rect",{x:"39",y:"267",rx:"5",ry:"5",width:"499",height:"15"}),o.default.createElement("rect",{x:"39",y:"298",rx:"5",ry:"5",width:"431",height:"15"})))};t.default=u},450:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=a(n(6)),f=o(n(46)),p=o(n(18)),m=o(n(56)),g=n(448),v=o(n(449)),h=o(n(981)),y=n(47);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var M=function(e){(0,l.default)(n,e);var t=E(n);function n(){var e;(0,s.default)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).getMessagesCount=function(e){var t=e.numCollapsedChildren,n=e.forceMessagesCollapsed,a=e.allCount,o=e.numNewComments,r=e.moreCount;return t||(n?a-o:r)},e.handleShowMoreReplies=function(){e.props.showMoreReplies()},e}return(0,i.default)(n,[{key:"render",value:function(){var e,t=this.props,n=t.isLoading,a=t.moreCount,o=t.allCount,s=t.isLastMessageInThread,i=t.enableShowMore,l=t.numNewComments,u=t.forceMessagesCollapsed,d=t.numCollapsedChildren,f=t.messageStack,E=t.depth,M=f.hasNext&&0===f.childrenStackIds.length,b=(0,p.default)(h.default.showMoreReplies,h.default["depth-".concat(E)],(e={},(0,r.default)(e,h.default.showMore,M||d),(0,r.default)(e,h.default.loading,n),(0,r.default)(e,h.default.lastMessage,s||d||i&&M),e)),S=this.getMessagesCount({numCollapsedChildren:d,forceMessagesCollapsed:u,allCount:o,numNewComments:l,moreCount:a});return c.default.createElement("div",{className:b},n?c.default.createElement(v.default,null):(d||i&&M)&&c.default.createElement(g.Button,{className:h.default.showMoreRepliesButton,onClick:this.handleShowMoreReplies},c.default.createElement("span",null,c.default.createElement("span",{className:h.default.showText},c.default.createElement(y.TranslationWrapper,{i18nKey:"inpage.conversation.showMoreMessages",values:{messagesCount:S},count:S}),c.default.createElement(m.default,{selector:"chevronDownIcon",className:h.default.chevron})))))}}]),n}(c.Component);M.propTypes={showMoreReplies:f.default.func.isRequired,isLoading:f.default.bool,moreCount:f.default.number,isLastMessageInThread:f.default.bool,enableShowMore:f.default.bool,forceMessagesCollapsed:f.default.bool,onDoneLoading:f.default.func,numNewComments:f.default.number,numCollapsedChildren:f.default.number,depth:f.default.number},M.defaultProps={showMoreReplies:function(){},enableShowMore:!0};var b=M;t.default=b},452:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.NativeAdUnit=t.isConvAdsStyleV2=void 0;var r=o(n(49)),s=a(n(6)),i=o(n(18)),l=o(n(1)),u=n(43),d=o(n(988)),c=o(n(989)),f=o(n(991)),p=(0,s.lazy)((function(){return Promise.all([n.e(0),n.e(92),n.e(85)]).then(n.t.bind(null,1158,7))})),m=l.default.get("tenant_config.conversation.adsLazyLoadMargin","600px"),g=2===l.default.get("tenant_config.conversation.ads_style_version",1);t.isConvAdsStyleV2=g;var v=g?10:25,h=g?10:25;function y(e,t){return e?0:g?t:t+v+h}t.NativeAdUnit=function(e){var t=e.index,n=e.onHideAd,a=(0,s.useState)(!1),o=(0,r.default)(a,2),l=o[0],E=o[1],M=(0,s.useState)(!1),b=(0,r.default)(M,2),S=b[0],R=b[1],C=(0,s.useState)(g?0:160),T=(0,r.default)(C,2),w=T[0],I=T[1],O=(0,s.useState)(null),k=(0,r.default)(O,2),_=k[0],N=k[1],x=(0,s.useCallback)((function(e){N(e)}),[]),D=(0,f.default)({ref:_,rootMargin:m,useOnce:!0});(0,s.useEffect)((function(){S&&setTimeout((function(){E(!0)}),2500)}),[S]);var P=(0,s.useCallback)((function(){l&&n()}),[l]);return s.default.createElement("li",{className:(0,i.default)(d.default.conversationAdsUnit),"data-spotim-class":"conversation-ads-unit",onTransitionEnd:P,key:"ads-unit-".concat(t),style:{height:y(l,w),paddingTop:"".concat(v,"px"),paddingBottom:"".concat(h,"px")}},S?!l&&s.default.createElement("div",{id:"spotim-specific",className:d.default.hiddenAdPlacement},s.default.createElement("span",{className:d.default.checkboxIcon},s.default.createElement(u.Icon,{type:"fa-solid",name:"check-circle"})),s.default.createElement(u.Typography,{type:"modalBody"},"Ads will no longer be shown on this conversation."),s.default.createElement(u.Typography,{type:"infoMd"},"Thank you for your feedback!")):s.default.createElement(s.default.Fragment,null,s.default.createElement(s.Suspense,{fallback:g?null:s.default.createElement(c.default,null)},s.default.createElement("div",{ref:x,className:d.default.nativeAdWrapper},D&&s.default.createElement(p,{moduleName:"conversation",reportingModuleName:"conversation",onNoAdAvailable:function(){E(!0),R(!0)},onHideAd:function(){return R(!0)},onDimensionsChange:function(e){var t=e.height;I(t)},enableContextMenu:!g})))))}},455:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.fetchConversation=function(e){var t=e.spotId,n=e.postId,a=e.conversationId,o=e.href,s=e.canonicalHref,p=e.offset,g=e.commentsRead,v=e.pageSize,h=e.sortBy,y=e.highlight,E=e.depth,M=e.isFromShowMore;return function(){var e=(0,i.default)(r.default.mark((function e(i,b){var S,R,C;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.metrics.apm.start("fetch_conversation"),S=b(),R=S.conversation,(0,f.saveUserLastSorting)(h),i({type:c.FETCH_CONVERSATION_START,payload:{isFromShowMore:M}}),e.next=6,u.fetchConversation(t,n,a,{href:o,canonicalHref:s,offset:p,commentsRead:g,pageSize:v,sortBy:h,highlight:y,depth:E}).catch((function(e){i({type:c.FETCH_CONVERSATION_END,payload:{error:e},error:!0}),l.metrics.error("fetchConversation",e)}));case 6:C=e.sent,l.metrics.apm.end("fetch_conversation"),i({type:c.FETCH_CONVERSATION_END,payload:m({currentConversation:R},C)}),i((0,d.updateShouldFetchFeaturedComment)(!0));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()};var r=o(n(37)),s=o(n(33)),i=o(n(38)),l=n(3),u=a(n(997)),d=n(122),c=n(39),f=n(257);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},457:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.parseNotifications=function(e){var t=r.default.map(e,{total_unread:"unreadCount",total_unseen:"unseenCount",total:"totalCount",notifications:{"~":"notifications",id:"id",type:"type",read:"read",updated_at:"updatedAt",conversation_id:"conversationId",conversation_url:"conversationUrl",conversation_title:"conversationTitle",total_count:"totalCount",replier_id:"userId",liker_id:"userId",mentioner_id:"userId",reply:(0,o.getMessageMap)("message"),message:(0,o.getMessageMap)("message"),users:(0,s.getUsersMap)("users")}});return t.notifications=t.notifications||[],t.notifications=t.notifications.map((function(e){return e.messageId=e.message.id,e.message.depth="comment"===e.message.type?0:1,(0,i.linkUsersToNotification)(e.message,e.users),e})),t};var o=n(157),r=a(n(83)),s=n(152),i=n(1016)},458:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getAndResetNotifications=function(){return function(){var e=(0,r.default)(o.default.mark((function e(t){var n,a,r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=22;break}return d=!0,t({type:s.GET_START}),e.prev=3,i.metrics.apm.start("fetch_get_and_reset_notifications"),e.next=7,(0,u.getAndResetNotifications)();case 7:if(n=e.sent,a=n.body,i.metrics.apm.end("fetch_get_and_reset_notifications"),a.notifications.forEach((function(e){e&&e.message&&e.message.content&&(e.message.content=e.message.content.filter((function(e){return"user-mention"!==e.type})))})),r=(0,l.parseNotifications)(a)){e.next=14;break}return e.abrupt("return");case 14:t({type:s.GET_END,payload:{notifications:r.notifications,unreadCount:r.unreadCount,totalCount:r.totalCount}}),d=!1,e.next=22;break;case 18:e.prev=18,e.t0=e.catch(3),d=!1,i.metrics.error("getAndResetNotifications",e.t0);case 22:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(t){return e.apply(this,arguments)}}()};var o=a(n(37)),r=a(n(38)),s=n(94),i=n(3),l=n(457),u=n(181),d=!1},460:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.rankConversation=function(e,t){return function(){var n=(0,r.default)(o.default.mark((function n(a){return o.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:setTimeout((function(){s.default.trigger("focusSayControl")}),0),a({type:i.RANK_CONVERSATION,payload:{starsRating:e,stackId:t}});case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()};var o=a(n(37)),r=a(n(38)),s=a(n(251)),i=n(39)},71:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.TranslatedText=void 0;var o=a(n(6)),r=n(54),s=["textKey","pluralValue","default","override","params","key","ref"];t.TranslatedText=function(e){(0,r.useTranslation)();var t=Object.keys(e).filter((function(e){return-1===s.indexOf(e)})).reduce((function(t,n){return t[n]=e[n],t}),{});return e.override?o.default.createElement("span",t,e.override):o.default.createElement("span",t,o.default.createElement(r.Trans,{i18nKey:e.textKey,values:e.params||(null==e?void 0:e.values),count:e.pluralValue},e.children))}},725:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.CompleteEmailRegistration=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=o(n(18)),c=o(n(46)),f=a(n(6)),p=o(n(56)),m=o(n(728)),g=n(71),v=n(43);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var y=function(e){(0,i.default)(n,e);var t=h(n);function n(){var e;(0,r.default)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).handleSendVerifyEmailKeyUp=function(t){13===t.keyCode&&e.sendVerifyEmail()},e}return(0,s.default)(n,[{key:"sendVerifyEmail",value:function(){var e=this.props,t=e.currentUser,n=e.spotId,a=e.hostUrl,o=t.email,r=a;this.props.onVerifyEmailSend({email:o,spotId:n,url:r})}},{key:"getVerifyEmailComponent",value:function(){return f.default.createElement("div",{onKeyUp:this.handleSendVerifyEmailKeyUp,"data-spmark":"verify-email",className:(0,d.default)(m.default.verifyEmailBar)},f.default.createElement(p.default,{selector:"exclamationCircleSolidIcon",className:m.default.icon}),f.default.createElement(v.Typography,{className:m.default.textWrapper},f.default.createElement(g.TranslatedText,{textKey:"inpage.conversation.completeEmailRegistration.text"}),f.default.createElement(g.TranslatedText,{className:m.default.link,onClick:this.sendVerifyEmail.bind(this),textKey:"inpage.conversation.completeEmailRegistration.button"})))}},{key:"getEmailSentComponent",value:function(e){return f.default.createElement("div",{className:m.default.emailSentBar},f.default.createElement(p.default,{selector:"faCircleCheck",className:m.default.icon}),f.default.createElement(g.TranslatedText,{textKey:"inpage.conversation.completeEmailRegistration.succesMessage.first"}),f.default.createElement("span",null," ".concat(e,". ")),f.default.createElement(g.TranslatedText,{textKey:"inpage.conversation.completeEmailRegistration.succesMessage.second"}))}},{key:"render",value:function(){var e=this.props,t=e.email,n=e.isEmailVerified,a=e.isVerificationEmailSent,o=null;return t&&!n&&(o=a?this.getEmailSentComponent(t):this.getVerifyEmailComponent()),o}}]),n}(f.Component);t.CompleteEmailRegistration=y,y.displayName="CompleteEmailRegistration",y.propTypes={email:c.default.string,isEmailVerified:c.default.bool.isRequired,isVerificationEmailSent:c.default.bool,spotId:c.default.string,onVerifyEmailSend:c.default.func.isRequired,hostUrl:c.default.string},y.defaultProps={isVerificationEmailSent:!1}},729:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.LoadMoreComments=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=o(n(53)),f=o(n(6)),p=o(n(18)),m=o(n(48)),g=n(45),v=o(n(86)),h=n(136),y=n(55),E=n(71),M=a(n(50)),b=o(n(781));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var R=function(e){(0,l.default)(n,e);var t=S(n);function n(){var e;(0,s.default)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).onLoadMore=function(){var t=e.props,n=t.onLoadMore,a=t.isLoading,o=t.tracking;a||(n(),o.trackEvent({type:"load-more-comments-clicked"}),(0,y.dispatchSpotimEvent)(h.CLICKED_SHOW_MORE_COMMENTS_EVENT_NAME))},e.handleLoadMoreKeyUp=function(t){13===t.keyCode&&e.onLoadMore()},e}return(0,i.default)(n,[{key:"render",value:function(){var e=this.props,t=e.isLoading,n=e.hasNext,a=e.loadMoreMessagesText,o=e.textKey,s=e.isLiveBlog;return n?f.default.createElement("div",{className:b.default.loadMoreCommentsContainer},f.default.createElement("div",{"data-spmark":"show-more",className:(0,p.default)(b.default.loadMoreMessages,(0,r.default)({},b.default.loading,t)),onClick:this.onLoadMore,onKeyUp:this.handleLoadMoreKeyUp,"data-spot-im-class":"load-more-messages"},t&&f.default.createElement("div",{className:b.default.spinnerWrapper},f.default.createElement(v.default,{size:"small"})),a?f.default.createElement("span",null,a):s?f.default.createElement(E.TranslatedText,{textKey:"liveBlog.loadMore"},"Load more updates..."):f.default.createElement(E.TranslatedText,{textKey:o},"Show More Comments"))):null}}]),n}(f.default.Component);t.LoadMoreComments=R;var C=(0,c.default)((0,g.connect)((function(e){return{isLiveBlog:M.isLiveBlog(e)}})),(0,m.default)({}))(R);t.default=C},782:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(6)),r=a(n(783)),s=function(e){var t=e.onClick;return o.default.createElement("span",{className:r.default.Disqus},o.default.createElement("span",{className:r.default.mobileText,onClick:t,onTouchStart:t},"Forum?"),o.default.createElement("span",{className:r.default.desktopText,onClick:t,onTouchStart:t},"Have a Forum Account?"))};t.default=s},785:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(33)),s=o(n(37)),i=o(n(38)),l=o(n(35)),u=o(n(36)),d=o(n(98)),c=o(n(40)),f=o(n(41)),p=o(n(42)),m=o(n(53)),g=a(n(6)),v=o(n(18)),h=n(45),y=n(51),E=o(n(48)),M=a(n(96)),b=o(n(786)),S=o(n(796)),R=o(n(402)),C=n(95),T=o(n(168)),w=n(416),I=n(986),O=n(987),k=n(452),_=n(992),N=o(n(453)),x=n(122),D=a(n(50)),P=n(47),U=n(43),L=n(3),A=n(116);function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.default)(e);if(t){var o=(0,p.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,f.default)(this,n)}}var F=function(e){(0,c.default)(o,e);var t,a=B(o);function o(e){var t;return(0,l.default)(this,o),(t=a.call(this,e)).snippets=void 0,t.rootMessageRefs=void 0,t.viewMessage=function(e){t.rootMessageRefs.forEach((function(t){t.current&&t.current.wrappedInstance.viewMessage(e)}))},t.snippets=n(993),t.state={shouldFetchFeaturedComment:!1,hasFeaturedComment:!1,adsHidden:e.isLiveBlog||!1},t.onHideAd=t.onHideAd.bind((0,d.default)(t)),t.rootMessageRefs=[],t}return(0,u.default)(o,[{key:"isStaffUser",value:function(e){return!!e&&(e.isJournalist||e.isAdmin||e.isModerator)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.postId,n=e.tracking,a=L.metrics.apm.end("critical_flow").measure;n.trackEvent({post_id:t,type:"performance-end",item_type:"conversation-displayed",duration:null==a?void 0:a.duration}),this.prepareFeaturedComment()}},{key:"prepareFeaturedComment",value:(t=(0,i.default)(s.default.mark((function e(){var t,n,a,o,r,i,l,u;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.conversationID,a=t.addMessage,o=t.updateMessageToBeFeatured,r=t.messages,i=t.updateShouldFetchFeaturedComment,l=t.sortBy,i(),e.next=4,(0,O.fetchFeaturedCommentData)(n,l);case 4:(u=e.sent)&&(r[u.id]?o(u):a(u),this.setState({hasFeaturedComment:!0}));case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"componentDidUpdate",value:function(){this.props.shouldFetchFeaturedComment&&this.prepareFeaturedComment()}},{key:"onHideAd",value:function(){this.setState({adsHidden:!0})}},{key:"generateV2AdsSeparator",value:function(e){return e?g.default.createElement("div",{className:N.default.separator}):g.default.createElement("div",{className:N.default.adsSeparator},g.default.createElement(U.Typography,{className:N.default.adsSeparatorText,type:"infoMd"},g.default.createElement(P.TranslationWrapper,{i18nKey:"ads.separator"},"The conversation continues below the ad")))}},{key:"render",value:function(){var e,t=this,n=this.props,a=n.className,o=n.stackList,s=n.commentsCount,i=n.showTopActivityBar,l=n.onShowMore,u=n.hasNextComments,d=n.isLiveBlog,c=n.messageSayControls,f=n.isSubmittingEdit,p=n.editedMessageId,m=this.state.adsHidden;this.rootMessageRefs=new Array(Math.max(0,s));var h,E=[];if(i&&(h=g.default.createElement(b.default,{key:"1",viewportObserver:C.viewportObserver})),M.count(o)>0){var T=-1;s>-1&&(T=s);var w=M.getAggregatedStacksSequence(o),I=M.getRootMessages(o);if(i){if(w){var O=w,x=O.length,D=O.filter((function(e){return 0===e.message.depth})).length;h=g.default.createElement(b.default,{key:"2",messagesCount:x,viewportObserver:C.viewportObserver}),T-=D}}else{var P=w,U=P.length,L=P.filter((function(e){return 0===e.message.depth})).length;E.push(g.default.createElement(R.default,{key:P[0].id,messagesCount:U,onClick:l})),T-=L}if(I){var B=(0,_.getAdIndices)({stackLength:I.length}),F=I.filter((function(e){return e.message.status!==y.statuses.REPORTED&&!e.isAggregated&&!e.message.isCollapsed})).filter((function(e){return!(0,A.isEmptyMessage)(e.message)}));F.forEach((function(e,n){var a,s,i=e.message.user;n>0&&(s=I[n-1]);var l=(0,v.default)((0,r.default)({},N.default.topMessage,0===n));t.rootMessageRefs[n]=g.default.createRef();var h=n===F.length-1,y=e.message.id,b=c[y],R=!!(null==b?void 0:b.isEdit)||f&&p===y,C=g.default.createElement(S.default,{ref:t.rootMessageRefs[n],root:e,children:M.traverse(o,e),messageIndex:T,className:l,isStaffParent:t.isStaffUser(i),isStaffUser:t.isStaffUser,previousRoot:s,isTheFirstMessage:0===n,isLastMessage:h}),w=!m&&(null==B?void 0:B.some((function(e,t){return e-t-1===E.length}))),O=!m&&!u&&E.length<=B[B.length-1]&&h,_=O||w&&k.isConvAdsStyleV2,x=(0,v.default)(N.default.listItem,(a={},(0,r.default)(a,N.default.isLastMessage,h&&!w),(0,r.default)(a,N.default.isEdit,R),(0,r.default)(a,N.default.isLiveBlog,d),(0,r.default)(a,N.default.hideSeparator,_||d),a));E.push(g.default.createElement("li",{key:"message-stack-".concat(e.id),className:x,"aria-label":"Comment"},g.default.createElement("div",{className:N.default.safariPadder}),C,_&&t.generateV2AdsSeparator(O)))})),m||d||B.forEach((function(e){E.splice(e,0,g.default.createElement(k.NativeAdUnit,{key:e,index:e,onHideAd:t.onHideAd}))}))}}return g.default.createElement("ul",{className:(0,v.default)([N.default.messagesList,a,(e={},(0,r.default)(e,N.default.theEarliestMessages,!u),(0,r.default)(e,N.default.isLiveBlog,d),e)]),"data-spot-im-class":"messages-list",role:"feed","aria-label":"List of Comments"},h,E)}}]),o}(g.Component);F.defaultProps={commentsCount:-1,showTopActivityBar:!0,onShowMore:function(){}};var j=(0,m.default)((0,h.connect)((function(e){return{postId:e.conversation.postId,conversationID:e.conversation.id,messages:e.comments.list.messages,shouldFetchFeaturedComment:e.conversation.shouldFetchFeaturedComment,sortBy:e.comments.pagination.sortBy,isMobile:e.isMobile.isMobile,isLiveBlog:D.isLiveBlog(e),messageSayControls:e.messageSayControls,isSubmittingEdit:e.conversation.isSubmittingEdit,editedMessageId:e.conversation.editedMessageId}}),(function(e){return{onShowMore:T.default,addMessage:function(t){return e((0,w.addMessage)(t))},updateMessageToBeFeatured:function(t){return e((0,I.updateMessageToBeFeatured)(t))},updateShouldFetchFeaturedComment:function(){return e((0,x.updateShouldFetchFeaturedComment)(!1))}}}),null,{forwardRef:!0}),(0,E.default)({},{forwardRef:!0}))(F);t.default=j},786:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TopActivityBar=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=a(n(6)),f=o(n(46)),p=o(n(18)),m=n(45),g=n(246),v=o(n(402)),h=o(n(168)),y=n(95),E=n(112),M=n(403),b=o(n(795));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var R=function(e){(0,l.default)(n,e);var t=S(n);function n(){return(0,s.default)(this,n),t.apply(this,arguments)}return(0,i.default)(n,[{key:"render",value:function(){var e,t=this.props,n=t.typingUsers,a=t.messagesCount,o=t.onShowMore,s=t.typingUsersCount,i=t.spotId,l=t.isLiveBlog,u=(0,p.default)(b.default.topActivityBar,(e={},(0,r.default)(e,b.default.hasTyping,s>0),(0,r.default)(e,b.default.hasShowNew,a>0),e));return c.default.createElement(g.ViewportGuard,{viewportObserver:y.viewportObserver,tagName:"li",useViewportObserver:!0,className:b.default.blitzItem},s>0||a>0?c.default.createElement("div",{className:u},c.default.createElement("div",{className:b.default.messageSection},c.default.createElement(M.ConversationTyping,{users:n,typingUsersCount:s,size:39,spotId:i})),a>0&&c.default.createElement(v.default,{messagesCount:a,onClick:o,isLiveBlog:l})):c.default.createElement("div",null))}}]),n}(c.Component);t.TopActivityBar=R,R.propTypes={currentUserId:f.default.string.isRequired,typingUsers:f.default.array.isRequired,messagesCount:f.default.number,onShowMore:f.default.func,spotId:f.default.string,isLiveBlog:f.default.bool},R.defaultProps={messagesCount:0,onShowMore:function(){},isLiveBlog:!1};var C=(0,m.connect)((function(e){return{spotId:e.moduleOptions.spotId,currentUserId:e.currentUser.id,typingUsers:(0,E.getTypingStateOfUsers)(e),typingUsersCount:(0,E.getTypingsCount)(e),isLiveBlog:e.moduleOptions.isConversationLiveBlog}}),{onShowMore:h.default})(R);t.default=C},787:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.ElementObserver=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=o(n(46)),c=a(n(6)),f=n(4);function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var m=function(e){(0,i.default)(n,e);var t=p(n);function n(e){var a;return(0,r.default)(this,n),(a=t.call(this,e)).observedElement=void 0,a}return(0,s.default)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.viewportObserver,n=e.onViewportChange;this.observedElement=(0,f.findDOMNode)(this),t.observe(this.observedElement,{stateChangeHandler:n})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.viewportObserver,a=t.children,o=t.onViewportChange;a!==e.children&&(this.observedElement&&n.unobserve(this.observedElement),this.observedElement=(0,f.findDOMNode)(this),n.observe(this.observedElement,{stateChangeHandler:o}))}},{key:"componentWillUnmount",value:function(){var e=this.props.viewportObserver;this.observedElement&&e.unobserve(this.observedElement)}},{key:"render",value:function(){return this.props.children}}]),n}(c.Component);t.ElementObserver=m,m.displayName="ElementObserver",m.propTypes={viewportObserver:d.default.object.isRequired,onViewportChange:d.default.func},m.defaultProps={onViewportChange:function(){}}},790:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.TypingAnimation=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=o(n(46)),f=a(n(6)),p=o(n(18)),m=o(n(791));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var v=function(e){(0,l.default)(n,e);var t=g(n);function n(){return(0,s.default)(this,n),t.apply(this,arguments)}return(0,i.default)(n,[{key:"render",value:function(){var e,t=(0,p.default)(m.default.typingAnimation,(e={},(0,r.default)(e,m.default.small,this.props.isSmall),(0,r.default)(e,m.default.transparent,this.props.transparent),e));return f.default.createElement("span",{className:t},f.default.createElement("span",null),f.default.createElement("span",null),f.default.createElement("span",null))}}]),n}(f.Component);t.TypingAnimation=v,v.displayName="TypingAnimation",v.propTypes={isSmall:c.default.bool},v.defaultProps={isSmall:!1}},796:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=a(n(6)),f=n(45),p=o(n(18)),m=a(n(89)),g=a(n(96)),v=a(n(50)),h=o(n(405)),y=o(n(438)),E=o(n(451)),M=n(44);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var C=function(e){(0,l.default)(a,e);var t=R(a);function a(e){var o;return(0,s.default)(this,a),(o=t.call(this,e)).childrenRefs=[],o.messageStackRef=c.default.createRef(),o.snippets=void 0,o.viewMessage=function(e){o.messageStackRef.current&&(o.messageStackRef.current.wrappedInstance.viewMessage(e),o.childrenRefs.forEach((function(t){t.current.wrappedInstance.viewMessage(e)})))},o.snippets=n(985),o}return(0,i.default)(a,[{key:"createDateAriaLableText",value:function(e,t){var n=new Date(1e3*t),a=["January","February","March","April","May","June","July","August","September","October","November","December"][n.getMonth()],o=n.getDate();return"".concat(e," commented ").concat(a," ").concat(o)}},{key:"render",value:function(){var e,t=this,n=this.props,a=n.root,o=n.children,s=n.messageIndex,i=n.showReplySayControl,l=n.useExpandButton,u=n.repliesMaxDepth,d=(n.isStaffParent,n.isStaffUser),f=n.isTheFirstMessage,g=n.shouldCollapseReplies,v=n.isEdit,b=n.isLiveBlog,R=a.message.user,C=this.snippets.handleTOLSpacing(this.props),T=C.isAdjacentStaffReply,w=C.isPreviousShowMoreReplies,I=C.isPreviousStaffComment,O=d(R),k=this.snippets.getClassNames(S(S({},this.props),{},{isAdjacentStaffReply:T,isPreviousShowMoreReplies:w,isPreviousStaffComment:I,isStaff:O,isTheFirstMessage:f,isEdit:v,isLiveBlog:b})),_=(0,p.default)(k,(e={},(0,r.default)(e,E.default.isLiveBlogNoUserImage,M.disableUserAvatar&&b),(0,r.default)(e,E.default.isLastMessageNoUserImage,M.disableUserAvatar&&this.props.isLastMessage),e)),N=(0,p.default)(E.default.childrenList,(0,r.default)({},E.default.empty,0===o.length)),x=m.getMessage(a),D=this.createDateAriaLableText(R.username,a.message.postedAt);return this.childrenRefs=[],c.default.createElement("article",{className:_},c.default.createElement(h.default,{ref:this.messageStackRef,isTheFirstMessage:f,stack:a,messageIndex:s,"aria-labelledby":"comment-description-".concat(s),"aria-describedby":"comment-content-".concat(s),isLastMessageInThread:a.message.id===this.props.lastMessageId}),c.default.createElement("a",{className:E.default.accessibilityLabel,id:"comment-description-".concat(s),"aria-label":D}),c.default.createElement("ul",{className:N},o.map((function(e,n){var a=e.message.user,o="message-stack-".concat(e.id);return e.message.isNew&&(g&&(e.isLastMessage=!1)),t.snippets.renderChildrenStack(S({key:o,messageUser:a,index:n,stack:e,isAdjacentStaffReply:T,isLastMessageInThread:e.message.id===t.props.lastMessageId},t.props))}))),i&&c.default.createElement(y.default,{autoFocus:!l,useExpandButton:l,stackId:a.id,className:E.default["depth-".concat(Math.min(x.depth,u-1))],rootMessageId:x.rootMessageId||x.id,replyToStackId:a.id,replyToMessage:x,parentMessageId:x.id,userImageSize:"normal",depth:x.depth+1}))}}]),a}(c.Component);C.defaultProps={children:[],showReplySayControl:!1,useExpandButton:!1,repliesMaxDepth:2,shouldCollapseReplies:!1};var T=(0,f.connect)((function(e,t){var n=e.messageSayControls,a=e.moduleOptions,o=e.comments,r=e.conversation,s=r.isSubmittingEdit,i=r.editedMessageId,l=t.root,u=a.repliesMaxDepth,d=a.pageSize,c=a.spotId,f=a.testOption,p=a.shouldCollapseReplies,m=l.message.id,h=n[m],y=!!(null==h?void 0:h.isEdit)||s&&i===m,E=!(h&&h.isCreate),M=e.ui.optimizedMessageStack,b=v.isLiveBlog(e),S=g.getLastMessageStack(o.list,l);return{spotId:c,showReplySayControl:!1,useExpandButton:E,repliesMaxDepth:u,pageSize:d,optimizedMessageStack:M,testOption:f,shouldCollapseReplies:p,lastMessageId:S?S.message.id:m,stackList:o.list,isEdit:y,isLiveBlog:b}}),null,null,{forwardRef:!0})(C);t.default=T},797:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ConversationMessage=void 0;var r=o(n(70)),s=o(n(33)),i=o(n(35)),l=o(n(36)),u=o(n(40)),d=o(n(41)),c=o(n(42)),f=o(n(53)),p=a(n(6)),m=n(45),g=o(n(18)),v=n(48),h=o(n(798)),y=n(433),E=n(426),M=n(434),b=n(942),S=n(943),R=n(435),C=n(80),T=n(107),w=a(n(50)),I=n(63),O=n(122),k=n(944),_=o(n(946)),N=n(427),x=n(947),D=n(52),P=n(54),U=n(250),L=o(n(436)),A=n(55),B=o(n(437));function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var o=(0,c.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}var K=function(e){(0,u.default)(n,e);var t=V(n);function n(){var e;(0,i.default)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).messageRef=p.default.createRef(),e.viewMessage=function(t){t===e.props.message.id&&e.messageRef.current&&e.messageRef.current.viewMessage()},e}return(0,l.default)(n,[{key:"componentDidMount",value:function(){var e=this.props.conversationId;this.props.disableMessageSayCtrlFocusOnMount||this.props.message.id!==this.props.highlightedReplyId&&this.props.message.id!==this.props.highlightedCommentId||(this.props.onReply(),this.props.tracking.trackEvent({type:"editor-reply-focus",ugc_post_id:e}))}},{key:"enableShowText",value:function(){var e=this.props,t=e.isLiveBlog,n=e.enableSeeMoreButton,a=e.isRootMessage;return t&&a?!!(0,D.isTablet)()||(!(0,D.isMobile)()||!n):!n}},{key:"render",value:function(){var e=this.props,t=e.message,n=e.conversationLongerComments,a=e.currentUser,o=e.isConnectEnabled,i=e.isMobileDevice,l=e.isLiveBlog,u=e.repliesMaxDepth,d=e.isTheFirstMessage,c=e.shouldLimitFirstMessageLength,f=e.maxCharsCountDesktop,m=e.maxCharsCountMobile,v=e.maxLinesCount,y=e.shouldLimitMessageLength,E=e.enableNewMessageSticky,M=e.enableRealtimeCommentsSticky,b=e.dispatch,S=e.enableSSO,R=n?750:void 0,C=8;d&&c&&(R=i?m:f,C=v),y&&(R=i?m:f,C=v);var T={maxChars:R,maxLines:C,shortenText:!0,showUserImageButton:o&&!S,showLoadFrameEntityButton:!1,depth:Math.min(t.depth,u),message:JSON.parse(JSON.stringify(t)),currentUser:JSON.parse(JSON.stringify(a)),showFullText:this.enableShowText(),isTheFirstMessage:d,placeholderTextKey:"richEditor.placeholder.replyTo",enableNewMessageSticky:E,enableRealtimeCommentsSticky:M,dispatch:b},w=(0,g.default)(_.default.conversationMessage,(0,s.default)({},_.default.padded,l));return p.default.createElement(h.default,(0,r.default)({ref:this.messageRef,className:w},this.props,T))}}]),n}(p.Component);t.ConversationMessage=K;var W=(0,f.default)((0,m.connect)((function(e,t){var n,a=e.moduleOptions,o=e.currentUser,r=e.profileHover,s=e.comments,i=a.direction,l=a.isConnectEnabled,u=a.allowFrameEntityLoad,d=a.repliesMaxDepth,c=a.conversationLongerComments,f=a.enableSSO,p=a.conversationImageAnchorsDisabled,m=a.spotId,g=a.postId,v=a.conversationId,h=a.enableNewMessageSticky,y=a.enableSeeMoreButton,E=a.textsOverrides,M=E.communityModeratorBadgeText,b=E.moderatorBadgeText,S=E.reporterBadgeText,R=E.adminBadgeText,C=E.journalistBadgeText,T=a.isMobile,I=a.enableHighlightMessageSticky,O=a.shouldLimitFirstMessageLength,k=a.maxCharsCountDesktop,_=a.maxCharsCountMobile,N=a.maxLinesCount,x=a.shouldLimitMessageLength,D=a.highlightedReplyId,P=a.highlightedCommentId,U=a.enableRealtimeCommentsSticky,L=a.enableSegmentedCategory,A=a.disableProfileHover,B=a.spotName,F=t.message,j=F.id===F.rootMessageId,V=w.isLiveBlog(e),K=!V,W=o.isAdmin||o.isCommunityModerator||o.isModerator||o.isSuperAdmin,H=(null==s||null===(n=s.failedMessageTemp)||void 0===n?void 0:n.message.id)===(null==F?void 0:F.id),q=null==s?void 0:s.failedMessageTemp;return{direction:i,isConnectEnabled:l,allowFrameEntityLoad:u,repliesMaxDepth:d,currentUser:o,conversationLongerComments:c,enableSSO:f,spotId:m,postId:g,conversationId:v,noImageAnchors:p,communityModeratorBadgeText:M,moderatorBadgeText:b,reporterBadgeText:S,adminBadgeText:R,journalistBadgeText:C,enableCategoryModeration:L,profileHoverUser:r.user,enableNewMessageSticky:h,isMobileDevice:w.isMobile(e)||T,enableSeeMoreButton:y,enableHighlightMessageSticky:I,isLiveBlog:V,enableReplies:K,shouldLimitFirstMessageLength:O,maxCharsCountDesktop:k,maxCharsCountMobile:_,maxLinesCount:N,shouldLimitMessageLength:x,highlightedReplyId:D,highlightedCommentId:P,isRootMessage:j,userToken:e.authentication.token,href:a.href,referTraffic:a.referTraffic,enableRealtimeCommentsSticky:U,isStaffMember:W,isFailedMessage:H,failedMessageTemp:q,disableProfileHover:A,disableMessageSayCtrlFocusOnMount:a.isSayControlExpanded,spotName:B}}),(function(e,t){var n=t.message;return{onLoadFrameButtonClick:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];A.dispatchSpotimEvent.apply(void 0,["spot-im-frame-entity-load"].concat(t))},onReply:function(){e((0,E.openMessageSayControl)({messageId:n.id}))},onMessageUnmark:function(){e((0,S.unmarkMessage)({id:n.id}))},onDelete:function(){e((0,y.deleteMessage)({message:n}))},onEdit:function(t){var a=n.id,o=n.starsRating;"string"==typeof t&&(a=t),e((0,M.openEditSayControl)({messageId:a,starsRating:o}))},onReport:function(t){return e((0,b.reportMessage)({message:n}))},onUserWhiteList:function(t){e((0,L.default)(t,n))},loadVotedUsers:function(t){var n=t.messageDepth,a=t.messageId,o=t.offset,r=void 0===o?0:o,s=t.count,i=void 0===s?10:s;e((0,N.getUpvotes)({messageDepth:n,messageId:a,offset:r,count:i}))},onOpenUserProfileModal:function(t){e((0,T.openUserProfileModal)(t))},onVotesSummaryTooltipHide:function(){e((0,x.resetUpVotes)())},onLogin:function(){e((0,C.openLoginSelectorModal)())},highlightMessage:function(){(0,B.default)((function(){e((0,R.scrollToMessage)(n.id))}))},pinFeaturedComment:function(t){e((0,O.pinFeaturedComment)(t))},muteUser:function(t){e((0,k.muteUser)(t))},dispatch:e}}),(function(e,t,n){var a=t.dispatch,o=(t.highlightMessage,e.currentUser),r=e.enableCategoryModeration;n.t;return j(j(j(j({},e),t),n),{},{onContextMenuShow:function(e){var t=o.isAdmin,n=o.isModerator,s=e.user.id===o.id;(t||n)&&e.user.isRegistered&&!s&&a((0,U.getUserModerationStatus)(e)),r&&a((0,I.getModerationTickets)())},onImageUpload:function(e){a((0,I.profileImageUpload)({rawImage:e}))}})}),{forwardRef:!0}),(0,P.withTranslation)(void 0,{withRef:!0}),(0,v.track)({},{forwardRef:!0}))(K);t.default=W},798:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(33)),s=o(n(37)),i=o(n(38)),l=o(n(35)),u=o(n(36)),d=o(n(40)),c=o(n(41)),f=o(n(42)),p=o(n(1)),m=n(799),g=n(51),v=o(n(18)),h=a(n(6)),y=o(n(810)),E=o(n(897)),M=o(n(899)),b=n(901),S=n(176),R=n(39),C=n(78),T=o(n(902)),w=o(n(903)),I=o(n(905)),O=o(n(907)),k=o(n(928)),_=o(n(936)),N=o(n(937)),x=o(n(939)),D=o(n(48)),P=n(59),U=n(55),L=n(101),A=o(n(93));function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,f.default)(e);if(t){var o=(0,f.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}var V=(0,h.lazy)((function(){return Promise.all([n.e(0),n.e(18),n.e(25),n.e(54)]).then(n.t.bind(null,1107,7))})),K=(0,h.lazy)((function(){return Promise.all([n.e(0),n.e(25),n.e(26),n.e(89)]).then(n.t.bind(null,1113,7))})),W=(0,h.lazy)((function(){return Promise.all([n.e(0),n.e(22)]).then(n.t.bind(null,462,7))})),H=function(e){(0,d.default)(n,e);var t=j(n);function n(){var e;(0,l.default)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).messageRef=h.default.createRef(),e.messageDetailsRef=h.default.createRef(),e.messageEntitiesRef=h.default.createRef(),e.deletedMessageRef=h.default.createRef(),e.appearanceInnerRef=h.default.createRef(),e.messageMarkerRef=h.default.createRef(),e.state={collapsed:!1,showFeaturedCommentModal:!1,showMuteUserModal:!1,showDeletedMessageModal:!1,showReportMessageModal:!1},e.handleEdit=function(){e.props.onEdit(e.props.message.id)},e.onDelete=(0,i.default)(s.default.mark((function t(){return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.deleteAction();case 1:case"end":return t.stop()}}),t)}))),e.deleteAction=function(){e.props.onDelete()},e.hasContextMenu=function(e){return!0===e.isAdmin||!0===e.isModerator||!0===e.isJournalist||!0===e.isSuperAdmin||!0===e.isCommunityModerator},e.isMyMessage=function(e,t){return t.user.id===e.id},e.handleMessageReplyGotFocus=function(){},e.openFeaturedCommentModal=function(){e.setState({showFeaturedCommentModal:!0})},e.openMuteUserModal=function(){e.setState({showMuteUserModal:!0})},e.closeMuteUserModal=function(t){e.setState({showMuteUserModal:!1});var n={type:"user-prompt-message-clicked",item_type:"mute-user-prompt-message",target_type:t?"mute":"cancel",post_id:e.props.postId};e.props.tracking.trackEvent(n)},e.muteUserHovered=function(){var t={type:"user-prompt-message-viewed",item_type:"mute-user-prompt-message",target_type:"mute",post_id:e.props.postId};e.props.tracking.trackEvent(t)},e.closeFeaturedCommentModal=function(t){var n=e.props,a=n.pinFeaturedComment,o=n.message;"top-featured"===t&&a(o),e.setState({showFeaturedCommentModal:!1})},e.closeDeletedMessageModal=function(t){t&&e.onDelete(),e.setState({showDeletedMessageModal:!1})},e.handleCloseReportMessageModal=function(){var t=(0,i.default)(s.default.mark((function t(n){var a,o,r,i,l,u;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.props,o=a.message,r=a.tracking,"ok"!==n){t.next=4;break}return t.next=4,e.onReport();case 4:i=o.featuredComment?"featured-comment":"main",l=function(){if(o.featuredComment)return"top"===e.props.featuredComment?"top-featured-comment":"in-conversation-featured"}(),u={type:"report-message-clicked",target_type:i,segment:l,message_id:o.id,post_id:e.props.postId},r.trackEvent(u),e.setState({showReportMessageModal:!1});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleReport=function(){e.setState({showReportMessageModal:!0})},e.onDeletedMessageModalOpen=function(){e.setState({showDeletedMessageModal:!0})},e.viewMessage=function(){e.appearanceInnerRef.current&&e.appearanceInnerRef.current.scrollIntoView({behavior:"smooth"})},e.sendFailedMessage=function(){var t=e.props,n=t.failedMessageTemp,a=t.dispatch;n.message&&a((0,S.createMessage)(F(F({},n.message),{},{isRetry:!0})))},e}return(0,u.default)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.enableNewMessageSticky,n=e.message,a=e.currentUser,o=e.enableHighlightMessageSticky,r=e.enableRealtimeCommentsSticky,s=e.dispatch;n.isNew&&t&&r&&o&&!(0,C.isSameUser)(n.user,a)&&(0,b.isMessageInDocument)(n.id)&&!(0,b.isMessageInViewport)(n.id)&&!n.featured&&s({type:R.SHOW_NEW_MESSAGE_TOAST,payload:{message:n}})}},{key:"getDetailsHeight",value:function(){return(this.props.message.isDeleted?this.deletedMessageRef:this.messageDetailsRef).current.offsetHeight}},{key:"getEntitiesOriginalHeight",value:function(){var e,t;return this.props.message.isDeleted?0:null===(e=this.messageEntitiesRef)||void 0===e||null===(t=e.current)||void 0===t?void 0:t.offsetHeight}},{key:"setMessageEntitiesHeight",value:function(e){var t=this.props.message.isDeleted,n=this.messageEntitiesRef.current;!t&&n&&(n.style.height=e)}},{key:"onReport",value:function(){var e=this.props,t=e.onReport,n=e.message;return(0,U.dispatchSpotimEvent)(P.CLICKED_FLAG,n),t({message:n},!0)}},{key:"isPendingOrBlocked",value:function(e){return e.status===(g.statuses.PENDING&&!e.isPublished)||e.status===g.statuses.BLOCKED}},{key:"isHidden",value:function(e){return this.isPendingOrBlocked(e)}},{key:"render",value:function(){var e,t=this.props,n=t.className,a=t.message,o=t.currentUser,s=t.userImageSize,i=t.messageIndex,l=t.enterAnimationDisabled,u=t.noAnchors,d=t.depth,c=t.enableVotesMessageAction,f=t.onImageUpload,b=t.showFullText,S=t.reporterBadgeText,R=t.adminBadgeText,C=t.journalistBadgeText,D=t.moderatorBadgeText,P=t.communityModeratorBadgeText,U=t.featuredComment,B=t.userToken,j=t.muteUser,H=t.isStaffMember,q=t.isFailedMessage,G=t.disableProfileHover,z=t.spotName,Q=this.state.showMuteUserModal,Y=p.default.get("tenant_config.conversation.enableUsersMuting",!1)&&a.user.isMuted,J=this.isMyMessage(o,a),Z=this.state,X=Z.showFeaturedCommentModal,$=Z.showDeletedMessageModal,ee=Z.showReportMessageModal,te=(q||a.status===g.statuses.BLOCKED||a.status===g.statuses.PENDING)&&(J||H)&&!a.isDeleted&&!Y&&!a.isPublished||a.messageModeratingStage,ne=o&&o.id===a.user.id?F(F({},o),{},{points:a.user.points}):a.user;n=(0,v.default)(T.default.messageView,T.default["depth-".concat(d)],(e={},(0,r.default)(e,T.default.messageWithStatus,te),(0,r.default)(e,T.default.temporary,a.isTempId),e),n);var ae,oe,re=(0,v.default)((0,r.default)({},T.default.collapsed,this.state.collapsed)),se=null;if(a.starsRating&&(se=h.default.createElement(h.Suspense,{fallback:null},h.default.createElement(W,{starsRating:a.starsRating,disabled:!0,descriptionKey:null,editing:!1,inSayControl:!0}))),!q&&this.props.hasMenu){var ie=this.isHidden(a);ae=h.default.createElement(h.Suspense,{fallback:null},h.default.createElement(V,{onShow:this.props.onContextMenuShow,message:a,onEdit:this.handleEdit,onReport:this.handleReport,isHidden:ie,featuredComment:U,openFeaturedCommentModal:this.openFeaturedCommentModal,openMuteUserModal:this.openMuteUserModal,onDeletedMessageModalOpen:this.onDeletedMessageModalOpen}))}if(te||a.status!==g.statuses.BLOCKED)if(te||!a.isDeleted&&!Y){var le=te;oe=h.default.createElement("div",{className:T.default.messageContainer},h.default.createElement(L.Row,{alignItems:"center",className:T.default.messageDataWrapper},h.default.createElement(A.default,{user:ne,className:T.default.messageUserImage,size:L.USER_IMAGE_SIZE.NORMAL,disableTooltip:G,onImageUpload:f,isDisabled:le}),h.default.createElement(k.default,{innerRef:this.messageDetailsRef,adminBadgeText:R,journalistBadgeText:C,communityModeratorBadgeText:P,message:a,isDisabled:le,user:ne,userImageSize:s,messageIndex:i,onImageUpload:f,profileHoverUser:ne,messageContextMenu:ae,featuredComment:U,messageStatus:a.status,enableProfileHover:!G})),se,h.default.createElement(_.default,{innerRef:this.messageEntitiesRef,message:a,noAnchors:u,shortenText:this.props.shortenText,maxChars:this.props.maxChars,depth:d,isDisabled:le,maxLines:this.props.maxLines,showFullText:b}),h.default.createElement(O.default,{depth:d,currentUser:o,isDisabled:le,message:a,spotName:z,enableVotes:c,messageReplyGotFocus:this.handleMessageReplyGotFocus}))}else oe=h.default.createElement("div",{className:T.default.messageContainer},h.default.createElement(I.default,{isReported:a.isReported,isDeleted:a.isDeleted,isMuted:Y,innerRef:this.deletedMessageRef,adminBadgeText:R,journalistBadgeText:C,message:a,userImageSize:L.USER_IMAGE_SIZE.NORMAL,messageIndex:i}));else oe=h.default.createElement("div",{className:T.default.messageContainer},h.default.createElement(x.default,{moderatorBadgeText:D,reporterBadgeText:S,adminBadgeText:R,journalistBadgeText:C,message:a,userImageSize:L.USER_IMAGE_SIZE.NORMAL,messageIndex:i}));var ue=null;0===d&&(ue=h.default.createElement("div",{"data-ad-placeholder":"ad-placeholder-".concat(a.id)}));var de=null,ce=(0,v.default)(n,(0,r.default)({},T.default.isMessageStatus,!!de));return te&&(de=h.default.createElement(h.Suspense,{fallback:null},h.default.createElement("div",{className:(0,v.default)(T.default.messageStatusClickable,ce)},h.default.createElement(K,{message:a,isFailedMessage:q,onRetry:this.sendFailedMessage,isModerated:H,showMessageStatus:te,messageModeratingStage:a.messageModeratingStage})))),h.default.createElement(w.default,{animate:"top"===a.featuredComment},h.default.createElement(m.Appearance,{mobileEnabled:!1,enterAnimationDisabled:l,innerRef:this.appearanceInnerRef,className:re,depth:d,user:ne},de,ue,h.default.createElement("div",{ref:this.messageRef,className:n,"data-message-id":a.id,"data-message-depth":d,"data-spot-im-class":"message-view"},oe)),h.default.createElement(E.default,{message:a,showFeaturedCommentModal:X,onClose:this.closeFeaturedCommentModal,ConfigProvider:p.default,userToken:B}),h.default.createElement(N.default,{muteUserHovered:this.muteUserHovered,showMuteUserModal:Q,onClose:this.closeMuteUserModal,muteUser:j,message:a}),h.default.createElement(y.default,{onClose:this.closeDeletedMessageModal,showModal:$,message:a,currentUser:o}),h.default.createElement(M.default,{showModal:ee,onClose:this.handleCloseReportMessageModal}))}}]),n}(h.Component);H.displayName="Message",H.defaultProps={className:"",hasMenu:!0,maxChars:null,userImageSize:"medium",maxLines:null,enterAnimationDisabled:!1,shortenText:!1,messageIndex:-1,enableNewMessageSticky:!0,featuredComment:null,isStaffMember:!1,tracking:function(){},dispatch:function(){},onMessageUnmark:function(){},onDelete:function(){},onImageUpload:function(){},onEdit:function(){},onReport:function(){},onContextMenuShow:function(){},pinFeaturedComment:function(){}};var q=(0,D.default)({},{forwardRef:!0})(H);t.default=q},799:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.Appearance=void 0;var r=o(n(33)),s=o(n(37)),i=o(n(38)),l=o(n(35)),u=o(n(36)),d=o(n(40)),c=o(n(41)),f=o(n(42)),p=o(n(46)),m=a(n(6)),g=o(n(18)),v=n(4),h=n(52),y=o(n(800)),E=n(406),M=n(401);function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,f.default)(e);if(t){var o=(0,f.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}var S=function(e){e&&"function"==typeof e&&e()},R=function(e){(0,d.default)(o,e);var t,n,a=b(o);function o(){return(0,l.default)(this,o),a.apply(this,arguments)}return(0,u.default)(o,[{key:"enter",value:(n=(0,i.default)(s.default.mark((function e(t){var n,a;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(h.isMobile&&!this.props.mobileEnabled||this.props.enterAnimationDisabled)){e.next=3;break}return S(t),e.abrupt("return");case 3:return n=(0,v.findDOMNode)(this),a="".concat((0,M.outerHeight)(n),"px"),n.style.opacity=0,n.style.height=0,e.next=9,(0,E.animate)(n,{opacity:1,height:a},{duration:432,easing:"cubic-bezier(0.86,0,0.07,1)"});case 9:n.style.opacity="",n.style.height="",S(t);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"leave",value:(t=(0,i.default)(s.default.mark((function e(t){var n,a;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h.isMobile||this.props.mobileEnabled){e.next=3;break}return S(t),e.abrupt("return");case 3:return n=(0,v.findDOMNode)(this),a=(0,M.outerHeight)(n),n.style.opacity=1,n.style.height=a,e.next=9,(0,E.animate)(n,{opacity:0,height:"0px"},{duration:432,easing:"cubic-bezier(0.86, 0, 0.07, 1)"});case 9:n.style.opacity="",n.style.height="",S(t);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"render",value:function(){var e,t=this.props,n=t.innerRef,a=t.depth,o=(0,g.default)(y.default.appearanceComponent,(e={},(0,r.default)(e,y.default.isReply,a>0),(0,r.default)(e,y.default.isHighlighted,this.props.user.isJournalist||this.props.user.isAdmin||this.props.user.isModerator),e),this.props.className);return m.default.createElement("div",{ref:n,className:o},this.props.children)}}]),o}(m.Component);t.Appearance=R,R.displayName="Appearance",R.propTypes={children:p.default.any,className:p.default.string,mobileEnabled:p.default.bool,enterAnimationDisabled:p.default.bool,user:p.default.object,depth:p.default.number,innerRef:p.default.object.isRequired},R.defaultProps={mobileEnabled:!0,enterAnimationDisabled:!1,className:void 0}},810:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n;0===e.message.depth?(t=r.default.t("message.contextMenu.delete.confirmation.titleComment"),n=e.currentUser.isModerator&&e.message.repliesCount>0?r.default.t("message.contextMenu.delete.confirmation.relatedReplies",{params:{repliesCount:"props.message.repliesCount"}}):r.default.t("message.contextMenu.delete.confirmation.comment")):(t=r.default.t("message.contextMenu.delete.confirmation.titleReply"),n=r.default.t("message.contextMenu.delete.confirmation.reply"));return o.default.createElement(s.Modal,{disableCustomBodyScroll:l.disableModalDefaultScroll,shadowRootCssModules:i.isUseShadowDomOnOverlays?["conversation"]:void 0,isLtr:l.isLtr,fullScreenMobile:!1,showModal:e.showModal,onClose:function(){return e.onClose()},size:"md",bottomActions:o.default.createElement(s.Gutter,null,o.default.createElement(s.Button,{mode:"secondary",onClick:function(){return e.onClose()},id:"spotim-delete-message-cancel"},r.default.t("message.contextMenu.delete.confirmation.cancelButton")),o.default.createElement(s.Button,{mode:"primary",onClick:function(){e.onClose(!0)},id:"spotim-delete-message-ok"},r.default.t("message.contextMenu.delete.confirmation.okButton"))),modalTitle:t},n)};var o=a(n(6)),r=a(n(146)),s=n(43),i=n(79),l=n(44)},897:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(37)),s=o(n(38)),i=o(n(49)),l=a(n(6)),u=o(n(46)),d=n(43),c=o(n(898)),f=n(79),p=n(44),m=o(n(73));function g(e){var t=(0,l.useState)(!1),n=(0,i.default)(t,2),a=n[0],o=n[1],u=e.message,g=u.id,v=u.conversationId,h=function(){var t=(0,s.default)(r.default.mark((function t(n){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o(!0),t.next=3,(0,m.default)("moderation/conversation/".concat(v,"/message/").concat(g,"/feature"),{data:{should_top_feature:n},method:"POST"});case 3:o(!1),n?e.onClose("top-featured"):e.onClose("leave-tagged");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return l.default.createElement(d.Modal,{disableCustomBodyScroll:p.disableModalDefaultScroll,shadowRootCssModules:f.isUseShadowDomOnOverlays?["conversation"]:void 0,isLtr:p.isLtr,closeButton:!0,showModal:e.showFeaturedCommentModal,onClose:function(){return e.onClose("closed")},modalTitle:"Pin Featured Comment",className:c.default.featureCommentModal,size:"md",bottomActions:l.default.createElement(d.Gutter,null,l.default.createElement(d.Button,{mode:"secondary",disabled:a,onClick:function(){return h(!1)}},"No"),l.default.createElement(d.Button,{mode:"primary",disabled:a,onClick:function(){return h(!0)}},"Yes"))},l.default.createElement("div",{className:c.default.text},"Would you like to pin this featured comment at the top of the conversation?"),l.default.createElement("div",{className:c.default.imageWrapper},l.default.createElement("img",{className:c.default.image,src:"http://publisher-assets.spot.im/featured-comment/set-post-as-featured.svg"})))}g.propTypes={message:u.default.object,showFeaturedCommentModal:u.default.bool,onClose:u.default.func};var v=g;t.default=v},899:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,l.useTranslation)().t,n=(0,s.useState)(!1),a=(0,r.default)(n,2),o=a[0],p=a[1];return s.default.createElement(i.Modal,{disableCustomBodyScroll:f.disableModalDefaultScroll,shadowRootCssModules:c.isUseShadowDomOnOverlays?["conversation"]:void 0,isLtr:f.isLtr,fullScreenMobile:!1,showModal:e.showModal,onClose:function(){return e.onClose()},size:"md",bottomActions:s.default.createElement(i.Gutter,null,s.default.createElement(i.Button,{mode:"secondary",onClick:function(){e.onClose("cancel")}},t("message.contextMenu.delete.confirmation.cancelButton","No")),s.default.createElement(i.Button,{mode:"primary",onClick:function(){p(!0),e.onClose("ok")}},s.default.createElement(u.default,{label:t("message.contextMenu.delete.confirmation.okButton","Yes"),showSpinner:o}))),modalTitle:t("reportMessageModal.title","Report Message")},s.default.createElement(d.TranslationWrapper,{i18nKey:"reportMessageModal.body"},"Would you like to report this comment as inappropriate? The reported comment will not be displayed in your view."))};var r=o(n(49)),s=a(n(6)),i=n(43),l=n(54),u=o(n(425)),d=n(47),c=n(79),f=n(44)},901:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMessageElements=o,t.isMessageInViewport=function(e){var t=o({messageId:e});return t.length>0&&(n=t[0],a.viewportObserver.getVisibilityState(n).isVisible);var n},t.isMessageInDocument=function(e){return o({messageId:e}).length>0};var a=n(95);function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.messageId,n=void 0===t?void 0:t,a=e.depth,o=void 0===a?void 0:a,r=[];n?r.push('[data-message-id="'.concat(n,'"]')):r.push("[data-message-id]"),void 0!==o&&r.push('[data-message-depth="'.concat(o,'"]'));var s=document.querySelectorAll(r.join(""));return[].slice.call(s)}},903:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(35)),r=a(n(36)),s=a(n(40)),i=a(n(41)),l=a(n(42)),u=a(n(6)),d=a(n(18)),c=a(n(904));function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,l.default)(e);if(t){var o=(0,l.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,i.default)(this,n)}}var p=function(e){(0,s.default)(n,e);var t=f(n);function n(){var e;(0,o.default)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).wrapperRef=u.default.createRef(),e.state={startAnimation:!1,expanderStyle:{height:"0px"},demarginStyle:{marginTop:"-60px"}},e.maxHeight=void 0,e.startAnimation=function(){setTimeout((function(){e.setState({startAnimation:!0})}),1e3),setTimeout((function(){e.setState({animationDone:!0})}),3e3),e.setState({expanderStyle:{height:"0px"}}),e.interval=setInterval((function(){if(e.wrapperRef.current){var t=e.wrapperRef.current.getBoundingClientRect().height;if(t<e.maxHeight)return;e.maxHeight=t;var n=t+"px";n!==e.state.expanderStyle.height&&e.setState({expanderStyle:{height:n}}),"0px"!==e.state.demarginStyle.marginTop&&e.setState({demarginStyle:{marginTop:"0px"}})}}),100)},e}return(0,r.default)(n,[{key:"componentDidMount",value:function(){this.props.animate&&this.startAnimation()}},{key:"componentDidUpdate",value:function(e){this.props.animate&&this.props.animate!==e.animate&&this.startAnimation()}},{key:"render",value:function(){return this.props.animate?u.default.createElement("div",{className:(0,d.default)(c.default.animateInWrapper,this.state.startAnimation&&c.default.startAnimation,this.state.animationDone&&c.default.animationDone)},u.default.createElement("div",{className:c.default.demargin,style:this.state.demarginStyle},u.default.createElement("div",{className:c.default.expander,style:this.state.expanderStyle},u.default.createElement("div",{ref:this.wrapperRef,className:c.default.animateIn},this.props.children)))):this.props.children}}]),n}(u.default.Component);t.default=p},905:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DeletedMessage=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=o(n(46)),c=o(n(18)),f=n(45),p=a(n(6)),m=o(n(906)),g=n(71),v=n(43),h=n(78),y=o(n(93));function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var M=function(e){(0,i.default)(n,e);var t=E(n);function n(){return(0,r.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"renderTranslatedText",value:function(){var e=this.props,t=e.isReported,n=e.isDeleted;return t?p.default.createElement(g.TranslatedText,{textKey:"message.reported"}):n?p.default.createElement(g.TranslatedText,{textKey:"message.deleted"}):p.default.createElement(g.TranslatedText,{textKey:"message.muted"})}},{key:"render",value:function(){var e=this.props,t=e.userImageSize,n=e.innerRef,a=(0,h.createUserObject)();return p.default.createElement("div",{ref:n,className:(0,c.default)(m.default.messageDetails,m.default.deletedMessage)},p.default.createElement(y.default,{size:t,user:a,disableTooltip:!0}),p.default.createElement(v.Typography,{type:"infoMd",className:m.default.isDeleted},this.renderTranslatedText()))}}]),n}(p.Component);t.DeletedMessage=M,M.displayName="DeletedMessage",M.propTypes={spotName:d.default.string.isRequired,userImageSize:d.default.number.isRequired,isReported:d.default.bool.isRequired,isDeleted:d.default.bool.isRequired,innerRef:d.default.object.isRequired},M.defaultProps={userImageSize:"medium"};var b=(0,f.connect)((function(e){return{spotName:e.moduleOptions.spotName,moderatorBadgeText:e.moduleOptions.textsOverrides.moderatorBadgeText,reporterBadgeText:e.moduleOptions.textsOverrides.reporterBadgeText}}))(M);t.default=b},907:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MessageActions=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=o(n(53)),f=o(n(46)),p=a(n(6)),m=n(45),g=o(n(18)),v=n(48),h=n(20),y=a(n(50)),E=n(426),M=o(n(908)),b=o(n(910)),S=o(n(429)),R=o(n(52)),C=n(71),T=n(59),w=n(55),I=o(n(927));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var k=function(e){(0,l.default)(n,e);var t=O(n);function n(e){var a;return(0,s.default)(this,n),(a=t.call(this,e)).handleMessageReplyGotFocus=function(){a.props.messageReplyGotFocus()},a.onReply=function(){var e=a.props.conversationId;(0,w.dispatchSpotimEvent)(T.USER_CLICKED_REPLY),a.props.onReply(a.props.message,event),a.props.tracking.trackEvent({type:"editor-reply-focus",ugc_post_id:e})},a.handleCloseShareModal=function(){a.setState({showShareModal:!1})},a.state={showShareModal:!1},a}return(0,i.default)(n,[{key:"componentWillUnmount",value:function(){clearTimeout(this.isEditableTimeout)}},{key:"share",value:function(){var e=this;R.default&&"function"==typeof navigator.share?navigator.share({title:document.title,url:location.href}).catch((function(){e.setState({showShareModal:!0})})):this.setState({showShareModal:!0}),this.hideDroplist()}},{key:"render",value:function(){var e,t=this.props,n=t.message,a=t.currentUser,o=t.depth,s=t.enableVotes,i=t.isDisabled,l=t.enableReply,u=t.isLiveBlog,d=t.spotName,c=t.spotId,f=t.postId,m=this.state.showShareModal,v=(0,h.isLoggedIn)(a),y=(0,g.default)(I.default.messageActions,I.default["depth-".concat(o)],(e={},(0,r.default)(e,I.default.isDisabled,i),(0,r.default)(e,I.default.isLiveBlog,u),e));return p.default.createElement("div",{className:y},u&&p.default.createElement(p.default.Fragment,null,p.default.createElement(C.TranslatedText,{onClick:this.share.bind(this),className:I.default.shareMessageText,textKey:"message.share"}),p.default.createElement(S.default,{currentUser:a,spotId:c,spotName:d,message:n,show:m,onClose:this.handleCloseShareModal,postId:f})),l&&p.default.createElement(M.default,{messageReplyGotFocus:this.handleMessageReplyGotFocus,onReply:this.onReply}),p.default.createElement(b.default,{isEnabled:s,isLoggedIn:v,message:n,upVotesCount:n.upVotesCount,downVotesCount:n.downVotesCount}))}}]),n}(p.Component);t.MessageActions=k,k.displayName="MessageActions",k.propTypes={message:f.default.object.isRequired,spotName:f.default.string.isRequired,currentUser:f.default.object.isRequired,depth:f.default.number,onReply:f.default.func,enableReply:f.default.bool,enableVotes:f.default.bool,messageReplyGotFocus:f.default.func,isDisabled:f.default.bool,spotId:f.default.string.isRequired,postId:f.default.string.isRequired,conversationId:f.default.string.isRequired},k.defaultProps={depth:3,enableReply:!0,enableVotes:!0,onReply:function(){},messageReplyGotFocus:function(){}};var _=(0,c.default)((0,m.connect)((function(e){var t=y.isLiveBlog(e),n=e.isReadOnly;return{isLiveBlog:e.moduleOptions.isConversationLiveBlog,spotName:e.moduleOptions.spotName,spotId:e.moduleOptions.spotId,postId:e.moduleOptions.postId,conversationId:e.moduleOptions.conversationId,currentUser:e.currentUser,enableReply:!t&&!n,isMobileDevice:y.isMobile(e)||e.moduleOptions.isMobile}}),(function(e){return{onReply:function(t){e((0,E.openMessageSayControl)({messageId:t.id}))}}})),(0,v.track)({}))(k);t.default=_},908:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MessageReply=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=o(n(46)),c=a(n(6)),f=n(45),p=n(71),m=o(n(909)),g=n(43);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var h=function(e){(0,i.default)(n,e);var t=v(n);function n(){return(0,r.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"render",value:function(){return c.default.createElement(g.Button,{onClick:this.props.onReply},c.default.createElement(g.Typography,{type:"action",className:m.default.messageReply},c.default.createElement(p.TranslatedText,{"data-spot-im-class":"message-reply",role:"button",textKey:"message.reply"},"Reply")))}}]),n}(c.Component);t.MessageReply=h,h.displayName="MessageReply",h.propTypes={onReply:d.default.func,spotId:d.default.string,messageReplyGotFocus:d.default.func},h.defaultProps={onReply:function(){},messageReplyGotFocus:function(){}};var y=(0,f.connect)((function(e){return{spotId:e.moduleOptions.spotId}}))(h);t.default=y},910:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MessageVote=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=a(n(6)),c=n(45),f=o(n(911)),p=o(n(924));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var g=function(e){(0,i.default)(n,e);var t=m(n);function n(){return(0,r.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"render",value:function(){var e=this.props,t=e.isEnabled,n=e.isLoggedIn,a=e.message,o=e.upVotesCount,r=e.downVotesCount;return t&&d.default.createElement(f.default,{isLoggedIn:n,className:p.default.messageVote,message:a,isVotedUp:a.isVotedUp,isVotedDown:a.isVotedDown,upVotesCount:o,downVotesCount:r,showUpVotes:!0,showDownVotes:!0})}}]),n}(d.PureComponent);t.MessageVote=g;var v=(0,c.connect)((function(e){return{spotId:e.moduleOptions.spotId}}))(g);t.default=v},911:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=a(n(6)),c=n(45),f=o(n(18)),p=o(n(912)),m=o(n(914)),g=o(n(915)),v=n(922),h=o(n(1)),y=n(20),E=n(80),M=n(59),b=n(55),S=n(179);function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var C=h.default.get("tenant_config.conversation.disable_vote_up"),T=h.default.get("tenant_config.conversation.disable_vote_down"),w=function(e){(0,i.default)(n,e);var t=R(n);function n(){var e;(0,r.default)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={isVotedUp:e.props.isVotedUp,isVotedDown:e.props.isVotedDown,showVotersList:!1},e.toggleVoteUp=function(){var t=e.props,n=t.allowGuestVoting,a=t.showLoginSelectorModal;if(n){var o=e.state.isVotedUp,r=e.state.isVotedDown;r&&(r=!r),e.setState({isVotedUp:!o,isVotedDown:r}),e.props.onToggleVote({operation:"up"}),(0,b.dispatchSpotimEvent)(M.CLICKED_LIKE_THUMBS_UP)}else a()},e.toggleVoteDown=function(){var t=e.props,n=t.allowGuestVoting,a=t.showLoginSelectorModal;if(n){var o=e.state.isVotedUp,r=e.state.isVotedDown;o&&(o=!o),e.setState({isVotedUp:o,isVotedDown:!r}),e.props.onToggleVote({operation:"down"}),(0,b.dispatchSpotimEvent)(M.CLICKED_LIKE_THUMBS_DOWN)}else a()},e.handleCloseVotersList=function(){e.setState({showVotersList:!1})},e.renderUpVoteCount=function(){var t=e.props,n=t.showUpVotes,a=t.upVotesCount,o=t.message,r=e.state.showVotersList;return n&&d.default.createElement("span",{style:{display:"inline-flex"}},d.default.createElement(g.default,{count:a,message:o,showVotersList:r,onClick:e.handleClick,onCloseVotersList:e.handleCloseVotersList}))},e.renderDownVoteCount=function(){var t=e.props,n=t.showDownVotes,a=t.downVotesCount;return n&&d.default.createElement("span",{style:{display:"inline-flex"}},d.default.createElement(g.default,{count:a,showLikesList:!1}))},e.handleClick=function(){e.state.showVotersList||e.setState({showVotersList:!0})},e}return(0,s.default)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({isVotedUp:e.isVotedUp,isVotedDown:e.isVotedDown})}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.isLoggedIn,a=e.enablePoints,o=e.allowToast,r=e.showUpVotesBefore,s=e.showCounters,i=e.message,l=this.state,u=l.isVotedUp,c=l.isVotedDown,g=i.depth>0,v=null;v=void 0!==o?o:n&&a;var h=(0,f.default)(m.default.voteLinks,t);return d.default.createElement("div",{className:h,"data-spot-im-class":"vote-links"},!C&&d.default.createElement(d.default.Fragment,null,s&&r&&this.renderUpVoteCount(),d.default.createElement(p.default,{type:"up",isReply:g,active:u,onClick:this.toggleVoteUp,allowToast:v&&!c}),s&&!r&&this.renderUpVoteCount()),!T&&S.votesType!==S.VotesType.Recommend&&d.default.createElement(d.default.Fragment,null,d.default.createElement(p.default,{type:"down",isReply:g,active:c,onClick:this.toggleVoteDown,allowToast:v&&!u}),s&&this.renderDownVoteCount()))}}]),n}(d.Component);w.defaultProps={className:"",enablePoints:!1,showUpVotes:!1,showDownVotes:!1,showUpVotesBefore:!1,showCounters:!0,allowGuestVoting:!0};var I=(0,c.connect)((function(e){var t=e.currentUser,n=e.moduleOptions.enableGuestVoting;return{allowGuestVoting:(0,y.isLoggedIn)(t)||n}}),(function(e,t){return{onToggleVote:function(n){var a=n.operation;e((0,v.toggleVoteMessage)({operation:a,message:t.message}))},showLoginSelectorModal:function(){e((0,E.openLoginSelectorModal)())}}}))(w);t.default=I},912:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=a(n(6)),f=o(n(46)),p=o(n(18)),m=n(54),g=o(n(56)),v=n(179),h=o(n(913));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var E=function(e){(0,l.default)(n,e);var t=y(n);function n(){var e;(0,s.default)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={activeNoAnimation:e.props.active},e.wrapper=c.default.createRef(),e.onClick=function(t){var n=e.props.t,a=e.context.toastMessage;if(e.props.allowToast){var o=e.wrapper.current,r=n("general.toast.points",{points:a.values.RANK,sign:e.props.active?"-":"+"});a.show(o,r,{offsetY:-5})}e.props.onClick(),e.setState({activeNoAnimation:!1}),t.stopPropagation()},e.handleAnimatedVoteKeyUp=function(t){13===t.keyCode&&e.onClick(t)},e}return(0,i.default)(n,[{key:"render",value:function(){var e,t,n,a=this.props,o=a.active,s=a.type,i=a.tabIndex,l=a.isReply,u=this.state.activeNoAnimation,d=(0,p.default)(h.default.animatedVote,(e={},(0,r.default)(e,h.default.active,o),(0,r.default)(e,h.default.voteUpWrapper,"up"===s),(0,r.default)(e,h.default.isUpDown,v.votesType===v.VotesType.UpDown),e)),f=(0,p.default)(h.default.voteIcon,(t={},(0,r.default)(t,h.default.voteUpIcon,"up"===s),(0,r.default)(t,h.default.voteDownIcon,"down"===s),(0,r.default)(t,h.default.active,o),t));return c.default.createElement("div",{tabIndex:i,className:d,onClick:this.onClick,onKeyUp:this.handleAnimatedVoteKeyUp,"data-spot-im-class":"animated-vote-".concat(s),id:"spotim-animated-vote-".concat(s,"-").concat(l?"reply":"comment")},c.default.createElement("div",{className:h.default.voteWrapper,ref:this.wrapper},c.default.createElement(g.default,{selector:this.icon,className:(0,p.default)(f,(0,r.default)({},h.default.inactive,v.votesType===v.VotesType.Like))}),v.votesType===v.VotesType.Like&&c.default.createElement("div",{className:(0,p.default)(h.default.animatedLikeWrapper,(n={},(0,r.default)(n,h.default.active,o),(0,r.default)(n,h.default.activeNoAnimation,u),(0,r.default)(n,h.default.isDownVote,"down"===s),n))})))}},{key:"icon",get:function(){var e=this.props,t=e.active,n=e.type;switch(v.votesType){case v.VotesType.UpDown:return"up"===n?"angleUp":"angleDown";case v.VotesType.Recommend:return t?"recommended":"recommend";case v.VotesType.Like:default:return"up"===n?"voteUpIcon":"voteDownIcon"}}}]),n}(c.Component);E.contextTypes={toastMessage:f.default.object.isRequired};var M=(0,m.withTranslation)()(E);t.default=M},915:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(49)),s=a(n(6)),i=n(45),l=o(n(18)),u=n(54),d=n(43),c=o(n(52)),f=n(427),p=o(n(918)),m=n(47),g=n(44),v=n(179),h=o(n(921)),y=(0,i.connect)((function(e){return{votedUsers:e.upVotesList.users}}),(function(e){return{loadVotedUsers:function(t){var n=t.messageDepth,a=t.messageId,o=t.offset,r=void 0===o?0:o,s=t.count,i=void 0===s?10:s;e((0,f.getUpvotes)({messageDepth:n,messageId:a,offset:r,count:i}))}}}))((function(e){var t=e.count,n=e.votedUsers,a=e.loadVotedUsers,o=e.showLikesList,i=void 0===o||o,f=e.message,y=e.showVotersList,E=e.onCloseVotersList,M=void 0===E?function(){}:E,b=e.onClick,S=void 0===b?function(){}:b,R=(0,u.useTranslation)().t,C=(0,s.useState)(0),T=(0,r.default)(C,2),w=T[0],I=T[1];function O(){a({messageDepth:f.depth,messageId:f.id,offset:w})}return(0,s.useEffect)((function(){I(0),y&&O()}),[y]),v.votesType===v.VotesType.Like&&0===t?null:i?s.default.createElement(d.Menu,{isLtr:g.isLtr,isMobile:c.default,placement:"bottom",onShowChange:function(e){e?S():M()},showMenu:!1,trigger:0===t?"none":c.default?"click":"hover",mobileCancelButtonContent:s.default.createElement(m.TranslationWrapper,{i18nKey:"menu.closeButton"},"Done"),menuButton:v.votesType===v.VotesType.Recommend?s.default.createElement("span",{className:(0,l.default)(h.default.likesCount,h.default.clickable)},R("message.recommend",{count:t,context:"".concat(t)})):s.default.createElement("span",{className:(0,l.default)(h.default.likesCount,h.default.clickable)},t)},s.default.createElement(p.default,{users:n,scheduleUpdate:function(){},upVotesCount:f.upVotesCount,onLoadMore:function(){I(w+10),O()}})):s.default.createElement("span",{className:h.default.likesCount},t)}));t.default=y},917:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getUpvotesRequest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,i={message_type:0===e?"comment":"reply",message_id:t,spot_id:n,offset:a,count:r};return(0,o.default)("v1.0.0/conversation/rank/message/users",{postId:s,method:"POST",data:i})};var o=a(n(58))},918:function(e,t,n){"use strict";var a=n(0),o=n(34);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,s=a(n(49)),i=a(n(33)),l=o(n(6)),u=n(45),d=a(n(18)),c=n(54),f=a(n(1174)),p=n(20),m=a(n(93)),g=n(107),v=a(n(920)),h=n(44),y=a(n(428)),E=n(179),M=(r={},(0,i.default)(r,E.VotesType.Like,"likersList"),(0,i.default)(r,E.VotesType.UpDown,"upDownList"),(0,i.default)(r,E.VotesType.Recommend,"recommendList"),r),b=(0,u.connect)((function(e){return{direction:e.moduleOptions.direction,disableUserProfileModal:e.moduleOptions.disableUserProfileModal}}),(function(e){return{dispatch:e}}))((function(e){var t=e.users,n=void 0===t?[]:t,a=e.dispatch,o=e.scheduleUpdate,r=e.upVotesCount,u=e.onLoadMore,b=e.disableUserProfileModal,S=(0,c.useTranslation)().t,R=(0,f.default)(),C=(0,s.default)(R,2),T=C[0],w=C[1];function I(e,t){t.preventDefault(),h.disableUserProfile||a((0,g.openUserProfileModal)({user:e}))}(0,l.useEffect)((function(){o&&o()}),[n]),(0,l.useEffect)((function(){T.isIntersecting&&u()}),[T]);var O=0===n.length,k=(0,d.default)(y.default.user,(0,i.default)({},y.default.notClickable,b||h.disableUserProfile)),_=S("".concat(M[E.votesType],".header"),{numUsers:r,count:r});return l.default.createElement("div",{className:(0,d.default)(y.default.usersList,O&&y.default.isLoading)},l.default.createElement("div",{className:y.default.header},_),l.default.createElement("div",{className:y.default.list},O&&l.default.createElement(v.default,null),!O&&n.map((function(e){return l.default.createElement("a",{href:"spotim-user",className:k,key:e.id,onClick:I.bind(null,e)},l.default.createElement("div",{className:(0,d.default)(!h.disableUserAvatar&&y.default.userImage)},l.default.createElement(m.default,{user:e,isOnline:e.isOnline,size:33,disableUserImageUpload:!0})),l.default.createElement("div",{className:y.default.userDetails},l.default.createElement("div",{className:(0,d.default)(y.default.displayName,(0,i.default)({},y.default.notClickable,h.disableUserProfile))},(0,p.getDisplayName)(e)),l.default.createElement("div",{className:(0,d.default)(y.default.username,(0,i.default)({},y.default.notClickable,h.disableUserProfile))},"@",e.username)))})),l.default.createElement("div",{ref:w})))}));t.default=b},920:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(6)),r=a(n(178)),s=a(n(1)),i=a(n(428));t.default=function(){return o.default.createElement("div",{className:i.default.activityIndicator},o.default.createElement(r.default,{baseUrl:document.location.href,rtl:!s.default.get("init_data.config.ltr"),height:98,width:224,speed:2,backgroundColor:getComputedStyle(document.documentElement).getPropertyValue("--spotim-content-loader-primary-color"),foregroundColor:getComputedStyle(document.documentElement).getPropertyValue("--spotim-content-loaders-secondary-color")},o.default.createElement("rect",{x:"52",y:"11",rx:"8",ry:"8",width:"153",height:"13"}),o.default.createElement("circle",{cx:"27",cy:"17",r:"12"}),o.default.createElement("rect",{x:"52",y:"44",rx:"8",ry:"8",width:"153",height:"13"}),o.default.createElement("circle",{cx:"27",cy:"50",r:"12"}),o.default.createElement("rect",{x:"52",y:"77",rx:"8",ry:"8",width:"153",height:"13"}),o.default.createElement("circle",{cx:"27",cy:"83",r:"12"})))}},922:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.toggleVoteMessage=function(e){var t=e.operation,n=e.message;return function(){var e=(0,s.default)(o.default.mark((function e(a,r){var s,f,v,h,y,E,M,b,S,R,C;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=r(),f=s.moduleOptions.postId,v=s.conversation,h=v.id,y=v.contentType,E=s.currentUser.id,M=n.id,b=n.isVotedUp,S=n.isVotedDown,"up"!==t||b?"down"!==t||S||(0,u.dispatchSpotimEvent)(c.USER_DOWN_VOTE_CLICK):(0,u.dispatchSpotimEvent)(c.USER_UP_VOTE_CLICK),a({type:d.VOTE_TOGGLE_MESSAGE_START,payload:{operation:t,message:n}}),R=n.depth>0,C=g(b,S,t),e.next=9,(0,l.toggleVoteComment)({postId:f,isReply:R,data:p(p({},C),{},{message_id:M,source:y})});case 9:m(r,{operation:t,message:n,conversationId:h,userId:E}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),a({type:d.VOTE_TOGGLE_MESSAGE_END,payload:{error:e.t0,operation:t,rootMessageId:rootMessageId,id:id},error:!0}),i.metrics.error("toggleVoteMessage",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}()};var o=a(n(37)),r=a(n(33)),s=a(n(38)),i=n(3),l=n(923),u=n(55),d=n(39),c=n(59);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){var n=t.operation,a=t.message,o=t.conversationId,r=void 0===o?null:o,s=t.userId,l={userId:void 0===s?null:s,conversationId:r,messageId:a.id};a.featuredComment&&(l.target_type="featured-comment",l.segment="top"===a.featuredComment?"top-featured-comment":"in-conversation-featured"),"up"===n?a.isVotedUp?l.type="liked-cancelled":l.type="liked":a.isVotedDown?l.type="disliked-cancelled":l.type="disliked",i.metrics.send(l.type)}function g(e,t,n){var a;switch(!0){case"up"===n&&!e&&!t:a="like";break;case"up"===n&&e&&!t:a="toggle-like";break;case"up"===n&&!e&&t:a="swap-to-like";break;case"down"===n&&!e&&!t:a="dislike";break;case"down"===n&&!e&&t:a="toggle-dislike";break;case"down"===n&&e&&!t:a="swap-to-dislike"}return{operation:a}}},923:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.toggleVoteComment=function(e){return c.apply(this,arguments)};var o=a(n(37)),r=a(n(38)),s=a(n(58)),i=n(44),l=a(n(73));function u(e){return d.apply(this,arguments)}function d(){return(d=(0,r.default)(o.default.mark((function e(t){var n,a,r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.messageId,a=t.operation,r=a,e.next=4,(0,l.default)("rank/reply/".concat(n),{method:"POST",data:r});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(){return(c=(0,r.default)(o.default.mark((function e(t){var n,a,r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,a=t.postId,r=t.isReply,i.disableRankV2Endpoint){e.next=7;break}return e.next=4,(0,s.default)("v1.0.0/rank/rank/message",{method:"POST",data:n,postId:a});case 4:return e.abrupt("return",e.sent);case 7:if(!r){e.next=13;break}return e.next=10,u({messageId:n.message_id,operation:{operation:n.operation}});case 10:e.t0=e.sent,e.next=16;break;case 13:return e.next=15,(0,l.default)("rank/comment/".concat(n.message_id),{method:"POST",data:{operation:n.operation}});case 15:e.t0=e.sent;case 16:return e.abrupt("return",e.t0);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},928:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MessageDetails=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=o(n(53)),f=a(n(6)),p=o(n(48)),m=n(45),g=o(n(18)),v=n(54),h=n(20),y=n(101),E=o(n(1)),M=n(929),b=a(n(50)),S=n(80),R=o(n(430)),C=n(44),T=n(77),w=n(431),I=o(n(249));function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var k=function(e){(0,l.default)(a,e);var t=O(a);function a(){var e;(0,s.default)(this,a);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={isVisible:!1},e.snippets=n(933),e.getSnippets=function(){return e.snippets},e.handleUsernameMouseOver=function(){e.props.tracking.trackEvent({type:"user-profile-hovered",item_type:"main",message_id:e.props.message.id,target_id:e.props.user.id})},e.handleOpenUserProfile=function(t){var n=e.props,a=n.message,o=n.user,r=n.currentUser,s=n.tracking,i=(0,h.isSameUser)(r,o);s.trackEvent({type:"user-profile-clicked",item_type:"main",target_type:"tooltip"===t?"profile-preview":"message",native:0===a.depth?"comment":"reply",segment:"name",target_id:i?"my-profile":o.id,message_id:a.id,related_message_id:a.rootMessageId,ugc_post_id:e.props.conversationId})},e}return(0,i.default)(a,[{key:"componentDidMount",value:function(){this.setState({isVisible:!0})}},{key:"render",value:function(){var e,t=this.props,n=t.message,a=t.user,o=t.showBadge,s=(t.showReplyTo,t.messageUrl),i=t.reporters,l=t.spotName,u=t.currentUser,d=t.onMessageUrlClick,c=t.reporterBadgeText,p=t.moderatorBadgeText,m=t.communityModeratorBadgeText,v=t.adminBadgeText,h=t.journalistBadgeText,b=t.enableHideMessage,S=t.messageContextMenu,O=t.enableGamificationBadges,k=t.isMobileDevice,_=t.innerRef,N=t.t,x=t.isDisabled,D=Array.isArray(i)&&(i.indexOf(a.username)>-1||i.indexOf(a.id)>-1),P=null,U=E.default.get("tenant_config.conversation.disable_badges",!1),L=(0,T.getUserBadge)(a,D);o&&!U&&L&&(P=f.default.createElement(R.default,{user:a,spotName:l,badge:L,reporterBadgeText:c,moderatorBadgeText:p,communityModeratorBadgeText:m,adminBadgeText:v,journalistBadgeText:h,enableGamificationBadges:O}));var A=null;s&&(A=f.default.createElement(M.MessageUrl,{url:s,onClick:d}));var B=(0,g.default)(I.default.username,(e={},(0,r.default)(e,I.default.brandFill,D),(0,r.default)(e,I.default.isUserProfileDisabled,C.disableUserProfile),(0,r.default)(e,I.default.isDisabled,x),e)),F=[];(u.id===n.user.id||u.isModerator)&&(F.push(N("delete")),b&&F.push(N("hide")));var j=n.depth>0,V=a.isRegistered&&C.enableUserReputation&&!(0,T.isStaffMember)(a);return f.default.createElement(y.Column,{ref:_,className:(0,g.default)(I.default.messageDetails,(0,r.default)({},I.default.depth0,0===n.depth))},f.default.createElement(y.Row,{className:I.default.messageDetailsRow},f.default.createElement(y.Username,{"data-spot-im-class":"message-username",className:B,user:this.props.user,onMouseOver:this.handleUsernameMouseOver,onOpenUserProfile:this.handleOpenUserProfile,truncated:!0}),V&&f.default.createElement(y.Reputation,{user:a}),P,!k&&f.default.createElement(f.default.Fragment,null,f.default.createElement(w.MessageReplyTo,{message:n,isMobile:k}),this.getSnippets().renderFeaturedComment(this.props,!1))),f.default.createElement(y.Row,null,k&&f.default.createElement(f.default.Fragment,null,f.default.createElement(w.MessageReplyTo,{message:n,isMobile:k}),j&&f.default.createElement("span",{className:I.default.middleDot})),this.getSnippets().renderStats(n,null,A,this.state.isVisible,this.props)),S)}}]),a}(f.Component);t.MessageDetails=k,k.defaultProps={reporters:[],enableProfileHover:!0,showBadge:!0,spotName:"",showReplyTo:!1,messageUrl:null,onMessageUrlClick:function(){},onLogin:function(){},messageContextMenu:null,enableGamificationBadges:!0,featuredComment:null,journalistBadgeText:null,convId:""};var _=(0,c.default)((0,m.connect)((function(e){var t=e.moduleOptions,n=t.conversationId,a=t.enableGamificationBadges,o=t.enableSSO,r=t.spotName,s=t.textsOverrides,i=s.moderatorBadgeText,l=s.communityModeratorBadgeText,u=s.reporterBadgeText,d=t.isConnectEnabled,c=t.isMobile,f=e.conversation,p=f.contentType,m=f.id;return{conversationId:n,enableGamificationBadges:a,token:e.authentication.token,enableSSO:o,spotName:r,moderatorBadgeText:i,communityModeratorBadgeText:l,reporterBadgeText:u,reporters:b.getReporters(e),currentUser:e.currentUser,showUserImageButton:d&&!o,isMobileDevice:b.isMobile(e)||c,contentType:p,convId:m}}),{onLogin:S.openLoginSelectorModal}),(0,p.default)({}),(0,v.withTranslation)())(k);t.default=_},929:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.MessageUrl=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=o(n(46)),c=a(n(6)),f=o(n(18)),p=n(71),m=o(n(930));function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var v=function(e){(0,i.default)(n,e);var t=g(n);function n(){return(0,r.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.url,a=e.onClick;return t=(0,f.default)(m.default.messageUrl,t),c.default.createElement("span",{className:t},c.default.createElement("a",{href:n,className:m.default.link,onClick:function(e){return a(e,n)}},c.default.createElement(p.TranslatedText,{textKey:"message.conversationLinkText"})))}}]),n}(c.Component);t.MessageUrl=v,v.displayName="MessageUrl",v.propTypes={className:d.default.string,url:d.default.string,onClick:d.default.func},v.defaultProps={className:void 0,url:"",onClick:function(){}}},933:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.renderFeaturedComment=t.renderStats=t.displayUserName=t.renderPrettyDate=void 0;var o=a(n(6)),r=a(n(432)),s=a(n(249)),i=n(20),l=(n(431),n(935)),u=function(e){var t=e.message,n=t.depth>0;return o.default.createElement(r.default,{"data-spot-im-class":"message-timestamp",id:"spotim-message-timestamp-".concat(n?"reply":"comment"),date:t.postedAt||t.publishedAt,longDate:!e.isMobileDevice})};t.renderPrettyDate=u;t.displayUserName=function(e){var t=e.message,n=e.user;return t.userDisplayName||(0,i.getDisplayName)(n)};t.renderStats=function(e,t,n,a,r){return o.default.createElement("div",{className:s.default.stats},r.children,r.isMobileDevice&&d(r,!0),a&&u(r),t,n)};var d=function(e,t){return"top"===e.message.featuredComment?(0,l.renderFeaturedCommentSection)(e.spotName,{onlyBadge:!1,brandColor:e.brandColor,isMobile:e.isMobileDevice,inline:t}):e.message.featured?(0,l.renderFeaturedCommentSection)(e.spotName,{onlyBadge:!0,brandColor:e.brandColor,isMobile:e.isMobileDevice,inline:t}):null};t.renderFeaturedComment=d},934:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prettyDate=function(e,t,n){var r=e.getTime(),s=(Date.now()-r)/1e3,i=null,l=t?"long":"short",u=o(e.getUTCFullYear());if(!r||isNaN(s))i="";else if(s<14)i=n("".concat("prettyDate.","now"));else if(s<60){var d=Math.floor(s);i=n("".concat("prettyDate.").concat(l,"Second"),{count:d,seconds:d})}else if(s<3600){var c=Math.floor(s/60);i=n("".concat("prettyDate.").concat(l,"Minute"),{count:c,minutes:c})}else if(s<86400){var f=Math.floor(s/3600);i=n("".concat("prettyDate.").concat(l,"Hour"),{count:f,hours:f})}else{var p=e.getUTCMonth()+1,m=Math.floor(s/86400);if(m<3)i=n("".concat("prettyDate.").concat(l,"Day"),{count:m,days:m});else if(a.enableDateFormat){i=new Intl.DateTimeFormat(a.dateFormat,{year:"numeric",month:"long",day:"numeric"}).format(e)}else i="".concat(e.getDate()," ").concat(n("".concat("prettyDate.","months.").concat(p,".").concat(l))).concat(t||!u?", ".concat(e.getUTCFullYear()):"")}return i},t.toolTipDate=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"short",a=e.getMonth()+1;return"".concat(e.getDate()," ").concat(t("".concat("prettyDate.","months.").concat(a,".").concat(n)),", ").concat(e.getUTCFullYear()," ").concat(e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))};var a=n(44);var o=function(e){return e===(new Date).getFullYear()}},935:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.renderFeaturedCommentSection=void 0;var o=a(n(33)),r=a(n(6)),s=a(n(56)),i=n(71),l=a(n(249)),u=a(n(18)),d=n(101);t.renderFeaturedCommentSection=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{onlyBadge:!1,isMobile:!1,inline:!1},n=t.onlyBadge,a=t.isMobile,c=t.inline;if(!e)return null;function f(){return n?null:r.default.createElement(s.default,{className:l.default.FeaturedIcon,selector:"thumbtackIcon"})}function p(){return n&&!a?null:r.default.createElement("span",{className:l.default.Space},"")}function m(){return r.default.createElement("span",{className:(0,u.default)([l.default.Badge,(0,o.default)({},l.default.Badge_OnlyBadgeNotInline,n&&!c)])},r.default.createElement(i.TranslatedText,{textKey:"featuredComment.".concat(a?"featured":"featuredBy"),params:{spotName:e.toUpperCase()}}))}return a?r.default.createElement(d.Row,{className:l.default.featuredBadgeRow},p(),f(),m()):r.default.createElement(d.Row,null,p(),f(),m())}},936:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=o(n(53)),c=o(n(46)),f=a(n(6)),p=n(45),m=n(51),g=a(n(50)),v=n(55),h=n(59),y=n(54),E=n(79);function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var b=function(e){(0,i.default)(n,e);var t=M(n);function n(){var e;(0,r.default)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).onLoadFrameButtonClick=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];v.dispatchSpotimEvent.apply(void 0,[h.FRAME_ENTITY_LOAD].concat(t))},e}return(0,s.default)(n,[{key:"render",value:function(){var e=this.props,t=e.message,n=e.maxChars,a=e.maxLines,o=e.depth,r=e.shortenText,s=e.showFullText,i=e.innerRef,l=e.isDisabled,u=e.isLiveBlog,d=(e.showLoadFrameEntityButton,e.allowFrameEntityLoad),c=e.direction,p=e.forceEntityShow,g=e.t;return f.default.createElement(m.MessageEntities,{message:t,isLtr:"ltr"===c,depth:o,innerRef:i,isDisabled:l,isLiveBlog:u,seeMoreTranslatedText:g("general.seeMore.long"),showPostText:g("general.showPost"),editedTranslatedText:g("message.edited"),showLoadFrameEntityButton:!1,onLoadFrameButtonClick:this.onLoadFrameButtonClick,allowFrameEntityLoad:d,direction:c,forceEntityShow:p,maxChars:n,maxLines:a,shortenText:r,showFullText:s,shadowRootCssModules:E.isUseShadowDomOnOverlays?["conversation"]:void 0})}}]),n}(f.Component);b.displayName="MessageEntities",b.propTypes={message:c.default.object.isRequired,direction:c.default.oneOf(["rtl","ltr"]).isRequired,flexDirection:c.default.oneOf(["column","row"]),showAttachment:c.default.bool,showSeeMoreButton:c.default.bool,noImageAnchors:c.default.bool,maxChars:c.default.number,maxLines:c.default.number,allowFrameEntityLoad:c.default.bool,depth:c.default.number,noAnchors:c.default.bool,shortenText:c.default.bool,richText:c.default.bool,preserveLinebreaks:c.default.bool,showLoadFrameEntityButton:c.default.bool,isMobileDevice:c.default.bool,showFullText:c.default.bool,forceEntityShow:c.default.bool,size:c.default.string,padMessage:c.default.bool,isModal:c.default.object,innerRef:c.default.object.isRequired,isDisabled:c.default.bool,isLiveBlog:c.default.bool},b.defaultProps={showSeeMoreButton:!0,showAttachment:!1,maxChars:0,noAnchors:!1,noImageAnchors:!1,seeMoreTranslate:"long",shortenText:!1,depth:3,richText:!0,preserveLinebreaks:!0,showLoadFrameEntityButton:!0,forceEntityShow:!1,isMobileDevice:!1,size:"normal",padMessage:!0,flexDirection:"row"};var S=(0,d.default)((0,p.connect)((function(e){return{noImageAnchors:e.moduleOptions.conversationImageAnchorsDisabled,allowFrameEntityLoad:e.moduleOptions.allowFrameEntityLoad,direction:e.moduleOptions.direction,isMobileDevice:g.isMobile(e)||e.moduleOptions.isMobile,isLiveBlog:g.isLiveBlog(e)}})),(0,y.withTranslation)())(b);t.default=S},937:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=o.default.createElement(i.TranslationWrapper,{i18nKey:"message.contextMenu.muteUser.confirmation.mute.title"}),n=o.default.createElement(i.TranslationWrapper,{i18nKey:"message.contextMenu.muteUser.confirmation.mute.message"}),a=o.default.createElement(i.TranslationWrapper,{i18nKey:"message.contextMenu.muteUser.confirmation.mute.modalConfirm"}),d=o.default.createElement(i.TranslationWrapper,{i18nKey:"message.contextMenu.muteUser.confirmation.mute.cancelButton"});return o.default.createElement(s.Modal,{disableCustomBodyScroll:u.disableModalDefaultScroll,shadowRootCssModules:l.isUseShadowDomOnOverlays?["conversation"]:void 0,isLtr:u.isLtr,closeButton:!0,showModal:e.showMuteUserModal,className:r.default.userMutingModal,onClose:function(){return e.onClose()},modalTitle:t,size:"md",bottomActions:o.default.createElement(s.Gutter,null,o.default.createElement(s.Button,{mode:"secondary",onClick:function(){return e.onClose()}},d),o.default.createElement(s.Button,{mode:"primary",onMouseEnter:e.muteUserHovered,onClick:function(){var t=e.message;(0,e.muteUser)(t.user.id),e.onClose(!0)}},a))},o.default.createElement("div",{className:r.default.text,style:{fontFamily:"Open Sans, Open Sans Hebrew, Arial",fontSize:"15px",lineHeight:"1.4",marginBottom:"24px"}},n))};var o=a(n(6)),r=a(n(938)),s=n(43),i=n(47),l=n(79),u=n(44)},939:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RejectedMessage=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=o(n(53)),c=a(n(6)),f=n(45),p=o(n(18)),m=o(n(940)),g=n(47),v=o(n(93));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var y=function(e){(0,i.default)(n,e);var t=h(n);function n(){return(0,r.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"render",value:function(){var e=this.props,t=e.userImageSize,n=e.message,a=e.currentUser.id===n.user.id?"rejected":"defaultRejected";return c.default.createElement("div",{className:(0,p.default)(m.default.messageDetails,m.default.rejectedMessage)},c.default.createElement(v.default,{size:t,user:n.user,disableTooltip:!0}),c.default.createElement("div",{className:m.default.isRejected},c.default.createElement(g.TranslationWrapper,{i18nKey:"message.".concat(a)})))}}]),n}(c.Component);t.RejectedMessage=y,y.defaultProps={userImageSize:"medium"};var E=(0,d.default)((0,f.connect)((function(e){return{spotName:e.moduleOptions.spotName,currentUser:e.currentUser,moderatorBadgeText:e.moduleOptions.textsOverrides.moderatorBadgeText,reporterBadgeText:e.moduleOptions.textsOverrides.reporterBadgeText}})))(y);t.default=E},941:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.removeAsFeatured=t.pinFeaturedCommentApi=t.setAsFeaturedMessage=void 0;var o=a(n(37)),r=a(n(38)),s=a(n(73)),i=function(){var e=(0,r.default)(o.default.mark((function e(t,n,a,r){var i,l,u;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.id.split("_c_")[0],e.next=3,(0,s.default)("moderation/conversation/".concat(i,"/message/").concat(t.id,"/feature"),{method:"POST"});case 3:l=e.sent,!(u=l.body).success&&u.result&&u.result.indexOf("should_top_feature")>-1?n():a&&a(),localStorage.setItem("__SPOTIM_HIDE_FEATURED_COMMENT_NEW_BADGE__","true");case 7:case"end":return e.stop()}}),e)})));return function(t,n,a,o){return e.apply(this,arguments)}}();t.setAsFeaturedMessage=i;var l=function(){var e=(0,r.default)(o.default.mark((function e(t){var n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id.split("_c_")[0],e.next=3,(0,s.default)("moderation/conversation/".concat(n,"/message/").concat(t.id,"/feature"),{data:{should_top_feature:!0},method:"POST"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.pinFeaturedCommentApi=l;var u=function(){var e=(0,r.default)(o.default.mark((function e(t,n){var a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id.split("_c_")[0],e.next=3,(0,s.default)("moderation/conversation/".concat(a,"/message/").concat(t.id,"/feature"),{data:{only_remove_top_featured:!("top"!==t.featuredComment)},method:"DELETE"});case 3:"function"==typeof n&&n();case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();t.removeAsFeatured=u},942:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.reportMessage=function(e){var t=e.message;return function(){var e=(0,i.default)(r.default.mark((function e(n,a){var o,i,m,g;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=0===t.depth?"comment":"reply",i="show_report_".concat(o,"_modal"),l.metrics.apm.start(i),m=a(),g=m.conversation.postId,n({type:d.SHOW_REPORT_MESSAGE_MODAL,payload:!0}),!f.isModerationV2ReportEnabled){e.next=11;break}return e.next=9,c.reportMessage(t.id,g);case 9:e.next=18;break;case 11:if(!(t.depth>0)){e.next=16;break}return e.next=14,(0,p.reportReply)(t.id);case 14:e.next=18;break;case 16:return e.next=18,(0,p.reportComment)(t.id);case 18:v(t),n({type:d.REPORT_MESSAGE_END,payload:{message:t}}),n((0,u.updateReportedComments)((0,s.default)({},t.id,!0))),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(0),n({type:d.REPORT_MESSAGE_END,payload:{error:e.t0},error:!0}),l.metrics.error("reportMessage",e.t0);case 27:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t,n){return e.apply(this,arguments)}}()};var r=o(n(37)),s=o(n(33)),i=o(n(38)),l=n(3),u=n(159),d=n(39),c=a(n(82)),f=n(44),p=n(81);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e){var t=(0,s.default)({},e.id,!0),n=window.localStorage.getItem("SPOTIM_REPORTED_COMMENTS");n=g(g({},n&&JSON.parse(n)),t),window.localStorage.setItem("SPOTIM_REPORTED_COMMENTS",JSON.stringify(n))}},943:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unmarkMessage=function(e){var t=e.id;return{type:a.TOGGLE_MARK_MESSAGE,payload:{message:{id:t,isMarked:!1}}}};var a=n(39)},944:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.muteUser=function(e){return function(t,n){var a=n().conversation.postId;(0,r.default)({userId:e,postId:a}),t({type:o.MUTE_USER,payload:{userId:e}})}};var o=n(39),r=a(n(945))},945:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(58));t.default=function(e){var t=e.userId,n=e.postId;return(0,o.default)("v1.0.0/user/mute-user",{method:"POST",postId:n,data:{user_id:t}})}},947:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetUpVotes=function(){return{type:a.RESET_UP_VOTES}};var a=n(39)},948:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(82);t.default=function(e,t){return(0,a.moderationClient)("user-status/".concat(e),{method:"GET",postId:t,data:{}})}},949:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SayControlRendered=function(e){var t=e.messageId;return{type:a.SAY_CONTROL_RENDERED,payload:{messageId:t}}};var a=n(39)},950:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.closeEditSayControl=function(e){var t=e.messageId;return{type:a.CLOSE_EDIT_SAY_CONTROL,payload:{messageId:t}}};var a=n(39)},951:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.closeReplySayControl=function(e){var t=e.messageId;return{type:a.CLOSE_REPLY_SAY_CONTROL,payload:{messageId:t}}};var a=n(39)},952:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.fetchUserSuspensionStatus=function(){return function(){var e=(0,r.default)(o.default.mark((function e(t,n){var a,r,d,c,f,p,m;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=n(),r=a.moduleOptions.postId,d=a.userSuspension.isFetched,c=(0,l.isSuspensionEnabled)(),!d&&c){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,(0,u.userSuspended)(r);case 7:f=e.sent,p=f.suspended,m=f.suspension_expiration,t({type:i.FETCH_USER_SUSPENSION_STATUS,payload:{isUserSuspended:p,expirationTime:m}}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),t({type:i.FETCH_USER_SUSPENSION_STATUS,payload:{isUserSuspended:!1}}),s.metrics.error("fetchUserSuspensionStatus",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}()};var o=a(n(37)),r=a(n(38)),s=n(3),i=n(39),l=n(91),u=n(177)},953:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.notifyTyping=function(e,t){return(0,o.default)("v1.0.0/conversation/typing/create",{method:"POST",postId:(0,r.default)(e),data:{conversation_id:e,message_id:t}})};var o=a(n(58)),r=a(n(221))},954:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.editMessage=function(e){var t=e.messageId,n=e.depth,a=e.displayName,o=e.status,s=e.entities,u=e.oldEntities,g=e.starsRating,h=void 0===g?0:g,y=e.oldStarsRating,E=void 0===y?0:y;return function(){var e=(0,i.default)(r.default.mark((function e(i,g){var y,R,C,T,w,I,O,k,_,N,x,D;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.metrics.apm.start("edit_message"),y=g(),R=y.conversation,C=y.moduleOptions,T=C.enableBlindfold,w=C.postId,I=y.currentUser,O=f.isModerationV2EditEnabled?s.filter((function(e){return"text"!==e.type||"text"===e.type&&""!==e.text})):s,k=R.starsRatingCount,_=R.averageStarsRating,h>0?(_=(_*k-E+h)/k,0===E&&(k+=1)):E>0&&0===h&&(_=(_*(k-=1)-E)/k),i({type:l.EDIT_MESSAGE_START,payload:{message:{id:t,userDisplayName:a,isEdited:!0,entities:O,starsRating:h,oldStarsRating:E},conversation:{starsRatingCount:k,averageStarsRating:_}}}),e.prev=6,T&&(o===v.PENDING||o===v.BLOCKED)){e.next=35;break}if(x={starsRating:h},I.isRegistered||(x=M(M({},x),{},{displayName:a})),!(n>0)){e.next=23;break}if(!f.isModerationV2EditEnabled){e.next=18;break}return e.next=15,p.editMessage({messageId:t,entities:O,displayName:(0,c.getDisplayName)(I),postId:w,starsRating:h});case 15:N=e.sent,e.next=21;break;case 18:return e.next=20,(0,m.editReply)(t,O.map(b),x);case 20:N=e.sent;case 21:e.next=32;break;case 23:if(!f.isModerationV2EditEnabled){e.next=29;break}return e.next=26,p.editMessage({messageId:t,entities:O,displayName:(0,c.getDisplayName)(I),postId:w,starsRating:h});case 26:N=e.sent,e.next=32;break;case 29:return e.next=31,(0,m.editComment)(t,O.map(b),x);case 31:N=e.sent;case 32:D=S(N.body),Object.assign(D.message,{id:t,status:o}),i({type:l.EDIT_MESSAGE_END,payload:M({},D)});case 35:d.metrics.apm.end("edit_message"),e.next=42;break;case 38:e.prev=38,e.t0=e.catch(6),i({type:l.EDIT_MESSAGE_END,payload:{error:e.t0,message:{id:t,isEdited:!1,entities:u,starsRating:E}},error:!0}),d.metrics.error("editMessage",e.t0);case 42:case"end":return e.stop()}}),e,null,[[6,38]])})));return function(t,n){return e.apply(this,arguments)}}()};var r=o(n(37)),s=o(n(33)),i=o(n(38)),l=n(39),u=n(51),d=n(3),c=n(20),f=n(44),p=a(n(82)),m=n(81),g=o(n(83)),v=n(132),h=n(302),y=n(157);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e){switch(e.type){case u.entityTypes.TEXT:return(0,u.textToBackendJson)(e);case u.entityTypes.IMAGE:return(0,u.imageToBackendJson)(e);case u.entityTypes.LINK:return(0,u.linkToBackendJson)(e);case u.entityTypes.VIDEO:return(0,u.videoToBackendJson)(e);case u.entityTypes.MENTION:return(0,u.mentionToBackendJson)(e);case u.entityTypes.FRAME:return(0,u.frameToBackendJson)(e);case u.entityTypes.ANIMATION:return(0,u.animationToBackendJson)(e);default:return null}}function S(e){var t=g.default.map(e,(0,y.getMessageMap)("message"),{conversation_id:"conversation.id",etag:"conversation.etag"}),n=t.message,a=t.conversation,o=t.users;return o&&(0,h.linkUsersToMessage)(n,o),{message:n,conversation:a,users:o}}},956:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.UserPoints=void 0;var o=a(n(6)),r=a(n(957)),s=n(43),i=n(47),l=n(52),u=n(5);t.UserPoints=function(e){var t,n,a=e.total,d=void 0===a?1:a,c=e.isLtr,f=void 0===c||c;return o.default.createElement("div",{className:r.default.pointsWrapper},o.default.createElement("span",{className:r.default.dotSeparator}),o.default.createElement(s.Tooltip,{isLtr:f,placement:"bottom",trigger:(0,l.isMobile)()?"click":"hover",onShowChange:function(e){return e&&void 0},tooltipContent:o.default.createElement("div",{className:r.default.tooltipWrapper},o.default.createElement(s.Typography,{type:"infoXs",color:"#fff"},o.default.createElement(i.TranslationWrapper,{i18nKey:"user.reputation.description"},"Reputation points are measured by how other community members respond to your contributions. The more positive impact you make, the more points you gain.")),o.default.createElement(s.Button,{className:r.default.learnMoreBtn,onClick:function(){var e,t,n;null===(e=window)||void 0===e||null===(t=e.__OPEN_WEB__)||void 0===t||null===(n=t.renderReputationDescriptionModal)||void 0===n||n.call(t)}},o.default.createElement(s.Typography,{type:"infoXs",weight:"bold",color:"#fff"},o.default.createElement(i.TranslationWrapper,{i18nKey:"realtimeModeration.learnMore"},"Learn More"))))},o.default.createElement(s.Typography,{type:"infoSm"},(t=(0,u.parseNumber)(d),n=d,o.default.createElement(i.TranslationWrapper,{i18nKey:"user.reputation.point",count:n,values:{points:t}},t," Points")))))}},958:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"EditorWrapper",{enumerable:!0,get:function(){return o.default}});var o=a(n(959))},959:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(49)),s=o(n(37)),i=o(n(38)),l=o(n(33)),u=o(n(35)),d=o(n(36)),c=o(n(40)),f=o(n(41)),p=o(n(42)),m=o(n(53)),g=a(n(6)),v=n(45),h=o(n(46)),y=n(4),E=n(20),M=n(51),b=n(180),S=o(n(272)),R=o(n(960)),C=n(95),T=n(52),w=n(54),I=n(968),O=n(77),k=n(969),_=n(22),N=n(971),x=n(972),D=n(44),P=n(91);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.default)(e);if(t){var o=(0,p.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,f.default)(this,n)}}var B=g.default.lazy((function(){return n.e(84).then(n.t.bind(null,1124,7))})),F=function(e){(0,c.default)(o,e);var t,a=A(o);function o(e){var t;return(0,u.default)(this,o),(t=a.call(this,e)).isLoginOccurred=!1,t.addStarsRating=function(e){t.setState(L(L({},t.state),{},{hasStarsRating:e>0}))},t.onStarsRatingClick=function(e){t.props.onStarsRatingClick(e),t.addStarsRating(e)},t.moderateRT=function(){(0,P.isRealtimeEnabled)()&&t.props.onRealtimeModeration({entities:t.state.entities,starsRating:t.state.starsRating})},t.onChange=function(e){var n=e.entities,a=e.displayName,o=e.starsRating,r=e.isEmpty,s=e.length,i=e.postId,l=e.lastChar,u=t.state.shouldSendTypingEvent;t.setState({entities:null!=n?n:t.state.entities,displayName:null!=a?a:t.state.displayName,starsRating:null!=o?o:t.state.starsRating,hasText:!r&&"boolean"==typeof r||"boolean"!=typeof r&&t.state.hasText,length:null!=s?s:t.state.length}),u&&t.setState({shouldSendTypingEvent:!1},(function(){var e={type:"typing",post_id:i};(0,_.analyticsTrack)(e)})),t.props.onChange({isEmpty:r}),t.props.onTyping(l),null!=a&&t.onDisplayNameChange(a),r||t.debouncedRTMessage()},t.handleBlur=(0,i.default)(s.default.mark((function e(){var n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.createMessagePayload(),t.props.onBlur({draftMessage:n});case 2:case"end":return e.stop()}}),e)}))),t.getInsertedKeyCode=function(e){var t;return(null===(t=(e.ops||[]).find((function(e){return e.insert})))||void 0===t?void 0:t.insert.charCodeAt(0))||-1},t.loadEditor=function(){t.setState({showEditor:!0})},t.setFocus=function(){t.state.ready||t.setState({ready:!0}),t.handleFocus()},t.handleFocus=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.focusOnDisplayName;t.setState({focusOnDisplayName:n}),t.callOnFocus();var a=t.snippets.showToolTip();t.setState({showToolTip:a})},t.hasMediaEntity=function(){return!!t.state.mediaEntity},t.handleLogin=(0,i.default)(s.default.mark((function e(){var n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.createMessagePayload(),t.isLoginOccurred=!0,t.props.login(n);case 3:case"end":return e.stop()}}),e)}))),t.createMessage=(0,i.default)(s.default.mark((function e(){var n,a,o,r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.props,a=n.createMessage,n.currentUser,o=t.state.mediaEntity,r=t.createMessagePayload(),t.setState(L(L({},t.snippets.setIsExpanded()),{},{shouldSendTypingEvent:!0})),a(r).then((function(e){var n=e.payload.isMessageBlockedVerdict;!e.error&&n?t.setState({hasText:!0,mediaEntity:o}):(t.setState(t.getResetState()),t.ref.current.reset()),t.handleBlur()})),t.props.onChange&&t.props.onChange({isEmpty:!0}),t.props.onPost&&t.props.onPost();case 7:case"end":return e.stop()}}),e)}))),t.editMessage=(0,i.default)(s.default.mark((function e(){var n,a;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props.editMessage,e.next=3,t.createMessagePayload();case 3:a=e.sent,t.setState(t.getResetState()),n(a);case 6:case"end":return e.stop()}}),e)}))),t.createMessagePayload=function(){var e=t.props,n=e.starsRating,a=e.enableStarsRating,o=e.isLoggedIn,r=e.currentUser,s=e.requireDisplayName,i=t.state.entities,l=r.displayName,u={entities:i};return s&&!o&&(u.displayName=l),a&&(u.starsRating=n),u},t.onDisplayNameChange=function(e){var n=t.props.onUsernameChange;null==n||n(e)},t.closeRichEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t.props,a=n.closeEditRichEditor,o=n.messageToEdit,r=n.isEditRichEditor;r?a({messageId:null==o?void 0:o.id}):e&&t.ref.current.reset()},t.isExpanded=function(){var e,n;return t.props.isExpanded||t.state.showStickyRTE||t.isSubmitting()||0===(null===(e=t.props.messageToEdit)||void 0===e||null===(n=e.id)||void 0===n?void 0:n.indexOf("sp_"))},t.isSubmitting=function(){var e=t.props,n=e.isRootMessage,a=e.isSubmittingComment,o=e.isSubmittingReply,r=e.isSubmittingEdit;return n&&a||!n&&o||!n&&r},t.handleSubmit=function(){var e=t.props.isEdit;t.props.requireDisplayName&&!t.props.currentUser.displayName||(e?t.editMessage():t.createMessage())},t.state=L(L({},t.getResetState()),{},{showTooltip:!1,ready:!1,shouldSendTypingEvent:!0,showStickyRTE:!1}),t.simpleEditorTextEntity=t.getDraftMessage()||e.messageToEdit,t.snippets=n(973),t.debouncedRTMessage=(0,S.default)(t.moderateRT,P.REALTIME_MODERATION_TIME_MS),t.ref=g.default.createRef(),t}return(0,d.default)(o,[{key:"getResetState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.props,n=t.isExpanded,a=t.messageToEdit,o=t.currentUser;return{mediaEntity:void 0,hasText:!e&&(0,M.hasText)(a),isLoading:!1,isExpanded:n,length:0,displayName:(0,E.getDisplayName)(o),entities:[],starsRating:0,hasStarsRating:this.props.starsRating>0}}},{key:"getDraftMessage",value:function(){var e=this.props.draftKey;return(0,b.getDraftMessage)(e)}},{key:"UNSAFE_componentWillMount",value:function(){var e=(0,M.getMediaEntity)(this.props.messageToEdit);e&&this.setState({mediaEntity:e})}},{key:"componentDidMount",value:(t=(0,i.default)(s.default.mark((function e(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,this.props.requestSetFocus)(this.setFocus),(0,N.isIOS)()&&this.loadEditor();case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"componentDidUpdate",value:function(e){this.isLoginOccurred&&!1===e.isLoggedIn&&!0===this.props.isLoggedIn&&(this.createMessage(),this.isLoginOccurred=!1);var t=this.props.currentUser;e.currentUser.id!==t.id&&(t.isRegistered||this.setState(this.getResetState(!0))),e.starsRating!==this.props.starsRating&&this.addStarsRating(this.props.starsRating)}},{key:"callOnFocus",value:function(){var e=this.props,t=e.isReply,n=e.autoFocus,a=this.state,o=a.showEditor,r=a.ready,s=this.shouldRenderRichEditor(o,n,r);(!s||s&&!this.isExpanded()||t&&!this.isExpanded())&&"function"==typeof this.props.onFocus&&this.props.onFocus({element:(0,y.findDOMNode)(this)})}},{key:"shouldRenderRichEditor",value:function(e,t,n){return e||t||n&&this.isExpanded()}},{key:"renderEditor",value:function(){var e=this,t=this.props,n=t.placeholderTextKey,a=(t.messageToEdit,t.placeholderReplyToName),o=t.autoFocus,r=t.isReply,s=t.t,i=t.preventScrollOnAutoFocus,l=t.requireDisplayName,u=t.animationRating,d=t.isUploadImageButtonVisible,c=t.currentUser,f=t.showErrorBorder,p=t.isUserSuspended,m=t.starsRating,v=t.enableStarsRating,h=t.draftKey,y=(this.state.showEditor,this.snippets.getPlaceHolderText(s(n,{displayName:a}))),M=this.snippets.getMaxLength(),b=g.default.createElement(k.SimpleEditor,{onViewed:this.loadEditor,displayNamePlaceHolder:s("richEditor.placeholder.displayName"),displayName:(0,E.getDisplayName)(c),requireDisplayName:l,maxLength:M,placeholder:y,textEntity:this.simpleEditorTextEntity,onFocus:function(){e.setState({ready:!0}),e.handleFocus()},onBlur:this.handleBlur,editorEventHandlers:{"text-change":this.onChange,linkify:this.onLinkify}});return g.default.createElement(g.Suspense,{fallback:b},g.default.createElement(B,{isMobileDevice:(0,T.isMobile)(),messageToEdit:this.props.messageToEdit,ref:this.ref,direction:this.props.direction,onChange:this.onChange,onBlur:this.handleBlur,onSubmit:this.handleSubmit,preventScrollOnOpen:i,requireDisplayName:l,currentUser:c,hasError:f,disabled:p,tabIndexType:"editor",isReply:r,isExpanded:this.isExpanded(),animationRating:u,isUploadImageButtonVisible:d,placeholderTextKey:y,displayNamePlaceHolder:s("richEditor.placeholder.displayName"),autoFocus:o,enableStarsRating:v,onFocus:function(){e.setState({ready:!0}),e.handleFocus()},starsRating:m,onStarsRatingClick:this.onStarsRatingClick,draftKey:h,maxLength:D.richEditorMaxCharacters,isLoadingMediaEntity:function(t){e.setState({isLoading:t})}}))}},{key:"render",value:function(){var e=this.props,t=e.isLoggedIn,n=e.uploadImage,a=e.disableSendButtonWithEmptyText,o=e.isMustRegisterToComment,r=e.sendButtonText,s=e.signupButtonText,i=e.currentUser,l=e.showCancelButton,u=e.showErrorBorder,d=e.moderationAlert,c=e.starsRatingAlert,f=e.isPostAnyway,p=e.isEdit,m=e.requireDisplayName,v=this.state,h=v.isLoading,y=v.mediaEntity,E=v.hasStarsRating,M=i.displayName;return g.default.createElement(g.default.Fragment,null,this.renderEditor(),this.isExpanded()&&g.default.createElement(R.default,{displayName:M,uploadImage:n,isMustRegisterToComment:o,isLoggedIn:t,onEdit:this.editMessage,onCancel:this.closeRichEditor,onCreate:this.createMessage,onLogin:this.handleLogin,isEdit:p,hasText:this.state.hasText,isLoading:h||this.isSubmitting(),sendButtonText:r,signupButtonText:s,disableSendButtonWithEmptyText:a,showCancelButton:l,hasMediaEntity:!!y,isPostAnyway:f,showErrorBorder:u,moderationAlert:d,starsRatingAlert:c,isDisplayNameRequired:m,hasStarsRating:E}))}}]),o}(g.Component);F.propTypes={spotId:h.default.string.isRequired,editMessage:h.default.func,createMessage:h.default.func.isRequired,direction:h.default.oneOf(["rtl","ltr"]).isRequired,onTyping:h.default.func,requireDisplayName:h.default.bool,onFocus:h.default.func,login:h.default.func,closeEditRichEditor:h.default.func,onBlur:h.default.func,cancel:h.default.func,isLoggedIn:h.default.bool,isMustRegisterToComment:h.default.bool,isExpanded:h.default.bool,hidePanel:h.default.bool,messageToEdit:h.default.object,replyToMessage:h.default.object,className:h.default.string,placeholderTextKey:h.default.string,starsRating:h.default.number,currentUser:h.default.object,sendButtonText:h.default.string,signupButtonText:h.default.string,findHashImageUrl:h.default.func,uploadImage:h.default.func,isUploadImageButtonVisible:h.default.bool,disableSendButtonWithEmptyText:h.default.bool,animationRating:h.default.oneOf(["y","g","pg","pg-13","none"]),blurOnFocusForGuestUser:h.default.bool,showCancelButton:h.default.bool,isEditRichEditor:h.default.bool,msnSocialLogin:h.default.func,openUserProfileModal:h.default.func,requestSetFocus:h.default.func,connectTypes:h.default.array.isRequired,isReply:h.default.bool,isRootMessage:h.default.bool,isSubmittingComment:h.default.bool,isSubmittingReply:h.default.bool,isSubmittingEdit:h.default.bool,t:h.default.func,moderationAlert:h.default.oneOfType([h.default.object,h.default.bool]),starsRatingAlert:h.default.oneOfType([h.default.object,h.default.bool]),showErrorBorder:h.default.bool,onRealtimeModeration:h.default.func,isPostAnyway:h.default.bool,postId:h.default.string,isEdit:h.default.bool,elementId:h.default.string,draftKey:h.default.string},F.defaultProps={placeholderTextKey:"richEditor.placeholder.hasMessages",messageToEdit:(0,M.createMessageObject)(),replyToMessage:(0,M.createMessageObject)(),isExpanded:!1,hidePanel:!1,cancel:function(){},editMessage:function(){},createMessage:function(){},closeEditRichEditor:function(){},direction:"ltr",onBlur:function(){},onFocus:function(){},onTyping:function(){},blurOnFocusForGuestUser:!1,openUserProfileModal:function(){},requestSetFocus:function(){},moderationAlert:null,starsRatingAlert:null,showErrorBorder:!1,onRealtimeModeration:function(){},isPostAnyway:!1,isEdit:!1};var j=(0,m.default)((0,v.connect)((function(e,t){var n,a,o=e.messageSayControls,l=e.moduleOptions,u=e.currentUser,d=e.ui,c=d.showStickyRichBar,f=d.showFloatingRichBar,p=e.moduleOptions,m=p.spotId,g=p.hashImageSelector,v=p.textsOverrides,h=p.postId,y=p.elementId,E=p.forceRegister,M=e.conversation,b=M.isSubmittingComment,S=M.isSubmittingReply,R=M.isSubmittingEdit,T=e.userSuspension.isUserSuspended,w=t.messageToEdit,I=t.replyToMessage,k=t.isEditRichEditor,_=(0,O.isDisplayNameRequired)({isRegistered:u.isRegistered,isForceRegister:E,userId:u.id}),N=o[k?w&&w.id:I&&I.id];return{isRendered:N&&N.isRendered,connectTypes:l.connectTypes,showStickyRichBar:c,showFloatingRichBar:f,spotId:m,sendButtonText:v.conversationSayControlSendButton,signupButtonText:v.conversationSayControlSignupButton,isSubmittingComment:b,isSubmittingReply:S,isSubmittingEdit:R,isUserSuspended:T,requireDisplayName:_,uploadImage:(a=(0,i.default)(s.default.mark((function e(t){var n,a,o,r;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.cloudinary.upload(t);case 2:return n=e.sent,a=n.public_id,o=n.height,r=n.width,e.abrupt("return",{publicId:a,height:o,width:r});case 7:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),findHashImageUrl:(n=(0,i.default)(s.default.mark((function e(t){var n,a,o,i;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g.replace(/{HASH_ID}/g,t),e.next=3,(0,x.findImageUrl)(n);case 3:return a=e.sent,o=(0,r.default)(a,1),i=o[0],e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)}),postId:h,elementId:y}}),(function(e,t){return{openUserProfileModal:function(n){return e(t.openUserProfileModal({user:n}))},msnSocialLoginDispatcher:function(){return e(t.msnSocialLogin())},onUsernameChange:function(t){e((0,I.onUsernameChange)(t))}}}),null,{forwardRef:!0}),(0,w.withTranslation)(void 0,{withRef:!0}))(F);t.default=j},960:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(33)),s=a(n(6)),i=o(n(18)),l=o(n(961)),u=n(962),d=n(964),c=o(n(966)),f=function(e){var t,n,a=e.hasText,o=e.isLoading,f=e.isEdit,p=e.showCancelButton,m=e.disableSendButtonWithEmptyText,g=e.displayName,v=e.isMustRegisterToComment,h=e.isLoggedIn,y=e.sendButtonText,E=e.signupButtonText,M=e.hasMediaEntity,b=e.isPostAnyway,S=e.moderationAlert,R=e.starsRatingAlert,C=e.isDisplayNameRequired,T=e.showErrorBorder,w=e.onCancel,I=void 0===w?function(){}:w,O=e.onEdit,k=void 0===O?function(){}:O,_=e.onCreate,N=e.onLogin,x=e.hasStarsRating,D=(0,i.default)(l.default.mainButtonsWrapper,(0,r.default)({},l.default.edit,f)),P=(0,s.useMemo)((function(){return C&&function(e){return!e||0===e.trim().length}(g)}),[C,g]);if(f)t=s.default.createElement(u.CancelButton,{onCancel:I}),n=s.default.createElement(d.EditButton,{isLoading:o,onEdit:k,hasMediaEntity:M,hasText:a});else{n=s.default.createElement(c.default,{disableButtonWithEmptyText:m,displayName:g,onCreate:_,onLogin:N,isMustRegisterToComment:v,isLoading:o,isLoggedIn:h,hasText:a,hasStarsRating:x,isUserDisplayNameEmpty:P,sendButtonText:y,signupButtonText:E,hasMediaEntity:M,withTransition:T,isPostAnyway:S&&b,isDisplayNameRequired:C});p&&(t=s.default.createElement(u.CancelButton,{onCancel:I}))}return s.default.createElement("div",{className:D},R,S,t,n)};t.default=f},962:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.CancelButton=void 0;var o=a(n(6)),r=a(n(963)),s=n(43),i=n(47);t.CancelButton=function(e){var t=e.onCancel;return o.default.createElement(s.Button,{className:r.default.cancelButton,onClick:t,"data-spot-im-class":"rich-editor-cancel-button"},o.default.createElement(i.TranslationWrapper,{i18nKey:"richEditor.cancel"},"Cancel"))}},964:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.EditButton=void 0;var r=o(n(49)),s=a(n(6)),i=o(n(86)),l=o(n(965)),u=n(47),d=n(43);t.EditButton=function(e){var t=e.isLoading,n=void 0!==t&&t,a=e.hasText,o=e.hasMediaEntity,c=e.onEdit,f=(0,s.useRef)(null),p=(0,s.useState)(0),m=(0,r.default)(p,2),g=m[0],v=m[1];return(0,s.useEffect)((function(){if(f.current){var e=f.current.getBoundingClientRect();v(e.width)}}),[]),s.default.createElement(d.Button,{mode:"primary",className:l.default.updateButton,disabled:!(a||o),onClick:c,"data-spot-im-class":"rich-editor-update-button",ref:f,style:n?{width:"".concat(g,"px")}:void 0},n?s.default.createElement(i.default,null):s.default.createElement(u.TranslationWrapper,{i18nKey:"richEditor.update"},"Update"))}},966:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.SendButton=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=o(n(53)),f=a(n(6)),p=n(45),m=o(n(18)),g=o(n(48)),v=n(43),h=n(47),y=o(n(86)),E=n(117),M=n(64),b=o(n(967));function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var R=function(e){(0,l.default)(n,e);var t=S(n);function n(){var e;(0,s.default)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={sendMessageAfterConnect:0,buttonWidth:0,isPostPage:e.props.contentType===M.ContentType.Post},e.buttonRef=f.default.createRef(),e.enableLoginButton=function(){var t=e.props,n=t.hasText,a=t.hasMediaEntity,o=t.isLoggedIn,r=t.isMustRegisterToComment;return!(n||a)&&r&&!o},e.handleSendButtonKeyUp=function(t){13===t.keyCode&&e.handleClick()},e}return(0,i.default)(n,[{key:"componentDidMount",value:function(){if(this.buttonRef.current){var e=this.buttonRef.current.getBoundingClientRect();this.setState({buttonWidth:e.width})}}},{key:"componentDidUpdate",value:function(){var e=this,t=this.state,n=t.buttonWidth;if(2===t.sendMessageAfterConnect&&(this.setState({sendMessageAfterConnect:0}),setTimeout((function(){e.handleClick()}),1)),this.buttonRef.current){var a=this.buttonRef.current.getBoundingClientRect();n!==a.width&&this.setState({buttonWidth:a.width})}}},{key:"handleClick",value:function(){var e=this.props,t=e.isLoading,n=e.isLoggedIn,a=e.onCreate,o=e.isMustRegisterToComment,r=e.convId;t||(o&&!n||this.enableLoginButton()?(0,E.openSignUpModal)():this.isDisabled()||(this.state.isPostPage&&this.props.tracking.trackEvent({type:"posted",ugc_post_id:r}),a()))}},{key:"isDisabled",value:function(){var e=this.props,t=e.hasText,n=e.hasMediaEntity,a=e.isUserDisplayNameEmpty,o=e.isLoggedIn,r=e.withTransition,s=e.isPostAnyway,i=e.isUserSuspended,l=e.isDisplayNameRequired,u=e.hasStarsRating;return e.disableButtonWithEmptyText&&(!(t||n||u)||i||r&&!s&&!u||a&&l&&!1===o)&&!this.enableLoginButton()}},{key:"render",value:function(){var e,t=this.props,n=t.isLoading,a=t.sendButtonText,o=t.signupButtonText,s=t.isMustRegisterToComment,i=t.isLoggedIn,l=(t.disableButtonWithEmptyText,t.isPostAnyway),u=t.withTransition,d=t.isUserSuspended,c=null;c=n?f.default.createElement(y.default,null):!i&&s?f.default.createElement(h.TranslationWrapper,{i18nKey:"richEditor.mustRegisterToComment",textOverride:o},"Sign up to post"):l&&!d?f.default.createElement(h.TranslationWrapper,{i18nKey:"richEditor.postAnyway"},"Post Anyway"):f.default.createElement(h.TranslationWrapper,{i18nKey:"richEditor.post",textOverride:a},"Send");var p=(0,m.default)(b.default.sendButton,(e={},(0,r.default)(e,b.default.disabled,this.isDisabled()),(0,r.default)(e,b.default.slideDown,u),(0,r.default)(e,b.default.postAnyway,l),e));return f.default.createElement(v.Button,{className:p,mode:"primary",disabled:this.isDisabled(),onClick:this.handleClick.bind(this),"data-spot-im-class":"rich-editor-send-button",ref:this.buttonRef,style:n?{width:"".concat(this.state.buttonWidth,"px")}:void 0},c)}}]),n}(f.Component);t.SendButton=R,R.propTypes={},R.defaultProps={isUserDisplayNameEmpty:!0,isLoading:!1,hasText:!1,disableButtonWithEmptyText:!0,sendButtonText:void 0,signupButtonText:void 0,isPostAnyway:!1,withTransition:!1,isDisplayNameRequired:!1,hasStarsRating:!1};var C=(0,c.default)((0,p.connect)((function(e){var t;return{isUserSuspended:null===(t=e.userSuspension)||void 0===t?void 0:t.isUserSuspended,spotId:e.moduleOptions.spotId,contentType:e.conversation.contentType,convId:e.conversation.id}})),(0,g.default)({}))(R);t.default=C},968:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.onUsernameChange=function(e){return function(t,n){var a=n().currentUser;i(t,a,e)}};var o=a(n(33)),r=a(n(153)),s=n(39),i=(0,r.default)((function(e,t,n){localStorage.setItem("SPOTIM_GUEST_DISPLAY_NAME",JSON.stringify((0,o.default)({},t.id,n))),e({type:s.CHANGE_USER_DISPLAY_NAME,payload:{displayName:n}})}),500)},969:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleEditor=void 0;var r,s=o(n(70)),i=o(n(35)),l=o(n(36)),u=o(n(40)),d=o(n(41)),c=o(n(42)),f=o(n(46)),p=o(n(18)),m=a(n(6)),g=n(51),v=n(43),h=n(77),y=o(n(970)),E=o(n(56)),M=o(n(52));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var o=(0,c.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}var S=function(e){(0,u.default)(n,e);var t=b(n);function n(e){var a;return(0,i.default)(this,n),(a=t.call(this,e)).input=m.default.createRef(),a.inputRef=m.default.createRef(),a.state={value:e.textEntity.text},a.simpleRef=m.default.createRef(),a}return(0,l.default)(n,[{key:"componentDidMount",value:function(){var e=this;(r=new IntersectionObserver((function(t){t[0].isIntersecting&&(e.props.onViewed(),r.disconnect())}))).observe(this.simpleRef.current);var t=this.props,n=t.text,a=t.editorEventHandlers,o=this.input.current;n&&(o.value=n),Object.keys(a).forEach((function(e){"text-change"===e&&o.addEventListener("keyup",a["text-change"],!1)}))}},{key:"getMentionEntities",value:function(){return[]}},{key:"getTextEntity",value:function(){var e=this.input.current.value;return(0,g.createTextEntityObject)({text:e})}},{key:"focus",value:function(){}},{key:"blur",value:function(){this.input.current.blur()}},{key:"setText",value:function(e){this.input.current.value=e,this.setState({value:e})}},{key:"handleFocus",value:function(){this.props.onFocus(),this.input.current.removeAttribute("rows"),this.setState({isFocused:!0})}},{key:"handleChange",value:function(e){this.setText(e.target.value),this.props.onChange()}},{key:"render",value:function(){var e,t=this.props,n=t.placeholder,a=t.maxLength,o=t.onBlur,r=t.textEntity,i=t.requireDisplayName,l=t.displayName,u=t.displayNamePlaceHolder,d=this.state.isFocused,c={rows:1,className:(0,p.default)(y.default.simpleEditor,h.isIE&&y.default.isIE,d&&y.default.focused),ref:this.input,onFocus:this.handleFocus.bind(this),onBlur:o,placeholder:n};return a>0&&(c.maxLength=a),m.default.createElement("div",{ref:this.simpleRef,className:y.default.richEditor},m.default.createElement("div",{className:y.default.container},i&&m.default.createElement("div",{className:y.default.displayNameWrapper},m.default.createElement("div",{className:y.default.displayNameInput},l?m.default.createElement("div",{ref:this.input,onFocus:this.handleFocus.bind(this),contentEditable:!0,dangerouslySetInnerHTML:{__html:l}}):m.default.createElement("div",(0,s.default)({},c,{className:y.default.placeholder,onClick:this.handleFocus.bind(this),contentEditable:!0,dangerouslySetInnerHTML:{__html:u}})))),m.default.createElement("div",(0,s.default)({ref:this.input},c,{contentEditable:!0,"data-placeholder":n,className:y.default.simpleEditor,id:"spotim-say-config",dangerouslySetInnerHTML:{__html:null===(e=(0,g.getTextEntity)(r))||void 0===e?void 0:e.text}})),m.default.createElement("div",{className:y.default.panel},!M.default&&m.default.createElement(v.Button,{className:y.default.icon},m.default.createElement(E.default,{selector:"emoji"})),m.default.createElement(v.Button,{className:y.default.icon},m.default.createElement(E.default,{selector:"cameraIcon"})),m.default.createElement(v.Button,{className:y.default.icon},m.default.createElement(E.default,{selector:"gifIcon"})))))}}]),n}(m.Component);t.SimpleEditor=S,S.propTypes={placeholder:f.default.string,textEntity:f.default.object,maxLength:f.default.number,onFocus:f.default.func,onBlur:f.default.func,editorEventHandlers:f.default.object,requireDisplayName:f.default.bool,displayName:f.default.string,displayNamePlaceHolder:f.default.string},S.defaultProps={placeholder:"Compose an epic...",textEntity:(0,g.createTextEntityObject)(),maxLength:0,onFocus:function(){},onBlur:function(){},editorEventHandlers:{}}},971:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.isIOS=function(){return"object"===("undefined"==typeof window?"undefined":(0,o.default)(window))&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},t.isAndroid=function(){return"object"===("undefined"==typeof window?"undefined":(0,o.default)(window))&&/Android/.test(navigator.userAgent)};var o=a(n(7))},972:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findImageUrl=void 0;t.findImageUrl=function(e){var t,n=document.querySelector(e);return n&&(t=n.getAttribute("src")),t}},973:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unregisterContractionEvent=t.registerContractionEvent=t.isWithCloseButton=t.getOnClick=t.getDisableUserImageUpload=t.showToolTip=t.getPlaceHolderText=t.setIsExpanded=t.getMaxLength=void 0;t.getMaxLength=function(){return 1500};t.setIsExpanded=function(){};t.getPlaceHolderText=function(e){return e};t.showToolTip=function(){return!1};t.getDisableUserImageUpload=function(e){return e.disableUserImageUpload};t.getOnClick=function(){return null};t.isWithCloseButton=function(){return!1};t.registerContractionEvent=function(e){document.addEventListener("click",e)};t.unregisterContractionEvent=function(e){document.removeEventListener("click",e)}},974:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TypingUsers=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=a(n(6)),c=o(n(46)),f=o(n(18)),p=n(45),m=n(246),g=a(n(89)),v=n(95),h=n(403),y=n(112),E=o(n(975));function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var b=function(e){(0,i.default)(n,e);var t=M(n);function n(){return(0,r.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"shouldComponentUpdate",value:function(e){return e.typingUsers.length!==this.props.typingUsers.length}},{key:"render",value:function(){var e=this.props,t=e.messageStack,n=e.typingUsers,a=e.repliesMaxDepth,o=e.optimizedMessageStack,r=e.typingUsersCount,s=e.spotId,i=Math.min(t.message.depth,a),l=(0,f.default)(E.default.typingUsers,E.default["depth-".concat(i)]),u=d.default.createElement(h.ConversationTyping,{className:l,users:n,typingUsersCount:r,size:"small",spotId:s});return o?u:d.default.createElement(m.ViewportGuard,{viewportObserver:v.viewportObserver},u)}}]),n}(d.Component);t.TypingUsers=b,b.propTypes={messageStack:c.default.object.isRequired,typingUsers:c.default.arrayOf(c.default.object).isRequired,repliesMaxDepth:c.default.number,spotId:c.default.string};var S=(0,p.connect)((function(e,t){var n=t.messageStack,a=g.getMessage(n).id,o=e.moduleOptions.spotId,r=e.ui.optimizedMessageStack;return{repliesMaxDepth:e.moduleOptions.repliesMaxDepth,typingUsers:(0,y.getTypingStateOfUsers)(e,a),typingUsersCount:(0,y.getTypingsCount)(e,a),optimizedMessageStack:r,spotId:o}}))(b);t.default=S},976:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ShowPreviousReplies=void 0;var r=o(n(33)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=a(n(6)),f=n(45),p=o(n(18)),m=o(n(56)),g=n(217),v=o(n(169)),h=n(448),y=o(n(449)),E=n(47),M=o(n(979));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var S=function(e){(0,l.default)(n,e);var t=b(n);function n(){var e;(0,s.default)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={isLoading:!1},e.showPreviousReplies=function(){var t=e.props,n=t.messageStack,a=t.onShowPreviousReplies;e.setState({isLoading:!0}),a(n)},e}return(0,i.default)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(){this.state.isLoading&&this.setState({isLoading:!1})}},{key:"render",value:function(){var e=this.props,t=e.messageStack,n=e.moreCount,a=e.repliesMaxDepth,o=this.state.isLoading;return n>0&&t.hasNext&&t.childrenStackIds.length>0?c.default.createElement("div",{className:(0,p.default)(M.default.showPreviousReplies,M.default["depth-".concat(Math.min(t.message.depth,a))],(0,r.default)({},M.default.loading,o))},c.default.createElement(h.Button,{className:M.default.link,onClick:this.showPreviousReplies},c.default.createElement("span",{className:M.default.showMoreRepliesText},c.default.createElement(E.TranslationWrapper,{i18nKey:"inpage.conversation.showPreviousMessages",count:n,values:{messagesCount:n}})),c.default.createElement(m.default,{selector:"chevronDownIcon",className:M.default.chevron})),o&&c.default.createElement(y.default,null)):null}}]),n}(c.Component);t.ShowPreviousReplies=S,S.defaultProps={moreCount:0,onShowPreviousReplies:function(){}};var R=(0,f.connect)((function(e,t){var n=t.messageStack,a=e.comments,o=e.moduleOptions.repliesMaxDepth;return{moreCount:(0,g.getMoreCount)(a,n),repliesMaxDepth:o}}),{onShowPreviousReplies:v.default})(S);t.default=R},980:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ShowMoreReplies=void 0;var r=o(n(70)),s=o(n(35)),i=o(n(36)),l=o(n(40)),u=o(n(41)),d=o(n(42)),c=o(n(53)),f=a(n(6)),p=o(n(46)),m=n(45),g=a(n(89)),v=o(n(114)),h=n(217),y=a(n(50)),E=o(n(450)),M=n(136),b=o(n(48)),S=n(55);function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var C=function(e){(0,l.default)(a,e);var t=R(a);function a(e){var o;return(0,s.default)(this,a),(o=t.call(this,e)).getShowMoreRepliesComponent=function(){return n(450).default},o.showMoreReplies=function(){var e=o.props,t=e.tracking,n=e.messageStack,a=e.postId,r=e.onShowMoreReplies,s=n.message.id,i={message_id:s,type:"load-more-replies-clicked",post_id:a};t.trackEvent(i),r(s),(0,S.dispatchSpotimEvent)(M.CLICKED_SHOW_MORE_REPLIES_EVENT_NAME,s)},o.ShowMoreReplies=o.getShowMoreRepliesComponent(),o}return(0,i.default)(a,[{key:"componentDidUpdate",value:function(e){e.isLoading&&!this.props.isLoading&&this.props.onDoneLoading()}},{key:"render",value:function(){return f.default.createElement(E.default,(0,r.default)({showMoreReplies:this.showMoreReplies},this.props))}}]),a}(f.Component);t.ShowMoreReplies=C,C.propTypes={messageStack:p.default.object.isRequired,onShowMoreReplies:p.default.func,isLoading:p.default.bool,moreCount:p.default.number,isLastMessageInThread:p.default.bool,enableShowMore:p.default.bool,allCount:p.default.number,forceMessagesCollapsed:p.default.bool,onDoneLoading:p.default.func,numNewComments:p.default.number,numCollapsedChildren:p.default.number,onClick:p.default.func,depth:p.default.number},C.defaultProps={onShowMoreReplies:function(){},onDoneLoading:function(){},enableShowMore:!0};var T=(0,c.default)((0,m.connect)((function(e,t){var n=t.messageStack,a=t.isLastMessageInThread,o=t.numCollapsedChildren,r=g.getMessage(n),s=e.loadingReplies,i=!y.isLiveBlog(e),l=e.moduleOptions,u=l.spotId,d=l.postId;return{isLoading:!o&&s.isLoading&&s.rootMessageId===r.id,isLastMessageInThread:a,enableShowMore:i,moreCount:(0,h.getMoreCount)(e.comments,n),allCount:(0,h.getAllCount)(e.comments,n),spotId:u,postId:d}}),{onShowMoreReplies:v.default}),(0,b.default)({}))(C);t.default=T},982:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.PostMessageAction=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=o(n(46)),c=a(n(6)),f=n(45),p=o(n(1));function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var g=(0,c.lazy)((function(){return Promise.all([n.e(0),n.e(26),n.e(59)]).then(n.t.bind(null,1152,7))})),v=function(e){(0,i.default)(n,e);var t=m(n);function n(e){return(0,r.default)(this,n),t.call(this,e)}return(0,s.default)(n,[{key:"render",value:function(){var e=this.props,t=e.isLegacyEnabled,n=e.repliesMaxDepth,a=e.message,o=e.isConnectEnabled,r=e.enableSSO,s=e.disableSignupWizard,i=o&&!r&&!s,l=t&&p.default.get("tenant_config.conversation.signup_cta_enabled",!0),u=null;return i&&l&&(u=c.default.createElement(c.Suspense,{fallback:null},c.default.createElement(g,{depth:Math.min(a.depth,n),isExpanded:!1,username:a.userDisplayName,message:a}))),u}}]),n}(c.Component);t.PostMessageAction=v,v.displayName="PostMessageAction",v.propTypes={message:d.default.object.isRequired,isLegacyEnabled:d.default.bool,repliesMaxDepth:d.default.number,spotId:d.default.string,enableSSO:d.default.bool,isConnectEnabled:d.default.bool,disableSignupWizard:d.default.bool.isRequired},v.defaultProps={isEnabled:!0,repliesMaxDepth:Number.MAX_VALUE};var h=(0,f.connect)((function(e){var t=e.moduleOptions;return{spotId:t.spotId,isConnectEnabled:t.isConnectEnabled,enableSSO:t.enableSSO,disableSignupWizard:t.disableSignupWizard}}))(v);t.default=h},983:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expandChildren=function(e){return{type:a.EXPAND_CHILDREN,payload:e}};var a=n(39)},985:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.renderChildrenStack=t.getClassNames=t.handleTOLSpacing=void 0;var o=a(n(33)),r=a(n(6)),s=a(n(18)),i=a(n(451)),l=a(n(405));t.handleTOLSpacing=function(){return{isAdjacentStaffReply:!1,isPreviousShowMoreReplies:!1,isPreviousStaffComment:!1}};t.getClassNames=function(e){var t;return(0,s.default)(i.default.rootMessage,e.className,(t={},(0,o.default)(t,i.default.isLastMessage,e.isLastMessage),(0,o.default)(t,i.default.isEdit,e.isEdit),(0,o.default)(t,i.default.isLiveBlog,e.isLiveBlog),t))};t.renderChildrenStack=function(e){var t=e.key,n=e.stack,a=e.messageIndex,o=e.isLastMessageInThread,s=e.ref;return r.default.createElement("li",{key:t,"aria-label":"Comment reply",role:"article"},r.default.createElement(l.default,{stack:n,messageIndex:a,isLastMessageInThread:o,ref:s}))}},986:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateMessageToBeFeatured=function(e){return function(t){t({type:a.UPDATE_MESSAGE_FEATURED,payload:e})}};var a=n(39)},987:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.fetchFeaturedCommentData=function(e,t){return new Promise(function(){var n=(0,r.default)(o.default.mark((function n(a){var r,l;return o.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,s.default)("v1.0.0/conversation/featured-message/".concat(e),{postId:(0,i.default)(e),method:"POST",data:{sortBy:t}});case 2:if((r=n.sent)&&r.messages){n.next=6;break}return a(null),n.abrupt("return");case 6:l=r.messages[0].user_id,r.messages[0].users[l]=r.users[l],r.messages[0].featuredComment="top",a(r.messages[0]);case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())};var o=a(n(37)),r=a(n(38)),s=a(n(58)),i=a(n(221))},989:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(6)),r=a(n(990)),s=function(){return o.default.createElement("div",{className:r.default.loaderContainer},o.default.createElement("div",{className:r.default.loaderContent},o.default.createElement("div",{className:r.default.loaderHeader},"Sponsored"),o.default.createElement("div",{className:r.default.loaderSpinner})))};t.default=s},991:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(49)),r=n(6),s=function(e){var t=e.ref,n=e.rootMargin,a=void 0===n?"0px":n,s=e.useOnce,i=(0,r.useState)(!1),l=(0,o.default)(i,2),u=l[0],d=l[1],c=(0,r.useState)(!1),f=(0,o.default)(c,2),p=f[0],m=f[1];return(0,r.useEffect)((function(){var e=new IntersectionObserver((function(e){var t=(0,o.default)(e,1)[0];d(t.isIntersecting)}),{rootMargin:a,threshold:[.01]});return t&&e.observe(t),function(){t&&e.unobserve(t)}}),[t]),(0,r.useEffect)((function(){s?!p&&m(u):m(u)}),[u]),p};t.default=s},992:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.getAdIndices=t.adsStartPosition=t.adsPositionRate=void 0;var o,r=a(n(87)),s=a(n(1)),i=n(182);!function(e){e.CONSTANT="CONSTANT",e.NONE="NONE"}(o||(o={}));var l=s.default.get("tenant_config.conversation.ads_enabled",!1),u=s.default.get("tenant_config.conversation.adsPositionRate",7);t.adsPositionRate=u;var d=s.default.get("tenant_config.conversation.ads_start_position",7);t.adsStartPosition=d;t.getAdIndices=function(e){var t=e.stackLength;if((l?o.CONSTANT:o.NONE)===o.NONE)return[];var n=(0,i.getMessagesCountToFetch)(),a=n<=d?n:d<=u?d:u,s=Math.floor((t-a)/u),c=s>0?s:0,f=(0,r.default)(Array(c)).map((function(e,t){return a+(t+1)*(u+1)}));return[a].concat((0,r.default)(f))}},993:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.addItemComponent=void 0;var o=a(n(453));t.addItemComponent=function(e){var t=e.key,n=e.rootMessageComponent;return React.createElement("li",{className:o.default.listItem,"aria-label":"Comment",key:t},React.createElement("div",{className:o.default.safariPadder}),n)}},994:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MainSayControl=void 0;var r=o(n(37)),s=o(n(38)),i=o(n(70)),l=o(n(7)),u=o(n(35)),d=o(n(36)),c=o(n(40)),f=o(n(41)),p=o(n(42)),m=o(n(53)),g=a(n(6)),v=n(45),h=o(n(1)),y=n(180),E=n(52),M=o(n(251)),b=n(439),S=n(441),R=n(176),C=n(442),T=n(443),w=n(80),I=n(107),O=a(n(50)),k=n(63),_=o(n(454)),N=n(444),x=n(445),D=a(n(91)),P=n(39),U=n(447),L=o(n(48)),A=n(47),B=n(44);function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.default)(e);if(t){var o=(0,p.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,f.default)(this,n)}}var j=(0,g.lazy)((function(){return Promise.all([n.e(0),n.e(17),n.e(24)]).then(n.t.bind(null,467,7))})),V=(0,g.lazy)((function(){return Promise.all([n.e(0),n.e(91)]).then(n.t.bind(null,1165,7))})),K=h.default.get("isConversationPageTriggered",!1),W=h.default.get("tenant_config.conversation.forceSimpleEditor",!1),H=function(e){(0,c.default)(n,e);var t=F(n);function n(){var e;(0,u.default)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).mainSayControl=g.default.createRef(),e.wrapperRef=void 0,e.getContentsMethod=function(){},e.setContentsMethod=function(e){},e.setFocusMethod=function(){},e.hanldeSetFocus=function(t){var n=e.props,a=n.postId,o=n.instanceId;if(t.data&&"object"===(0,l.default)(t.data)&&t.data.__SPOTIM_MESSAGE&&"set-main-say-control-focus"===t.data.type){var r=t.data.instanceId===o,s=t.data.postId===a;(!t.data.postId||!!t.data.instanceId&&r||s)&&e.setFocus()}},e.setFocus=function(){var t,n;null===(t=e.mainSayControl)||void 0===t||null===(n=t.current)||void 0===n||n.setFocus()},e.handleUploadProfileImage=function(t){var n=e.props.currentUser;e.props.onProfileImageUpload({userId:n.id,rawImage:t})},e.createMessage=function(t){var n=t.entities,a=t.displayName,o=t.starsRating,r={entities:n,starsRating:void 0===o?0:o};return a&&(r.displayName=a),(0,y.clearDraftMessage)(e.getDraftKey()),e.props.createMessage(r)},e.handleLogin=function(){var t=e.props,n=t.tracking,a=t.postId;(0,t.onLogin)();var o={item_type:"login",target_type:"commnet-sign-up",type:"login-clicked",post_id:a};n.trackEvent(o)},e.requestGetContents=function(t){e.getContentsMethod=t},e.requestSetContents=function(t){e.setContentsMethod=t},e.requestSetFocus=function(t){e.setFocusMethod=t},e.onTyping=function(t){var n=e.props,a=n.isMessageBlocked,o=n.isModerationAlertVisible,r=n.closeModerationAlert,s=n.isUserSuspended,i=n.currentUser;a&&!s&&o&&D.isValidKeyPress(t)&&(r(),e.props.tracking.trackEvent({item_type:"realtime-moderation",user_id:i.id,is_registered:i.isRegistered,type:"post-edited",target_type:"after-post"})),e.props.onTyping()},e.onRealtimeModeration=function(t){var n=e.props,a=n.isMessageBlocked,o=n.onRealtimeModeration;a||o(t)},e.setWrapperRef=function(t){e.wrapperRef=t},e.handleClickOutside=function(t){var n=e.props,a=n.isModerationAlertVisible,o=n.isExpanded,r=null==t?void 0:t.composedPath();try{var s,i=r.some((function(e){var t;return null===(t=e.dataset)||void 0===t?void 0:t.spotimOverlay})),l=r.some((function(e){var t;return null===(t=e.className)||void 0===t?void 0:t.toString().endsWith("stars-rating")}));(null===(s=e.wrapperRef)||void 0===s?void 0:s.contains(r[1]))||e.state.hasText||i||a||o&&l||e.props.onUnfocus()}catch(e){}},e.onChange=function(t){var n=t.isEmpty;e.setState({hasText:!n})},e.handleBlur=function(){e.props.onBlur()},e.handleFocus=function(t){var n=e.props.conversationId;e.props.onFocus(t),e.props.tracking.trackEvent({type:"editor-comment-focus",ugc_post_id:n})},e.getDraftKey=function(){var t=e.props.conversationId;return"conversation_".concat(t,"_main-say-ctrl")},e}return(0,d.default)(n,[{key:"componentDidMount",value:function(){var e=this.props.autoFocus;M.default.on("focusSayControl",this.setFocus),this.subscribeToSetFocusMessage(),e&&!(0,E.isMobile)()&&this.setFocus(),document.addEventListener("click",this.handleClickOutside)}},{key:"subscribeToSetFocusMessage",value:function(){window.addEventListener("message",this.hanldeSetFocus)}},{key:"componentWillUnmount",value:function(){M.default.off("focusSayControl",this.setFocus),window.removeEventListener("message",this.hanldeSetFocus),document.removeEventListener("click",this.handleClickOutside)}},{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.isStarsRatingEnabled,a=e.forceRegister,o=e.moderationAlert,r=e.isModerationAlertVisible,s=e.isModerationAlertRendered,l=e.isMessageBlocked,u=e.isUserSuspended,d=e.shouldAutoFocus,c=e.preventScrollOnAutoFocus,f=e.isDisableRichFormatting,p=e.isStarsRatingFailed,m=e.starsRatingAlert,v=e.isUploadImageButtonVisible;return g.default.createElement("div",{ref:this.setWrapperRef},g.default.createElement(U.EditorWrapper,(0,i.default)({},this.props,{isUploadImageButtonVisible:v,ref:this.mainSayControl,onChange:this.onChange,onBlur:this.handleBlur.bind(this),onFocus:this.handleFocus,isDisableRichFormatting:f,tabIndexType:"editor",login:this.handleLogin,isLoggedIn:(0,k.isLoggedIn)(t),createMessage:this.createMessage,uploadProfileImage:this.handleUploadProfileImage,isRichBarVisibleOnMount:!0,enableStarsRating:n,isMustRegisterToComment:a,openUserProfileModal:I.openUserProfileModal,requestGetContents:this.requestGetContents,requestSetContents:this.requestSetContents,requestSetFocus:this.requestSetFocus,socialReviewsStyles:_.default,isRootMessage:!0,moderationAlert:o,starsRatingAlert:m,onTyping:this.onTyping,onRealtimeModeration:this.onRealtimeModeration,showErrorBorder:r&&s||p,isPostAnyway:l&&!u,isEdit:!1,autoFocus:d,preventScrollOnAutoFocus:c,draftKey:this.getDraftKey()})))}}]),n}(g.Component);t.MainSayControl=H,H.defaultProps={isUploadImageButtonVisible:!1,isStarsRatingEnabled:!1,forceRegister:!1,isExpanded:!1,autoFocus:!1,onTyping:function(){},onFocus:function(){},onBlur:function(){},onLogin:function(){},onStarsRatingClick:function(){},createMessage:function(){},closeModerationAlert:function(){},onRealtimeModeration:function(){},placeholderTextKey:"richEditor.placeholder.hasMessages",userImageSize:"medium",moderationAlert:null,isModerationAlertVisible:!1,isModerationAlertRendered:!1,isMessageBlocked:!1,isUserSuspended:!1,shouldAutoFocus:!1,preventScrollOnAutoFocus:!1,isStarsRatingFailed:!1,starsRatingAlert:null};var q=(0,m.default)((0,v.connect)((function(e){var t=e.currentUser,n=e.moduleOptions,a=e.mainSayControl,o=e.conversation,r=e.userSuspension,s=e.communityView,i=n.enableSSO,l=n.editableSSO,u=n.isConnectEnabled,d=n.isStarsRatingEnabled,c=n.forceRegister,f=n.direction,p=n.conversationRichToolbarEnabled,m=n.isMobile,v=n.disableSendButtonWithEmptyText,h=n.animationRating,y=n.blurOnFocusForGuestUser,M=n.transliterationLanguage,b=n.liveBlogRichToolbarEnabled,S=n.isConversationLiveBlog,R=n.postId,C=n.conversationId,T=(n.highlightedCommentId,n.instanceId),w=n.focusMainSayCtrlOnMount,I=a.starsRating,k=a.isStarsRatingFailed,_=a.expanded,N=a.isMessageBlocked,x=a.isModerationAlertVisible,D=a.isModerationAlertRendered,P=a.moderationTags,U=a.verdict,L=a.tempMessageId,F=s.focusSayControlOnSwitchTab,H=r.isUserSuspended,q=o.hasCommented,G=O.isReporter(e,t.id),z=b&&S&&G,Q=S?!B.disableImageUploadInLiveBlog:!B.disableImageUploadInConversation,Y=x&&g.default.createElement(g.Suspense,{fallback:null},g.default.createElement(j,{moderationTags:P,verdict:U,isRealtimeFeedback:!N,sayControlSessionId:L})),J=k&&g.default.createElement(g.Suspense,{fallback:null},g.default.createElement(V,null,g.default.createElement(A.TranslationWrapper,{i18nKey:"general.failedConversation.title"},"Oops, something went wrong :("))),Z=w||F;return{conversationId:C,currentUser:t,isUploadImageButtonVisible:Q,starsRating:I,isStarsRatingEnabled:d,forceRegister:c,direction:f,isExpanded:_,disableSendButtonWithEmptyText:v,isMobileDevice:(0,E.isMobile)()||m,blurOnFocusForGuestUser:y,showButton:u&&(!i||!!l),animationRating:h,enableRichToolbar:!(0,E.isMobile)()&&!m&&(p||z),transliterationLanguage:M,enableSSO:i,editableSSO:l,hasCommented:q,moderationAlert:Y,isModerationAlertVisible:x,isModerationAlertRendered:D,isMessageBlocked:N,isUserSuspended:H,shouldAutoFocus:Z,preventScrollOnAutoFocus:K,postId:R,instanceId:T,isDisableRichFormatting:W,isStarsRatingFailed:k,starsRatingAlert:J}}),(function(e){return{onTyping:function(){return e((0,C.notifyTyping)())},onFocus:function(t){var n=t.element;e((0,C.notifyTyping)()),e((0,b.focusSayControl)({element:n,depth:0}))},onBlur:function(){e((0,S.blurSayControl)())},onLogin:function(){e((0,w.openLoginSelectorModal)({mode:"signup"}))},onStarsRatingClick:(t=(0,s.default)(r.default.mark((function t(n){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e((0,T.updateStarsRating)(n));case 1:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)}),createMessage:function(t){var n=t.entities,a=t.displayName,o=t.starsRating;return e((0,R.createMessage)({entities:n,displayName:a,starsRating:o}))},onProfileImageUpload:function(t){var n=t.rawImage;e((0,k.profileImageUpload)({rawImage:n}))},closeModerationAlert:function(){e((0,N.closeModerationAlert)())},onRealtimeModeration:function(t){e((0,x.realtimeModerate)(t))},onUnfocus:function(){e({type:P.UNFOCUS_SAY_CONTROL})}};var t})),(0,L.default)({}))(H);t.default=q},995:function(e,t,n){"use strict";var a=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(35)),r=a(n(36));function s(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}var i=function(){function e(){(0,o.default)(this,e),this.events=void 0,this.events={}}return(0,r.default)(e,[{key:"on",value:function(e,t){var n=this;return t&&"function"==typeof t?(this.events[e]=this.events[e]||[],this.events[e].push(t),function(){n.off(e,t)}):function(){}}},{key:"once",value:function(e,t){if(t&&"function"==typeof t)var n=this.on(e,(function(){t.apply(void 0,arguments),n()}))}},{key:"trigger",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var o=[];this.events&&this.events[e]&&this.events[e].length>0&&(o=this.events[e]),o.forEach((function(e){return e.apply(void 0,n)}))}},{key:"off",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.events[e]&&this.events[e].length>0&&(t?s(this.events[e],t):this.events[e]=[])}}]),e}();t.default=i},996:function(e,t,n){"use strict";var a=n(0),o=n(34);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.SortMenu=t.textKeys=void 0;var r,s=a(n(35)),i=a(n(36)),l=a(n(40)),u=a(n(41)),d=a(n(42)),c=a(n(33)),f=a(n(53)),p=o(n(6)),m=n(45),g=a(n(18)),v=n(97),h=n(455),y=n(108),E=o(n(50)),M=n(3),b=n(43),S=a(n(1)),R=n(47),C=a(n(998)),T=a(n(86)),w=a(n(56)),I=a(n(48)),O=n(55),k=n(59),_=a(n(52));function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var x=(r={},(0,c.default)(r,y.SortBy.BEST,"inpage.conversation.sortMenu.best"),(0,c.default)(r,y.SortBy.NEWEST,"inpage.conversation.sortMenu.newest"),(0,c.default)(r,y.SortBy.OLDEST,"inpage.conversation.sortMenu.oldest"),(0,c.default)(r,y.SortBy.SOCIAL,"inpage.conversation.sortMenu.social"),r);t.textKeys=x;var D=function(e){(0,l.default)(n,e);var t=N(n);function n(){var e;(0,s.default)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={showMenu:!1},e.onSortChanged=function(t){if(e.props.sortBy!==t){var n=e.props,a=n.tracking,o=n.pageSize,r=n.conversation,s=n.href,i=n.canonicalHref,l=r.spotId,u=r.postId,d=r.id;M.metrics.send("sort_by_clicked");var c={type:"sorting-menu-clicked",target_type:t,item_type:"sort-menu",segment:t,post_id:u};a.trackEvent(c),e.props.onSortChange({spotId:l,postId:u,conversationId:d,href:s,canonicalHref:i,pageSize:o,sortBy:t}),e.hideMenu(),(0,O.dispatchSpotimEvent)(k.SORT_SELECT,{sortedBy:t})}},e.handleSortByClick=function(t,n){13===t.keyCode&&e.onSortChanged(n)},e.toggleMenu=function(t){e.setState({showMenu:t}),(0,O.dispatchSpotimEvent)(k.SORT_DROP_DOWN)},e.isChecked=function(t){return e.props.sortBy===t?"checked":""},e.handleSortMenuTitleGotFocus=function(){var e=document.querySelector('[class*="faces-list"]');if(e){var t=e.querySelectorAll('[class*="user-image"]');t[t.length-1].focus()}},e.getSortItem=function(t){var n=t.action,a=t.handler,o=t.label,r=t.sortKey,s=e.isChecked(r);return p.default.createElement(b.MenuItem,{"data-spmark":o,key:r,onClick:function(){return n(r,e.refs)},onKeyUp:a,className:(0,g.default)(C.default.menuItem,(0,c.default)({},C.default.selected,s)),id:"spotim-sort-by-list"},p.default.createElement(R.TranslationWrapper,{i18nKey:"".concat(x[r])}),s&&p.default.createElement("span",{className:C.default.iconWrapper},p.default.createElement(b.Icon,{name:"check",type:"fa-solid",className:C.default.checkedIcon})))},e}return(0,i.default)(n,[{key:"hideMenu",value:function(){this.setState({showMenu:!1})}},{key:"getSortItems",value:function(){var e=this,t=[this.getSortItem({action:this.onSortChanged,handler:function(t){return e.handleSortByClick(t,y.SortBy.BEST)},label:y.SortBy.BEST,sortKey:y.SortBy.BEST}),this.getSortItem({action:this.onSortChanged,handler:function(t){return e.handleSortByClick(t,y.SortBy.NEWEST)},label:y.SortBy.NEWEST,sortKey:y.SortBy.NEWEST}),this.getSortItem({action:this.onSortChanged,handler:function(t){return e.handleSortByClick(t,y.SortBy.OLDEST)},label:y.SortBy.OLDEST,sortKey:y.SortBy.OLDEST})];return S.default.get("tenant_config.conversation.social_enable",!1)&&t.push(this.getSortItem({action:this.onSortChanged,handler:function(t){return e.handleSortByClick(t,y.SortBy.SOCIAL)},label:y.SortBy.SOCIAL,sortKey:y.SortBy.SOCIAL})),t}},{key:"render",value:function(){var e=this.state.showMenu,t=this.props,n=t.isLiveBlog,a=t.sortBy,o=t.isLoading,r=t.direction,s=t.expanded;if(n)return null;var i=this.getSortItems(),l=S.default.get("init_data.config.ltr")?"bottom-start":"bottom-end",u=(0,g.default)(C.default.sortContainer,(0,c.default)({},C.default.isExpended,s));return p.default.createElement("div",{className:u},p.default.createElement(b.Typography,{type:"infoMd",className:C.default.sortText,onFocus:this.handleSortMenuTitleGotFocus},p.default.createElement(R.TranslationWrapper,{i18nKey:"inpage.conversation.sortMenu.sortBy"}),""),p.default.createElement(b.Menu,{isLtr:"ltr"===r,isMobile:_.default,showMenu:e,placement:l,trigger:"click",onShowChange:this.toggleMenu,mobileCancelButtonContent:p.default.createElement(R.TranslationWrapper,{i18nKey:"Cancel"},"Cancel"),menuButton:p.default.createElement(b.Button,{className:(0,g.default)(C.default.sortBy),id:"spotim-sort-by"},p.default.createElement(b.Typography,{type:"action",weight:"bold",className:C.default.sortByText},p.default.createElement(R.TranslationWrapper,{i18nKey:"".concat(x[a])})),o?p.default.createElement("div",{className:C.default.spinnerWrapper},p.default.createElement(T.default,null)):p.default.createElement(w.default,{selector:"chevronDownIcon",className:C.default.chevronIcon}))},i))}}]),n}(p.Component);t.SortMenu=D,D.defaultProps={sortBy:y.SortBy.BEST,pageSize:v.COMMENTS_PAGE_SIZE,isLiveBlog:!1};var P=(0,f.default)((0,m.connect)((function(e){var t=e.moduleOptions,n=e.mainSayControl,a=t.href,o=t.canonicalHref,r=t.spotId,s=t.direction,i=E.isLiveBlog(e),l=n.expanded;return{href:a,canonicalHref:o,isLiveBlog:i,spotId:r,isLoading:e.comments.loading,direction:s,expanded:l}}),{onSortChange:h.fetchConversation}),(0,I.default)({}))(D);t.default=P},997:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.fetchConversation=function(e,t,n,a){return p.apply(this,arguments)};var r=o(n(37)),s=o(n(38)),i=a(n(201)),l=n(97),u=n(78),d=n(108),c=n(360),f=n(353);function p(){return(p=(0,s.default)(r.default.mark((function e(t,n,a,o){var s,p,m,g,v,h,y,E,M,b,S,R,C,T,w,I,O,k,_,N;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=o.href,p=o.canonicalHref,m=o.offset,g=void 0===m?0:m,v=o.commentsRead,h=void 0===v?0:v,y=o.pageSize,E=void 0===y?l.COMMENTS_PAGE_SIZE:y,M=o.sortBy,b=void 0===M?d.SortBy.BEST:M,S=o.highlight,R=o.depth,s=decodeURIComponent(s),s=(0,f.normalizeUrl)(s),p=decodeURIComponent(p),p=(0,f.normalizeUrl)(p),e.next=7,i.fetchConversation(t,n,a,s,p,g,h,E,b,R);case 7:return C=e.sent,T=(0,c.parseConversation)(C.conversation),w=T.conversation,I=T.followersIds,O=T.pagination,k=T.comments,_=T.followers,N=(0,u.parseUser)(C.user),e.abrupt("return",{currentUser:N,conversation:w,followersIds:I,pagination:O,comments:k,followers:_,highlight:S});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},999:function(e,t,n){"use strict";var a=n(34),o=n(0);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(35)),s=o(n(36)),i=o(n(40)),l=o(n(41)),u=o(n(42)),d=a(n(6)),c=n(45),f=o(n(1e3)),p=o(n(1005)),m=n(107),g=n(414),v=n(80),h=o(n(86)),y=n(63),E=o(n(1007)),M=o(n(1008)),b=n(43),S=n(44),R=n(117);function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.default)(e);if(t){var o=(0,u.default)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return(0,l.default)(this,n)}}var T=o(n(1)).default.get("tenant_config.shared.disable_user_profile_privacy",!1),w=/[&?]spot_im_open_profile_followers=true/,I=function(e){(0,i.default)(n,e);var t=C(n);function n(){var e;(0,r.default)(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={showCommunityQuestionModal:!1},e.handleOpenUserProfile=function(){var t=e.props;(0,t.onOpenUserProfileModal)(t.currentUser)},e.onCommunityQuestionModalStateChange=function(){e.setState({showCommunityQuestionModal:!0})},e.handleCommunityQuestionModalClose=function(){e.setState({showCommunityQuestionModal:!1})},e.handleLogout=function(){e.setState({isLoggingOut:!0}),e.props.onLogout()},e}return(0,s.default)(n,[{key:"componentDidUpdate",value:function(e){e.currentUser!==this.props.currentUser&&this.state.isLoggingOut&&this.setState({isLoggingOut:!1})}},{key:"componentDidMount",value:function(){window&&!window.__SPOTIM__.isViewUserProfileFollowersConsumed&&w.test(window.location.search)&&(this.props.onOpenUserProfileFollowers(this.props.userId),window.__SPOTIM__.isViewUserProfileFollowersConsumed=!0)}},{key:"render",value:function(){var e=this.props,t=e.userId,n=e.isAdmin,a=e.isSuperAdmin,o=e.isModerator,r=e.isJournalist,s=e.isLoggedIn,i=e.allowLogin,l=e.onOpenPrivacyModal,u=e.onLoginSelector,c=e.conversationAuthorId,m=e.onOpenUserProfileModal,g=e.onOpenUserSettingsModal,v=e.direction,y=e.toggleHideConversation,R=e.postId,C=e.enableSSO,w=e.isLiveBlog,I=this.state,O=I.showCommunityQuestionModal,k=I.isLoggingOut,_=null;return s?_=d.default.createElement(d.default.Fragment,null,d.default.createElement(f.default,{size:"medium",showLogout:i||S.enableSsoLogout,conversationAuthorId:c,enableCommunityQuestion:!0,showHideConversation:!0,userId:t,isAdmin:n,isSuperAdmin:a,isModerator:o,isJournalist:r,isLoggedIn:s,onLogout:this.handleLogout,onOpenPrivacyModal:l,onOpenUserProfileModal:m,onOpenUserSettingsModal:g,direction:v,toggleHideConversation:y,onCommunityQuestionModalStateChange:this.onCommunityQuestionModalStateChange,showPrivacy:!(C&&T)},k?d.default.createElement("div",{className:E.default.loginSpinnerWrapper},d.default.createElement(h.default,null)):d.default.createElement(b.Icon,{className:E.default.cogMenuButton,name:"cog",type:"fa-regular"})),d.default.createElement(M.default,{showModal:O,onClose:this.handleCommunityQuestionModalClose})):i&&!w&&(_=d.default.createElement(p.default,{postId:R,onClick:function(){return u()}})),_}}]),n}(d.Component),O=(0,c.connect)((function(e){var t=e.currentUser,n=e.moduleOptions,a=n.isConnectEnabled,o=n.enableSSO,r=(n.editableSSO,n.direction),s=n.conversationAuthorId,i=n.connectTypes,l=n.spotId,u=n.postId,d=n.isConversationLiveBlog,c=n.isConversationPage;return{enableSSO:o,isConnectEnabled:a,currentUser:t,direction:r,userId:t.id,isAdmin:t.isAdmin,isSuperAdmin:t.isSuperAdmin,isJournalist:t.isJournalist,isModerator:t.isModerator,isLoggedIn:(0,y.isLoggedIn)(t),userDisplayName:(0,y.getDisplayName)(t),allowLogin:a&&!o||S.enableSsoLogin,conversationAuthorId:s,connectTypes:i,spotId:l,postId:u,isLiveBlog:d,isConversationPage:c}}),(function(e){return{onLogout:R.onLogout,onOpenPrivacyModal:function(t){return e((0,m.openUserProfileModal)({user:t,mode:"privacy"}))},onOpenUserProfileFollowers:function(t){e((0,m.openUserProfileModal)({user:{id:t},mode:"main-followers"}))},onOpenUserProfileModal:function(t){e((0,m.openUserProfileModal)({user:t,mode:"main"}))},onOpenUserSettingsModal:function(t){return e((0,m.openUserProfileModal)({user:t,mode:"settings"}))},onLoginSelector:function(){var t=function(){return e((0,v.openLoginSelectorModal)())};if(!document.requestStorageAccess)return e((0,v.openLoginSelectorModal)());var n=function(){document.requestStorageAccess().then((function(){return t()}),(function(){return t()}))};document.hasStorageAccess().then((function(e){!0===e?t():n()}),(function(){return n()}))},toggleHideConversation:function(){return e((0,g.toggleHideConversation)())}}}))(I);t.default=O}}]);
//# sourceMappingURL=conversation-component-bundle.js.map