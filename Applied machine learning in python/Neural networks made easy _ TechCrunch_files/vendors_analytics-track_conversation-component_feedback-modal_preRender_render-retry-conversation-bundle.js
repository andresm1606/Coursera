(window.webpackJsonp_spotim_580132258=window.webpackJsonp_spotim_580132258||[]).push([[5],{404:function(t,e,n){"use strict";(function(t){var i=n(0);Object.defineProperty(e,"__esModule",{value:!0}),e.createTracker=function(t){var e=t.source,n=t.spotId,i=t.postId;return{track:function(t){return C({type:t,source:e,spot_id:n,post_id:i})}}},e.preparePayload=D,e.trackEvent=C,e.trackEventFactory=function(t){return function(e){return C(u({},t,e))}};var r=i(n(7)),o=i(n(26)),a=i(n(1)),s=n(188),c=i(n(793));function u(){return(u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function d(){var t=localStorage.getItem("SPOTIM_DEVICE_UUID_V2");return t?JSON.parse(t):{}}function l(){return"."+function(t){void 0===t&&(t="");var e=(t=t.replace(/^www\./,"")).split(/\./);if(3===e.length){var n=e[2],i=e[1],r=v.includes(n),o=!v.includes(i)&&!f.includes(i);if(r&&o)return e.shift(),e.join(".")}for(;e.length>3;)e.shift();3===e.length&&(e[1].length>2&&e[2].length>2||-1===f.indexOf(e[1])&&-1===v.indexOf(e[2]))&&e.shift();return e.join(".")}(document.domain)}var v="ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|be|bf|bg|bh|bi|bj|bm|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|cl|cm|cn|co|cr|cu|cv|cw|cx|cz|de|dj|dk|dm|do|dz|ec|ee|eg|es|et|eu|fi|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|im|in|io|iq|ir|is|it|je|jo|jp|kg|ki|km|kn|kp|kr|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|na|nc|ne|nf|ng|nl|no|nr|nu|nz|om|pa|pe|pf|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|yt".split("|"),f="com|edu|gov|net|mil|org|nom|sch|caa|res|off|gob|int|tur|ip6|uri|urn|asn|act|nsw|qld|tas|vic|pro|biz|adm|adv|agr|arq|art|ato|bio|bmd|cim|cng|cnt|ecn|eco|emp|eng|esp|etc|eti|far|fnd|fot|fst|g12|ggf|imb|ind|inf|jor|jus|leg|lel|mat|med|mus|not|ntr|odo|ppg|psc|psi|qsl|rec|slg|srv|teo|tmp|trd|vet|zlg|web|ltd|sld|pol|fin|k12|lib|pri|aip|fie|eun|sci|prd|cci|pvt|mod|idv|rel|sex|gen|nic|abr|bas|cal|cam|emr|fvg|laz|lig|lom|mar|mol|pmn|pug|sar|sic|taa|tos|umb|vao|vda|ven|mie|北海道|和歌山|神奈川|鹿児島|ass|rep|tra|per|ngo|soc|grp|plc|its|air|and|bus|can|ddr|jfk|mad|nrw|nyc|ski|spy|tcm|ulm|usa|war|fhs|vgs|dep|eid|fet|fla|flå|gol|hof|hol|sel|vik|cri|iwi|ing|abo|fam|gok|gon|gop|gos|aid|atm|gsm|sos|elk|waw|est|aca|bar|cpa|jur|law|sec|plo|www|bir|cbg|jar|khv|msk|nov|nsk|ptz|rnd|spb|stv|tom|tsk|udm|vrn|cmw|kms|nkz|snz|pub|fhv|red|ens|nat|rns|rnu|bbs|tel|bel|kep|nhs|dni|fed|isa|nsn|gub|e12|tec|орг|обр|упр|alt|nis|jpn|mex|ath|iki|nid|gda|inc".split("|");var p,g=new Date,m=function(){if(e=_(new Date,g)<10,n="object"===(0,r.default)(p),e&&n){var t=p;return{visitId:t.visitId,duration:t.duration}}var e,n,i=function(){var t=c.default.get("spotim_visitId");try{return JSON.parse(t)}catch(t){return null}}(),o=i.visitId,a=i.creationDate,s=w(30),u=_(new Date,new Date(a)),d={visitId:o,creationDate:a,duration:Math.floor(u)};return g=new Date,p=d,c.default.set("spotim_visitId",d,{expires:s,domain:l()}),{visitId:o,duration:d.duration}},h=function(){var t={visitId:d().uuid,creationDate:new Date,duration:0},e=JSON.stringify(t),n=w(30);return c.default.set("spotim_visitId",e,{expires:n,domain:l()}),{visitId:t.visitId,duration:t.duration}},w=function(t){return new Date((new Date).getTime()+60*t*1e3)},_=function(t,e){var n=(t.getTime()-e.getTime())/1e3,i=Math.abs(n);return Math.round(i)};function I(){return window.__SPOTIM_PAGE_VIEW_ID__||(window.__SPOTIM_PAGE_VIEW_ID__=d().uuid),window.__SPOTIM_PAGE_VIEW_ID__||""}function b(t){void 0===t&&(t={});var e={};return Object.keys(t).forEach((function(n){null!==t[n]&&void 0!==t[n]&&(e[n]=t[n])})),encodeURIComponent(btoa(JSON.stringify(e)))}function k(){var t;try{t=JSON.parse(localStorage.getItem("SPOTIM_CURRENT_USER")||"").data.id}catch(t){}return t}function E(){if(!window.$$SPOTIM_BID$$){var t=d().uuid;window.$$SPOTIM_BID$$=t}return window.$$SPOTIM_BID$$}var S=function(){var t=!0===function(){var t=c.default.get("spotim_visitId");if(!(void 0!==t))return!1;try{return JSON.parse(t),!0}catch(t){return!1}}()?m():h(),e=t.visitId,n=t.duration;return window.$$SPOTIM_VID$$=e,{visitId:e,duration:n}};function y(){var t=function(){if(performance&&performance.timing){var t=performance.timing.domLoading;if(!isNaN(t)&&t>0)return t}return null}();if(t&&t>=0&&!isNaN(t)){var e=Date.now()-t;return isNaN(e)||e<0||e>Number.MAX_SAFE_INTEGER?null:e}return null}var x={development:"http://127.0.0.1:8000/api/v1/pixels",staging:"https://pix.staging-spot.im/api/v1/pixels",production:"https://pix.spot.im/api/v1/pixels"},O=function(){function e(e){this.configProvider=e,this.events=[],this.url="",this.maxEvents=10,(0,s.log)("EventsCollector",t.env.PACKAGE_VERSION),this.url=x[this.configProvider.get("env","production")],this.maxEvents=this.configProvider.get("tenant_config.events-collector.max_events",10),this.startSendingEvents(),this.handleUnload()}e.getInstance=function(t){var n=window.__SPOTIM__.SERVICES.events;return n||(n=new e(t),window.__SPOTIM__.SERVICES.events=n),n};var n=e.prototype;return n.startSendingEvents=function(){var t=this,e=this.configProvider.get("tenant_config.events-collector.time_interval_milliseconds",1e4);this.intervalId=setInterval((function(){t.sendEvents()}),e)},n.sendEvents=function(){if(this.events.length>0){var t=this.events.join("\\n");this.sendBeacon(t)}},n.sendBeacon=function(t){"sendBeacon"in navigator?navigator.sendBeacon(this.url,t)&&this.clean():(fetch(this.url,{method:"POST",body:t}),this.clean())},n.addEvent=function(t){var e=b(t);this.events.push(e),this.events.length>this.maxEvents&&this.sendEvents()},n.handleUnload=function(){var t=this;window.addEventListener("unload",(function(){t.sendEvents()}))},n.clean=function(){this.events=[]},n.stopSendingEvents=function(){clearInterval(this.intervalId)},e}().getInstance(a.default);function P(t,e){var n;if(void 0===e&&(e=!1),e){var i,r=function(t){return void 0===t&&(t={}),"https://pix.spot.im/api/v1/pixel?m="+b(t)+"&rnd="+Math.random()}(t);n=fetch(r,{credentials:"include",headers:(i={},i["x-spotim-device-uuid"]=d().uuid,i["x-spotim-page-view-id"]=I(),i)})}else O.addEvent(t);return n||Promise.resolve({})}function D(t){var e,n=d().uuid,i=S(),r=i.visitId,a=i.duration;return u({page_view_id:I(),guid:n,referrer:(e=document.referrer,e&&e.trim()?e.replace(/′/g,"'").replace(/’/g,"'"):""),user_id:k()||"0",ib_browser_id:E(),visit_id:r,duration:a,v:10,domain:location.hostname,url:location.href,lang:navigator.userLanguage||navigator.language,uid:n,source_version:"",time_delta:y()||0,test_field:o.default.getAllExperiments(),split_name:o.default.getActiveExperiments()},t)}function C(t){var e,n,i=D(t);return"*"===localStorage.getItem("SPOTIM_DEBUG_API")&&console.log("%cSpot.IM Analytics%c Track","background: #823fb5; color: white","background: transparent; color: unset",i),P(i,(e=a.default.get("tenant_config.events-collector.batching",!1),!((n=localStorage.getItem("SPOTIM_PIXELS_BATCHING"))?"*"===n:e))).then((function(){return!0}))}(0,s.log)("Analytics",t.env.PACKAGE_VERSION)}).call(this,n(130))},793:function(t,e,n){var i,r;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(o){if(void 0===(r="function"==typeof(i=o)?i.call(e,n,e,t):i)||(t.exports=r),!0,t.exports=o(),!!0){var a=window.Cookies,s=window.Cookies=o();s.noConflict=function(){return window.Cookies=a,s}}}((function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(i){function r(){}function o(e,n,o){if("undefined"!=typeof document){"number"==typeof(o=t({path:"/"},r.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(t){}n=i.write?i.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in o)o[c]&&(s+="; "+c,!0!==o[c]&&(s+="="+o[c].split(";")[0]));return document.cookie=e+"="+n+s}}function a(t,n){if("undefined"!=typeof document){for(var r={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=e(s[0]);if(c=(i.read||i)(c,u)||e(c),n)try{c=JSON.parse(c)}catch(t){}if(r[u]=c,t===u)break}catch(t){}}return t?r[t]:r}}return r.set=o,r.get=function(t){return a(t,!1)},r.getJSON=function(t){return a(t,!0)},r.remove=function(e,n){o(e,"",t(n,{expires:-1}))},r.defaults={},r.withConverter=n,r}((function(){}))}))}}]);
//# sourceMappingURL=vendors~analytics-track~conversation-component~feedback-modal~preRender~render-retry-conversation-bundle.js.map